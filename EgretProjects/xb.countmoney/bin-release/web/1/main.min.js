var AssetAdapter=function(){function e(){}var t=(__define,e),i=t.prototype;return i.getAsset=function(e,t,i){function n(n){t.call(i,n,e)}if(RES.hasRes(e)){var s=RES.getRes(e);s?n(s):RES.getResAsync(e,n,this)}else RES.getResByUrl(e,n,this,RES.ResourceItem.TYPE_IMAGE)},e}();egret.registerClass(AssetAdapter,"AssetAdapter",["eui.IAssetAdapter"]);var BaseScene=function(e){function t(t){e.call(this),this.inited=!1,this.percentWidth=100,this.percentHeight=100,this.touchEnabled=!1,this.addEventListener(eui.UIEvent.CREATION_COMPLETE,this.componentCreated,this),this.skinName=t}__extends(t,e);var i=(__define,t),n=i.prototype;return n.componentCreated=function(){this.removeEventListener(eui.UIEvent.CREATION_COMPLETE,this.componentCreated,this),this.inited=!0},n.onEnable=function(){},n.onRemove=function(){},n.onDestroy=function(){},t}(eui.Component);egret.registerClass(BaseScene,"BaseScene");var BaseUI=function(e){function t(t){e.call(this),this.inited=!1,this.addEventListener(eui.UIEvent.CREATION_COMPLETE,this.componentCreated,this),this.skinName=t}__extends(t,e);var i=(__define,t),n=i.prototype;return n.componentCreated=function(){this.removeEventListener(eui.UIEvent.CREATION_COMPLETE,this.componentCreated,this),this.inited=!0},t}(eui.Component);egret.registerClass(BaseUI,"BaseUI");var ImageMC=function(){function e(){this.imgeList=[],this.curFrame=0,this.totalFrame=0}var t=(__define,e),i=t.prototype;return i.addImage=function(e){this.imgeList.push(e),this.totalFrame++,1==this.totalFrame?this.curImg=e:e.visible=!1},i.nextFrame=function(){this.curFrame++,this.curFrame>=this.totalFrame&&(this.curFrame=0),this.curImg.visible=!1,this.curImg=this.imgeList[this.curFrame],this.curImg.visible=!0},e}();egret.registerClass(ImageMC,"ImageMC");var LayerManager=function(){function e(){this.tweenTime=500}var t=(__define,e),i=t.prototype;return i.initialize=function(e){this.main=e,this.sceneLayer=new eui.Group,this.sceneLayer.percentWidth=100,this.sceneLayer.percentHeight=100,this.main.addChild(this.sceneLayer),this.popLayer=new eui.Group,this.popLayer.percentWidth=100,this.popLayer.percentHeight=100,this.popLayer.touchEnabled=!1,this.main.addChild(this.popLayer)},i.runScene=function(e,t){void 0===t&&(t=!1),this.sceneLayer.addChild(e),e.inited&&e.onEnable(),null!=this.curScene&&this.curScene&&(this.sceneLayer.removeChild(this.curScene),this.curScene.onRemove(),t&&this.curScene.onDestroy()),this.curScene=e},e.getInstance=function(){return null==this.instance&&(this.instance=new e),this.instance},e}();egret.registerClass(LayerManager,"LayerManager");var LoadManager=function(){function e(){this.loadComplete=new Object,this.loadError=new Object,this.loadProgress=new Object,this.thisObject=new Object}var t=(__define,e),i=t.prototype;return e.getInstance=function(){return null==this.instance&&(this.instance=new e),this.instance},i.loadGroup=function(e,t,i,n,s){void 0===i&&(i=null),void 0===n&&(n=null),void 0===s&&(s=null),this.loadComplete[e]=i,this.loadError[e]=s,this.loadProgress[e]=n,this.thisObject[e]=t,RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.loadGroup(e)},i.onResourceLoadComplete=function(e){var t=e.groupName;RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this);var i=this.loadComplete[t];null!=i&&i.call(this.thisObject[t],e),this.clearCallBack(t)},i.onResourceLoadError=function(e){console.warn("Group:"+e.groupName+" has failed to load");var t=this.loadError[e.groupName];null!=t&&t.call(this.thisObject[e.groupName],e),this.clearCallBack(e.groupName)},i.onResourceProgress=function(e){var t=this.loadProgress[e.groupName];null!=t&&t.call(this.thisObject[e.groupName],e)},i.clearCallBack=function(e){this.loadComplete[e]=null,this.loadError[e]=null,this.loadProgress[e]=null},e}();egret.registerClass(LoadManager,"LoadManager");var ObjectPool=function(){function e(e){this.className=e,this.list=[]}var t=(__define,e),i=t.prototype;return i.getObject=function(){if(this.list.length>0)return this.list.shift();var e=egret.getDefinitionByName(this.className);return new e},i.returnObject=function(e){this.list.push(e)},e.getPool=function(t,i){if(void 0===i&&(i=0),!e.pool[t]&&(e.pool[t]=new e(t),0!=i))for(var n=egret.getDefinitionByName(t),s=e.pool[t],r=0;i>r;r++)s.returnObject(new n);return e.pool[t]},e.pool={},e}();egret.registerClass(ObjectPool,"ObjectPool");var SingleHttp=function(){function e(){this.request=new egret.HttpRequest,this.request.responseType=egret.HttpResponseType.TEXT,this.request.addEventListener(egret.Event.COMPLETE,this.onPostComplete,this),this.request.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onPostIOError,this)}var t=(__define,e),i=t.prototype;return i.send=function(e,t,i,n){this.thisObject=n,this.request.open(e,t),this.request.setRequestHeader("Content-type","application/x-www-form-urlencoded"),""!=i?this.request.send(i):this.request.send()},i.onPostComplete=function(e){this.completeHandler&&this.completeHandler.call(this.thisObject,this.request.response)},i.onPostIOError=function(e){this.errorHandler&&this.errorHandler.call(this.thisObject,e)},e.getInstance=function(){return null==this.instance&&(this.instance=new e),this.instance},e}();egret.registerClass(SingleHttp,"SingleHttp");var GameConst=function(){function e(){}var t=(__define,e);t.prototype;return e.haveChance=!0,e.phone="",e}();egret.registerClass(GameConst,"GameConst");var GameManager=function(){function e(){this.homeScene=new HomeScene,this.gameScene=new GameScene,this.openScene=new OpenScene,this.shareUI=new ShareUI,this.myPrizeUI=new MyPrizeUI,this.ruleUI=new RuleUI}var t=(__define,e),i=t.prototype;return i.startup=function(e){GameConst.stage=e.stage,LayerManager.getInstance().initialize(e),window.openScene=this.openScene,LayerManager.getInstance().runScene(this.homeScene)},e.getInstance=function(){return null==this.instance&&(this.instance=new e),this.instance},e}();egret.registerClass(GameManager,"GameManager");var GameScene=function(e){function t(){e.call(this,"GameSceneSkin"),this.totalPacket=0,this.timeLimit=10,this.resultUI=new ResultUI,this.countDownUI=new CountDownUI,this.bFirstGame=!0,this.isDrag=!1}__extends(t,e);var i=(__define,t),n=i.prototype;return n.componentCreated=function(){e.prototype.componentCreated.call(this),this.initView(),this.initFallPacket(),this.initCountPacket()},n.onEnable=function(){this.playArrowAnim(),this.startGame()},n.onRemove=function(){egret.Tween.removeTweens(this.arrow)},n.startGame=function(){this.resetGame(),this.bFirstGame?(this.bFirstGame=!1,GameConst.stage.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onFirstGameTouchBegin,this),GameConst.stage.addEventListener(egret.TouchEvent.TOUCH_END,this.onFirstGameTouchEnd,this)):(this.countDownUI.show(),this.countDownUI.addEventListener("countComplete",this.countComplete,this))},n.resetGame=function(){this.resetAllPacketMoney(),this.resetCountPacket(),this.setTimeLabel(this.timeLimit.toString()),this.totalPacket=0,this.setPacketLabel(this.totalPacket.toString())},n.gameOver=function(){this.stopTimer(),this.staticPacket.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchBegin,this),GameConst.stage.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.onTouchMove,this),GameConst.stage.removeEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEnd,this),this.resultUI.showInScene(this,this.totalPacket)},n.countComplete=function(){this.addEventListener(egret.TouchEvent.ENTER_FRAME,this.onFallPacket,this),this.staticPacket.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchBegin,this),GameConst.stage.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.onTouchMove,this),GameConst.stage.addEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEnd,this),this.startTimer()},n.initView=function(){this.staticPacket.y=GameConst.stage.stageHeight-520,this.initArrowY=this.staticPacket.y-150,this.arrow.y=this.initArrowY},n.playArrowAnim=function(){this.arrow.y=this.initArrowY,egret.Tween.get(this.arrow,{loop:!0}).to({y:this.initArrowY-20},500).to({y:this.initArrowY},500)},n.onFirstGameTouchBegin=function(e){this.beginY=e.stageY},n.onFirstGameTouchEnd=function(e){if(!GameManager.getInstance().ruleUI.parent&&this.beginY-e.stageY>50){GameConst.stage.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onFirstGameTouchBegin,this),GameConst.stage.removeEventListener(egret.TouchEvent.TOUCH_END,this.onFirstGameTouchEnd,this);var t=this;egret.Tween.get(this.item_paper0).to({x:-300},500),egret.Tween.get(this.item_paper1).to({x:800},500),egret.Tween.get(this.item_p0).to({x:-300},500),egret.Tween.get(this.item_p1).to({x:800},500),egret.Tween.get(this.item_p2).to({x:900},700).call(function(){t.startGame()},this)}},n.onTouchBegin=function(e){this.curDragPacket||(this.beginY=e.stageY,this.isDrag=!0,this.curDragPacket=this.countPacketList.pop(),this.curDragPacket.x=this.staticPacket.x,this.curDragPacket.y=this.staticPacket.y,this.countGroup.addChild(this.curDragPacket))},n.onTouchMove=function(e){this.isDrag&&this.curDragPacket&&(this.curDragPacket.y+=e.stageY-this.beginY,this.beginY=e.stageY)},n.onTouchEnd=function(e){if(this.isDrag&&this.curDragPacket&&this.staticPacket.y-this.curDragPacket.y>50){window.playCountSnd();var t=this.curDragPacket.y/this.staticPacket.y*500,i=this.curDragPacket;this.curDragPacket=null;var n=this;egret.Tween.get(i).to({y:-i.height},t).call(function(){n.countPacketList.push(i)}),this.totalPacket++,this.setPacketLabel(this.totalPacket.toString())}else this.curDragPacket&&(this.curDragPacket.y=-this.curDragPacket.height,this.countPacketList.push(this.curDragPacket),this.curDragPacket=null);this.isDrag=!1},n.initCountPacket=function(){this.countPacketList=new Array;for(var e,t=0;15>t;t++)e=new egret.Bitmap(RES.getRes("game_packet_png")),this.countPacketList.push(e)},n.resetCountPacket=function(){this.curDragPacket&&(this.curDragPacket.y=-this.curDragPacket.height,this.countPacketList.push(this.curDragPacket),this.curDragPacket=null);for(var e,t=this.countPacketList.length,i=0;t>i;i++)e=this.countPacketList[i],e.y=-e.height},n.initFallPacket=function(){this.fallPacketList=new Array;for(var e,t=0;3>t;t++)e=new egret.Bitmap(RES.getRes("game_fall_png")),e.anchorOffsetX=e.width/2,e.anchorOffsetY=e.height/2,this.fallPacketList.push(e),this.resetFallPacketPos(e),this.fallPacketGroup.addChild(e);this.fallEdge=GameConst.stage.stageHeight+e.height},n.onFallPacket=function(){for(var e,t=this.fallPacketList.length,i=0;t>i;i++)e=this.fallPacketList[i],e.rotation+=10,e.y+=20,e.y>=this.fallEdge&&this.resetFallPacketPos(e)},n.resetFallPacketPos=function(e){e.y=-e.height-1e3*Math.random(),e.x=640*Math.random()},n.resetAllPacketMoney=function(){for(var e=this.fallPacketList.length,t=0;e>t;t++)this.resetFallPacketPos(this.fallPacketList[t])},n.setPacketLabel=function(e){this.packetLabel.text=e},n.setTimeLabel=function(e){this.timeLabel.text=e+" s"},n.startTimer=function(){null==this.gameTimer&&(this.gameTimer=new egret.Timer(800)),this.gameTimer.addEventListener(egret.TimerEvent.TIMER,this.onGameTimer,this),this.gameTimer.reset(),this.gameTimer.start()},n.onGameTimer=function(){var e=this.timeLimit-this.gameTimer.currentCount;this.setTimeLabel(e.toString()),0>=e&&this.gameOver()},n.stopTimer=function(){null!=this.gameTimer&&this.gameTimer.removeEventListener(egret.TimerEvent.TIMER,this.onGameTimer,this)},t}(BaseScene);egret.registerClass(GameScene,"GameScene");var HomeScene=function(e){function t(){e.call(this,"HomeSceneSkin")}__extends(t,e);var i=(__define,t),n=i.prototype;return n.componentCreated=function(){e.prototype.componentCreated.call(this),this.gonglueGroup.visible=!1},n.onEnable=function(){this.startBtn.scaleX=1,this.startBtn.scaleY=1,egret.Tween.get(this.startBtn,{loop:!0}).to({scaleX:1.05,scaleY:1.05},800).to({scaleX:1,scaleY:1},800),this.gonglueBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onGongLueBtnTouch,this),this.startBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onStartBtnTouch,this)},n.onRemove=function(){},n.onGongLueBtnTouch=function(){this.gonglueGroup.visible=!0,this.gonglueGroup.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onGroupTouch,this)},n.onGroupTouch=function(){this.gonglueGroup.visible=!1,this.gonglueGroup.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onGroupTouch,this)},n.onStartBtnTouch=function(){LayerManager.getInstance().runScene(GameManager.getInstance().gameScene)},t}(BaseScene);egret.registerClass(HomeScene,"HomeScene");var OpenScene=function(e){function t(){e.call(this,"OpenSceneSkin"),this.prizeList=[],this.bSubmit=!1}__extends(t,e);var i=(__define,t),n=i.prototype;return n.componentCreated=function(){e.prototype.componentCreated.call(this),this.initShareBtnY=this.shareBtn.y;for(var t=0;8>t;t++)this.prizeList.push(this["prize"+(t+1)]),this.prizeList[t].touchEnabled=!1,this.prizeList[t].visible=!1},n.onEnable=function(){this.openGroup.visible=!0,this.openedGroup.visible=!1,this.phoneGroup.visible=!1,this.phoneLabel.prompt="请输入手机号码",this.prizeResultLabel.text="",egret.Tween.get(this.shareBtn,{loop:!0}).to({y:this.initShareBtnY+15},500).to({y:this.initShareBtnY},500),this.configListeners()},n.onRemove=function(){egret.Tween.removeTweens(this.shareBtn),this.deConfigListeners()},n.configListeners=function(){this.openBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.openBtnTouch,this),this.myPrizeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onMyPrizeTouch,this),this.ruleBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onRuleBtnTouch,this),this.againBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.openBtnTouch,this),this.shareBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onShareBtnTouch,this),this.submitBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSubmitBtnTouch,this)},n.deConfigListeners=function(){this.openBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.openBtnTouch,this),this.myPrizeBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onMyPrizeTouch,this),this.ruleBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onRuleBtnTouch,this),this.againBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.openBtnTouch,this),this.shareBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onShareBtnTouch,this),this.submitBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onSubmitBtnTouch,this)},n.openBtnTouch=function(){this.deConfigListeners(),egret.Tween.get(this.openBg,{loop:!0}).to({rotation:this.openBg.rotation+5},50).to({rotation:this.openBg.rotation-5},50);var e=SingleHttp.getInstance();e.completeHandler=this.revOpenPrize,e.errorHandler=this.onOpenPrizeError;var t=window.pass,i="http://www.cisigo.com/index.php?s=/addon/Newspaper/Newspaper/xbLottery/pass/"+t,n="";e.send(i,egret.HttpMethod.GET,n,this)},n.revOpenPrize=function(e){this.configListeners(),egret.Tween.removeTweens(this.openBg),this.openBg.rotation=0;var t=JSON.parse(e);egret.log("奖品ID:"+t.prizeid,"奖品名:"+t.msg),"200"==t.code?(window.pass=t.pass,this.showPrize(t.prizeid,t.msg)):GameManager.getInstance().shareUI.show()},n.onOpenPrizeError=function(e){this.configListeners(),egret.Tween.removeTweens(this.openBg),this.openBg.rotation=0,alert("链接已失效")},n.showPrize=function(e,t){if(this.openGroup.visible=!1,this.openedGroup.visible=!0,this.curPrizeImg&&(this.curPrizeImg.visible=!1,this.curPrizeImg.y=this.initPrizeImgY),this.curPrizeImg=this.prizeList[e-1],this.initPrizeImgY=this.curPrizeImg.y,this.curPrizeImg.y+=300,this.curPrizeImg.visible=!0,egret.Tween.get(this.curPrizeImg).to({y:this.initPrizeImgY},1e3),this.prizeResultLabel.text="获得"+t,0==this.bSubmit){this.bSubmit=!0;var i=this;egret.Tween.get(this).wait(1e3).call(function(){i.phoneGroup.visible=!0},this)}},n.onMyPrizeTouch=function(){this.deConfigListeners();var e=SingleHttp.getInstance();e.completeHandler=this.revMyPrize,e.errorHandler=this.onMyPrizeError;var t="http://www.cisigo.com/index.php?s=/addon/Newspaper/Newspaper/prizeList",i="";e.send(t,egret.HttpMethod.GET,i,this)},n.revMyPrize=function(e){this.configListeners();var t=JSON.parse(e);for(var i in t)egret.log("查看奖品:"+t[i].prizenum,t[i].prizemsg);GameManager.getInstance().myPrizeUI.show(t)},n.onMyPrizeError=function(e){this.configListeners(),console.log("请求错误")},n.onRuleBtnTouch=function(){GameManager.getInstance().ruleUI.show()},n.onShareBtnTouch=function(){GameManager.getInstance().shareUI.show()},n.onSubmitBtnTouch=function(){egret.log("提交号码:"+this.phoneLabel.text);var e=/^1\d{10}$/,t=e.test(this.phoneLabel.text);if(0==t)return void alert("手机号码不正确");this.deConfigListeners();var i=SingleHttp.getInstance();i.completeHandler=this.submitComplete,i.errorHandler=this.submitError;var n="http://www.cisigo.com/index.php?s=/addon/Newspaper/Newspaper/addTel/tel/"+this.phoneLabel.text,s="";i.send(n,egret.HttpMethod.GET,s,this);var r=this;egret.Tween.get(this.submitBtn).wait(3e3).call(function(){r.configListeners()})},n.submitComplete=function(e){egret.Tween.removeTweens(this.submitBtn),this.configListeners(),GameConst.phone=this.phoneLabel.text,egret.localStorage.setItem("gzrb",this.phoneLabel.text),this.phoneGroup.visible=!1;var t=JSON.parse(e);alert(t.msg)},n.submitError=function(e){egret.Tween.removeTweens(this.submitBtn),this.configListeners(),this.phoneGroup.visible=!1,alert("链接已失效")},n.onPhoneRectTouch=function(){this.phoneGroup.visible=!1,this.configListeners()},n.sendAddChance=function(){this.deConfigListeners();var e=this;egret.Tween.get(this.shareBtn).wait(3e3).call(function(){e.configListeners()});var t=SingleHttp.getInstance();t.completeHandler=this.revShareResult,t.errorHandler=this.revShareError;var i=window.pass,n="http://www.cisigo.com/index.php?s=/addon/Newspaper/Newspaper/addLottery/pass/"+i,s="";t.send(n,egret.HttpMethod.GET,s,this)},n.revShareResult=function(e){this.configListeners();var t=JSON.parse(e);egret.Tween.removeTweens(this.shareBtn),"200"==t.code?(window.pass=t.pass,GameManager.getInstance().shareUI.hide(),alert(t.msg)):(GameConst.haveChance=!1,GameManager.getInstance().shareUI.show(),alert(t.msg))},n.revShareError=function(){this.configListeners(),egret.Tween.removeTweens(this.shareBtn),alert("增加拆红包次数失败")},t}(BaseScene);egret.registerClass(OpenScene,"OpenScene");var PreloadScene=function(e){function t(){e.call(this,"PreloadSceneSkin"),this.count=0}__extends(t,e);var i=(__define,t),n=i.prototype;return n.componentCreated=function(){e.prototype.componentCreated.call(this),this.imageMC=new ImageMC,this.imageMC.addImage(this.anim0),this.imageMC.addImage(this.anim1),this.imageMC.addImage(this.anim2),this.imageMC.addImage(this.anim3),this.bar.scaleX=1,this.setProgress(0),this.startAnim()},n.setProgress=function(e){this.progressLabel.text=e+"%",this.bar.scaleX=e/100},n.startAnim=function(){this.addEventListener(egret.Event.ENTER_FRAME,this.onEnterFrame,this)},n.stopAnim=function(){this.removeEventListener(egret.Event.ENTER_FRAME,this.onEnterFrame,this)},n.onEnterFrame=function(){this.count++,0==this.imageMC.curFrame?this.count%30==0&&this.imageMC.nextFrame():this.count%10==0&&this.imageMC.nextFrame()},t}(BaseScene);egret.registerClass(PreloadScene,"PreloadScene");var CountDownUI=function(e){function t(){e.call(this,"CountDownUISkin")}__extends(t,e);var i=(__define,t),n=i.prototype;return n.componentCreated=function(){e.prototype.componentCreated.call(this),this.num2.visible=!1,this.num1.visible=!1,this.timer=new egret.Timer(800,3),this.timer.addEventListener(egret.TimerEvent.TIMER,this.onTimerHandler,this),this.timer.addEventListener(egret.TimerEvent.TIMER_COMPLETE,this.onComplete,this)},n.show=function(){LayerManager.getInstance().popLayer.addChild(this),this.num3.visible=!0,this.num2.visible=!1,this.num1.visible=!1,this.timer.reset(),this.timer.start()},n.onTimerHandler=function(){1==this.timer.currentCount?(this.num3.visible=!1,this.num2.visible=!0):2==this.timer.currentCount&&(this.num2.visible=!1,this.num1.visible=!0)},n.onComplete=function(){this.parent&&this.parent.removeChild(this),this.timer.stop(),this.dispatchEvent(new egret.Event("countComplete"))},t}(BaseUI);egret.registerClass(CountDownUI,"CountDownUI");var MyPrizeUI=function(e){function t(){e.call(this,"MyPrizeUISkin"),this.detailList=new Array,this.prizeNum=8,this.beginY=0,this.percentHeight=100}__extends(t,e);var i=(__define,t),n=i.prototype;return n.componentCreated=function(){e.prototype.componentCreated.call(this),this.detailScroller.bounces=!1,this.detailGroup.visible=!1;for(var t=1;t<=this.prizeNum;t++)this.detailList.push(this["detail"+t])},n.show=function(e){this.prizeID0="",this.prizeID1="",this.contentLabel0.text="",this.contentLabel1.text="",this.detailScroller.touchChildren=!1,this.detailScroller.touchEnabled=!1,e[0]&&(this.prizeID0=e[0].prizenum,this.contentLabel0.text=e[0].prizemsg,this.contentLabel0.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onLabel0Touch,this)),e[1]&&(this.prizeID1=e[1].prizenum,this.contentLabel1.text=e[1].prizemsg,this.contentLabel1.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onLabel1Touch,this)),LayerManager.getInstance().popLayer.addChild(this),this.okBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onOKBtnTouch,this)},n.onOKBtnTouch=function(){this.okBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onOKBtnTouch,this),this.parent&&this.parent.removeChild(this)},n.onLabel0Touch=function(){this.showDetail(parseInt(this.prizeID0))},n.onLabel1Touch=function(){this.showDetail(parseInt(this.prizeID1))},n.showDetail=function(e){this.detailScroller.touchChildren=!0,this.detailScroller.touchEnabled=!0,this.codeLabel.text="",this.codeLabel.text="";for(var t=0;t<this.prizeNum;t++)this.detailList[t]&&(this.detailList[t].visible=!1);this.detailList[e-1]&&(this.detailList[e-1].visible=!0,this.codeLabel.text="兑换号:"+egret.localStorage.getItem("gzrb"),this.detailGroup.visible=!0,this.detailGroup.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onDetailBegin,this),this.detailGroup.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onDetailTouch,this))},n.onDetailBegin=function(e){this.beginY=e.stageY},n.onDetailTouch=function(e){e.stageY==this.beginY&&(this.detailGroup.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onDetailBegin,this),this.detailGroup.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onDetailTouch,this),this.detailGroup.visible=!1,this.detailScroller.touchChildren=!1,this.detailScroller.touchEnabled=!1)},t}(BaseUI);egret.registerClass(MyPrizeUI,"MyPrizeUI");var ResultUI=function(e){function t(){e.call(this,"ResultUISkin")}__extends(t,e);var i=(__define,t),n=i.prototype;return n.componentCreated=function(){e.prototype.componentCreated.call(this),this.initShareBtnY=this.shareBtn.y},n.showInScene=function(e,t){e.addChild(this),egret.Tween.get(this.shareBtn,{loop:!0}).to({y:this.initShareBtnY+15},500).to({y:this.initShareBtnY},500),this.countLabel.text="你数了"+t+"个红包";var i=Math.round(t/110*100);t>150?i=100:t>130?i=99:t>=110&&(i=98),this.fightLabel.text="你打败了"+i+"%的人",this.configListeners()},n.hide=function(){this.parent&&this.parent.removeChild(this),egret.Tween.removeTweens(this.shareBtn),this.deConfigListeners()},n.configListeners=function(){this.againBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onAgainBtnTouch,this),this.openPacketBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onOpenBtnTouch,this),this.shareBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onShareBtnTouch,this),this.prizeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onPrizeBtnTouch,this)},n.deConfigListeners=function(){this.againBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onAgainBtnTouch,this),this.openPacketBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onOpenBtnTouch,this),this.shareBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onShareBtnTouch,this),this.prizeBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onPrizeBtnTouch,this)},n.onAgainBtnTouch=function(){this.hide(),GameManager.getInstance().gameScene.startGame()},n.onOpenBtnTouch=function(){this.hide(),LayerManager.getInstance().runScene(GameManager.getInstance().openScene)},n.onShareBtnTouch=function(){GameManager.getInstance().shareUI.show()},n.onPrizeBtnTouch=function(){this.deConfigListeners();var e=SingleHttp.getInstance();e.completeHandler=this.revMyPrize,e.errorHandler=this.onMyPrizeError;var t="http://www.cisigo.com/index.php?s=/addon/Newspaper/Newspaper/prizeList",i="";e.send(t,egret.HttpMethod.GET,i,this)},n.revMyPrize=function(e){this.configListeners(),console.log("我的奖品:"+e);var t=JSON.parse(e);for(var i in t)egret.log("查看奖品:"+t[i].prizenum,t[i].prizemsg);GameManager.getInstance().myPrizeUI.show(t)},n.onMyPrizeError=function(e){this.configListeners(),console.log("请求错误")},t}(BaseUI);egret.registerClass(ResultUI,"ResultUI");var RuleUI=function(e){function t(){e.call(this,"RuleUISkin")}__extends(t,e);var i=(__define,t),n=i.prototype;return n.componentCreated=function(){e.prototype.componentCreated.call(this),this.scroller.scrollPolicyV=eui.ScrollPolicy.ON},n.show=function(){this.okBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onOkBtnTouch,this),LayerManager.getInstance().popLayer.addChild(this)},n.onOkBtnTouch=function(){this.parent&&this.parent.removeChild(this),this.okBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onOkBtnTouch,this),this.scroller.viewport.scrollV=0},t}(BaseUI);egret.registerClass(RuleUI,"RuleUI");var ShareUI=function(e){function t(){e.call(this,"ShareUISkin")}__extends(t,e);var i=(__define,t),n=i.prototype;return n.componentCreated=function(){e.prototype.componentCreated.call(this)},n.show=function(){GameConst.haveChance?(this.haveChance.visible=!0,this.noChance.visible=!1):(this.haveChance.visible=!1,this.noChance.visible=!0),LayerManager.getInstance().popLayer.addChild(this),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTap,this)},n.hide=function(){this.parent&&this.parent.removeChild(this),this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTap,this)},n.onTouchTap=function(e){this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTap,this),this.parent.removeChild(this)},t}(BaseUI);egret.registerClass(ShareUI,"ShareUI");var Main=function(e){function t(){e.apply(this,arguments),this.path=""}__extends(t,e);var i=(__define,t),n=i.prototype;return n.createChildren=function(){e.prototype.createChildren.call(this),this.path=window.addon_public_path;var t=new AssetAdapter;this.stage.registerImplementation("eui.IAssetAdapter",t),this.stage.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this);window.addon_public_path;RES.loadConfig(this.path+"resource/default.res.json?ver=1.6",this.path+"resource/")},n.onConfigComplete=function(e){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this);var t=new eui.Theme(this.path+"resource/default.thm.json?ver=1.6",this.stage);t.addEventListener(eui.UIEvent.COMPLETE,this.onThemeLoadComplete,this)},n.onThemeLoadComplete=function(){LoadManager.getInstance().loadGroup("preload",this,this.onPreloadComplete)},n.onPreloadComplete=function(e){this.preloadScene=new PreloadScene,this.addChild(this.preloadScene),LoadManager.getInstance().loadGroup("game",this,this.onGameComplete,this.onGameProgress)},n.onGameProgress=function(e){this.preloadScene.setProgress(Math.round(e.itemsLoaded/e.itemsTotal*100))},n.onGameComplete=function(e){this.preloadScene.stopAnim(),this.removeChild(this.preloadScene),this.preloadScene=null,GameManager.getInstance().startup(this)},t}(eui.UILayer);egret.registerClass(Main,"Main");var ThemeAdapter=function(){function e(){}var t=(__define,e),i=t.prototype;return i.getTheme=function(e,t,i,n){function s(e){t.call(n,e)}function r(t){t.resItem.url==e&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,r,null),i.call(n))}RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,r,null),RES.getResByUrl(e,s,this,RES.ResourceItem.TYPE_TEXT)},e}();egret.registerClass(ThemeAdapter,"ThemeAdapter",["eui.IThemeAdapter"]);