var AssetAdapter=function(){function e(){}var t=(__define,e);return p=t.prototype,p.getAsset=function(e,t,i){function n(n){t.call(i,n,e)}if(RES.hasRes(e)){var s=RES.getRes(e);s?n(s):RES.getResAsync(e,n,this)}else RES.getResByUrl(e,n,this,RES.ResourceItem.TYPE_IMAGE)},e}();egret.registerClass(AssetAdapter,"AssetAdapter",["eui.IAssetAdapter"]);var BaseScene=function(e){function t(t){e.call(this),this.inited=!1,this.percentWidth=100,this.percentHeight=100,this.touchEnabled=!1,this.addEventListener(eui.UIEvent.CREATION_COMPLETE,this.componentCreated,this),this.skinName=t}__extends(t,e);var i=(__define,t);return p=i.prototype,p.componentCreated=function(){this.removeEventListener(eui.UIEvent.CREATION_COMPLETE,this.componentCreated,this),this.inited=!0},p.onEnable=function(){},p.onRemove=function(){},p.onDestroy=function(){},t}(eui.Component);egret.registerClass(BaseScene,"BaseScene");var CMovieClip=function(e){function t(){e.call(this),this.textureList=[],this.curFrame=0,this.totalFrame=0,this.frameTime=20}__extends(t,e);var i=__define,n=t;return p=n.prototype,p.addTexture=function(e){this.textureList.push(RES.getRes(e)),this.totalFrame=this.textureList.length,1==this.totalFrame&&(this.texture=this.textureList[0])},p.play=function(){this.startTimer()},p.gotoAndPlay=function(e){this.gotoAndStop(e),this.play()},p.stop=function(){this.stopTimer()},p.gotoAndStop=function(e){this.texture=this.textureList[e-1],this.curFrame=e},p.startTimer=function(){null==this.timer&&(this.timer=new egret.Timer(this.frameTime)),this.timer.addEventListener(egret.TimerEvent.TIMER,this.onTimerHandler,this),this.timer.reset(),this.timer.start()},p.onTimerHandler=function(){this.curFrame++,this.curFrame>this.totalFrame&&(this.curFrame=1),this.gotoAndStop(this.curFrame)},p.stopTimer=function(){null!=this.timer&&(this.timer.removeEventListener(egret.TimerEvent.TIMER,this.onTimerHandler,this),this.timer.stop())},i(p,"frameRate",void 0,function(e){this.frameTime=e,this.timer&&(this.timer.delay=e)}),p.destory=function(){this.stopTimer(),this.timer=null;for(var e=this.textureList.length,t=0;e>t;t++)this.textureList[t].dispose();this.textureList.length=0},t}(egret.Bitmap);egret.registerClass(CMovieClip,"CMovieClip");var LayerManager=function(){function e(){this.tweenTime=500}var t=(__define,e);return p=t.prototype,e.getInstance=function(){return null==this.instance&&(this.instance=new e),this.instance},p.initialize=function(e){this.main=e,this.sceneLayer=new eui.Group,this.sceneLayer.percentWidth=100,this.sceneLayer.percentHeight=100,this.main.addChild(this.sceneLayer),this.popLayer=new eui.Group,this.popLayer.percentWidth=100,this.popLayer.percentHeight=100,this.popLayer.touchEnabled=!1,this.main.addChild(this.popLayer)},p.runScene=function(e,t,i){void 0===t&&(t=STween.None),void 0===i&&(i=!1),null!=this.curScene&&this.curScene&&(this.curScene.onRemove(),i&&this.curScene.onDestroy()),this.sceneLayer.addChild(e),e.inited&&e.onEnable(),this.playSceneTween(this.curScene,e,t),this.curScene=e},p.playSceneTween=function(e,t,i){var n=this;switch(i){case STween.None:e&&n.sceneLayer.removeChild(e);break;case STween.R:e&&n.sceneLayer.removeChild(e)}},e}();egret.registerClass(LayerManager,"LayerManager");var STween;!function(e){e[e.None=0]="None",e[e.R=1]="R"}(STween||(STween={}));var LoadManager=function(){function e(){this.loadComplete=new Object,this.loadError=new Object,this.loadProgress=new Object,this.thisObject=new Object}var t=(__define,e);return p=t.prototype,e.getInstance=function(){return null==this.instance&&(this.instance=new e),this.instance},p.loadGroup=function(e,t,i,n,s){void 0===i&&(i=null),void 0===n&&(n=null),void 0===s&&(s=null),this.loadComplete[e]=i,this.loadError[e]=s,this.loadProgress[e]=n,this.thisObject[e]=t,RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.loadGroup(e)},p.onResourceLoadComplete=function(e){var t=e.groupName;RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this);var i=this.loadComplete[t];null!=i&&i.call(this.thisObject[t],e),this.clearCallBack(t)},p.onResourceLoadError=function(e){console.warn("Group:"+e.groupName+" has failed to load");var t=this.loadError[e.groupName];null!=t&&t.call(this.thisObject[e.groupName],e),this.clearCallBack(e.groupName)},p.onResourceProgress=function(e){var t=this.loadProgress[e.groupName];null!=t&&t.call(this.thisObject[e.groupName],e)},p.clearCallBack=function(e){this.loadComplete[e]=null,this.loadError[e]=null,this.loadProgress[e]=null},e}();egret.registerClass(LoadManager,"LoadManager");var ObjectPool=function(){function e(e){this.className=e,this.list=[]}var t=(__define,e);return p=t.prototype,p.getObject=function(){if(this.list.length>0)return this.list.shift();var e=egret.getDefinitionByName(this.className);return new e},p.returnObject=function(e){this.list.push(e)},e.getPool=function(t,i){if(void 0===i&&(i=0),!e.pool[t]&&(e.pool[t]=new e(t),0!=i))for(var n=egret.getDefinitionByName(t),s=e.pool[t],r=0;i>r;r++)s.returnObject(new n);return e.pool[t]},e.pool={},e}();egret.registerClass(ObjectPool,"ObjectPool");var GameConst=function(){function e(){}var t=(__define,e);return p=t.prototype,e}();egret.registerClass(GameConst,"GameConst");var GameManager=function(){function e(){this.homeScene=new HomeScene,this.roleScene=new RoleScene,this.introduceScene=new IntroduceScene,this.gameScene=new GameScene,this.loseScene=new LoseScene,this.winScene=new WinScene}var t=(__define,e);return p=t.prototype,p.startup=function(){LayerManager.getInstance().runScene(this.homeScene)},e.getInstance=function(){return null==this.instance&&(this.instance=new e),this.instance},e}();egret.registerClass(GameManager,"GameManager");var BasePill=function(e){function t(){e.call(this),this.score=0}__extends(t,e);var i=(__define,t);return p=i.prototype,p.recycle=function(){},t}(egret.Bitmap);egret.registerClass(BasePill,"BasePill");var Pill=function(e){function t(){e.call(this);var t=Math.floor(4*Math.random());this.texture=RES.getRes("pill"+t+"_png"),this.score=1}__extends(t,e);var i=(__define,t);return p=i.prototype,p.recycle=function(){ObjectPool.getPool(t.NAME).returnObject(this)},t.NAME="Pill",t}(BasePill);egret.registerClass(Pill,"Pill");var Pill10=function(e){function t(){e.call(this),this.texture=RES.getRes("pill5_png"),this.score=10}__extends(t,e);var i=(__define,t);return p=i.prototype,p.recycle=function(){ObjectPool.getPool(t.NAME).returnObject(this)},t.NAME="Pill10",t}(BasePill);egret.registerClass(Pill10,"Pill10");var Pill5=function(e){function t(){e.call(this),this.texture=RES.getRes("pill4_png"),this.score=5}__extends(t,e);var i=(__define,t);return p=i.prototype,p.recycle=function(){ObjectPool.getPool(t.NAME).returnObject(this)},t.NAME="Pill5",t}(BasePill);egret.registerClass(Pill5,"Pill5");var Player=function(e){function t(){e.call(this),this.sleepTexture=RES.getRes("player0_png"),this.eatTexture=RES.getRes("player1_png"),this.texture=this.sleepTexture}__extends(t,e);var i=(__define,t);return p=i.prototype,p.eat=function(){var e=this;this.texture=this.eatTexture,egret.Tween.removeTweens(this),egret.Tween.get(this).wait(150).call(function(){e.texture=e.sleepTexture})},t}(egret.Bitmap);egret.registerClass(Player,"Player");var PoisonPill=function(e){function t(){e.call(this),this.texture=RES.getRes("pill6_png")}__extends(t,e);var i=(__define,t);return p=i.prototype,p.recycle=function(){ObjectPool.getPool(t.NAME).returnObject(this)},t.NAME="PoisonPill",t}(BasePill);egret.registerClass(PoisonPill,"PoisonPill");var EatMC=function(e){function t(){e.call(this),this.addTexture("loading-eat_png"),this.addTexture("loading-eat2_png")}__extends(t,e);var i=(__define,t);return p=i.prototype,t}(CMovieClip);egret.registerClass(EatMC,"EatMC");var LoadingUI=function(e){function t(){e.call(this),this.curProcess=0,this.addEventListener(eui.UIEvent.CREATION_COMPLETE,this.initView,this),this.skinName="resource/myskin/ui/LoadingUISkin.exml"}__extends(t,e);var i=(__define,t);return p=i.prototype,p.initView=function(){this.removeEventListener(eui.UIEvent.CREATION_COMPLETE,this.initView,this),this.pillMC0=new PillMC,this.pillMC0.x=this.pill0.x,this.pillMC0.y=this.pill0.y,this.addChild(this.pillMC0),this.removeChild(this.pill0),this.pillMC1=new PillMC,this.pillMC1.x=this.pill1.x,this.pillMC1.y=this.pill1.y,this.addChild(this.pillMC1),this.removeChild(this.pill1),this.pillMC2=new PillMC,this.pillMC2.x=this.pill2.x,this.pillMC2.y=this.pill2.y,this.addChild(this.pillMC2),this.removeChild(this.pill2),this.eatMC=new EatMC,this.eatMC.x=this.eat0.x,this.eatMC.y=this.eat0.y,this.addChild(this.eatMC),this.removeChild(this.eat0),this.eatMC.frameRate=200,this.eatMC.play()},p.setAnimByProcess=function(e){if(this.curProcess!=e)switch(this.curProcess=e,e>0&&(this.eatMC.x-=20),e){case 1:this.pillMC2.gotoAndStop(2);break;case 2:this.pillMC2.gotoAndStop(3);break;case 3:this.removeChild(this.pillMC2);break;case 4:this.pillMC1.gotoAndStop(2);break;case 5:this.pillMC1.gotoAndStop(3);break;case 6:this.removeChild(this.pillMC1);break;case 7:this.pillMC0.gotoAndStop(2);break;case 8:this.pillMC0.gotoAndStop(3);break;case 9:this.removeChild(this.pillMC0);break;case 10:this.eatMC.stop()}},p.destory=function(){},t}(eui.Component);egret.registerClass(LoadingUI,"LoadingUI");var PillMC=function(e){function t(){e.call(this),this.addTexture("loading-pill1_png"),this.addTexture("loading-pill2_png"),this.addTexture("loading-pill3_png")}__extends(t,e);var i=(__define,t);return p=i.prototype,t}(CMovieClip);egret.registerClass(PillMC,"PillMC");var GameScene=function(e){function t(){e.call(this,"resource/myskin/scene/GameSceneSkin.exml"),this.gameTimeLimit=20,this.score=0,this.time=0,this.gameTimer=new egret.Timer(1e3),this.dropTimer=new egret.Timer(300),this.dropSpeed=5,this.playerSpeed=7,this.pillPool=ObjectPool.getPool(Pill.NAME,10),this.pill5Pool=ObjectPool.getPool(Pill5.NAME,1),this.pill10Pool=ObjectPool.getPool(Pill10.NAME,1),this.poisonPool=ObjectPool.getPool(PoisonPill.NAME,1),this.pillList=[],this.player=new Player}__extends(t,e);var i=(__define,t);return p=i.prototype,p.onEnable=function(){this.player.x=this.stage.stageWidth/2,this.player.y=this.stage.stageHeight-this.player.height,this.addChild(this.player),this.setScoreLabel(0),this.setTimeLabel(this.gameTimeLimit),this.targetX=this.player.x,this.startGameTimer(),this.startDropTimer(),this.addEventListener(egret.Event.ENTER_FRAME,this.onEnterFrame,this),this.stage.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.onTouchMove,this)},p.onRemove=function(){},p.onEnterFrame=function(){this.movePlayer(),this.moveItem()},p.gameOver=function(){console.log("game over"),this.removeEventListener(egret.Event.ENTER_FRAME,this.onEnterFrame,this),this.stage.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.onTouchMove,this),this.stopGameTimer(),this.stopDropTimer();for(var e,t=this.pillList.length,i=0;t>i;i++)e=this.pillList[i],e.recycle(),this.removeChild(e);this.pillList.length=0,LayerManager.getInstance().runScene(this.time>=0?GameManager.getInstance().loseScene:GameManager.getInstance().winScene)},p.moveItem=function(){for(var e,t=this.pillList.length,i=t-1;i>=0;i--)if(e=this.pillList[i],e.y+=this.dropSpeed,e.y>=GameConst.stage.stageHeight)this.pillList.splice(i,1),e.recycle(),this.removeChild(e);else if(this.hitTest(this.player,e)){if(this.pillList.splice(i,1),e.recycle(),this.removeChild(e),this.player.eat(),e instanceof PoisonPill)return void this.gameOver();this.score+=e.score,this.setScoreLabel(this.score)}},p.movePlayer=function(){Math.abs(this.targetX-this.player.x)<this.playerSpeed?this.player.x=this.targetX:this.targetX>this.player.x?this.player.x+=this.playerSpeed:this.player.x-=this.playerSpeed},p.onTouchMove=function(e){this.targetX=e.stageX-this.player.width/2},p.hitTest=function(e,t){var i=e.getBounds(),n=t.getBounds();return i.width-=30,i.height-=30,i.x=e.x+30,i.y=e.y+30,n.x=t.x,n.y=t.y,i.intersects(n)},p.setScoreLabel=function(e){this.score=e,this.scoreLabel.text=this.score.toString()},p.setTimeLabel=function(e){this.time=e,this.timeLabel.text=this.time.toString()},p.startGameTimer=function(){this.gameTimer.addEventListener(egret.TimerEvent.TIMER,this.onGameTimerHandler,this),this.gameTimer.reset(),this.gameTimer.start()},p.onGameTimerHandler=function(){return this.time--,this.time<0?void this.gameOver():void this.setTimeLabel(this.time)},p.stopGameTimer=function(){this.gameTimer.stop()},p.startDropTimer=function(){this.dropTimer.addEventListener(egret.TimerEvent.TIMER,this.onDropTimerHandler,this),this.dropTimer.reset(),this.dropTimer.start()},p.onDropTimerHandler=function(){var e,t=Math.floor(100*Math.random());e=80>t?this.pillPool.getObject():85>t?this.pill5Pool.getObject():90>t?this.pill10Pool.getObject():this.poisonPool.getObject(),e.x=10+Math.random()*(GameConst.stage.stageWidth-80),e.y=-e.height,this.addChild(e),this.pillList.push(e)},p.stopDropTimer=function(){this.dropTimer.stop()},t}(BaseScene);egret.registerClass(GameScene,"GameScene");var HomeScene=function(e){function t(){e.call(this,"resource/myskin/scene/HomeSceneSkin.exml"),this.turnAngle=60,this.turnTime=1500,this.figureList=[],this.curFigureIndex=0}__extends(t,e);var i=(__define,t);return p=i.prototype,p.componentCreated=function(){e.prototype.componentCreated.call(this),this.figureList.push(this.figure1,this.figure2,this.figure3,this.figure4),this.figure1.parent.removeChild(this.figure1),this.figure2.parent.removeChild(this.figure2),this.figure3.parent.removeChild(this.figure3),this.scanInitY=this.scan.y},p.onEnable=function(){this.scan.y=this.scanInitY,this.ringAnimFront(),this.zw.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchBegin,this),this.zw.addEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEnd,this)},p.onRemove=function(){egret.Tween.removeAllTweens(),this.ring1.rotation=0,this.ring2.rotation=0,this.ring3.rotation=0,this.ring4.rotation=0,this.onTouchEnd()},p.onTouchBegin=function(){this.scanAnim();var e=this;this.timeoutID=setTimeout(function(){e.nextScene()},1e3)},p.onTouchEnd=function(){clearTimeout(this.timeoutID)},p.nextScene=function(){LayerManager.getInstance().runScene(GameManager.getInstance().roleScene)},p.ringAnimFront=function(){var e=this;egret.Tween.get(this.ring1).to({rotation:this.turnAngle},this.turnTime),egret.Tween.get(this.ring2).to({rotation:-this.turnAngle},this.turnTime),egret.Tween.get(this.ring3).to({rotation:-this.turnAngle},this.turnTime),egret.Tween.get(this.ring4).to({rotation:-this.turnAngle},this.turnTime),egret.Tween.get(this.ring5).to({rotation:-this.turnAngle/3},this.turnTime).call(function(){e.ringAnimBack()})},p.ringAnimBack=function(){var e=this;egret.Tween.get(this.ring1).to({rotation:-this.turnAngle},this.turnTime),egret.Tween.get(this.ring2).to({rotation:this.turnAngle},this.turnTime),egret.Tween.get(this.ring3).to({rotation:this.turnAngle},this.turnTime),egret.Tween.get(this.ring4).to({rotation:this.turnAngle},this.turnTime),egret.Tween.get(this.ring5).to({rotation:this.turnAngle/3},this.turnTime).call(function(){e.ringAnimFront()})},p.figureAnim=function(){var e=this.figureList[this.curFigureIndex];this.curFigureIndex++,this.curFigureIndex>=this.figureList.length&&(this.curFigureIndex=0),e.alpha=0,e.scaleX=.5,e.scaleY=.5,egret.Tween.get(e).to({alpha:1,scaleX:1,scaleY:1},1e3,egret.Ease.backOut).call(function(){})},p.scanAnim=function(){var e=this;egret.Tween.get(this).wait(150).call(function(){e.scan.y+=50,e.scan.y>e.scanInitY+150&&(e.scan.y=e.scanInitY),e.scanAnim()})},t}(BaseScene);egret.registerClass(HomeScene,"HomeScene");var IntroduceScene=function(e){function t(){e.call(this,"resource/myskin/scene/IntroduceSceneSkin.exml"),this.bgList=[],this.curBgIndex=0,this.bgList.push(this.bg1,this.bg2,this.bg3)}__extends(t,e);var i=(__define,t);return p=i.prototype,p.onEnable=function(){this.bgAnim(),this.handAnimLeft()},p.onRemove=function(){egret.Tween.removeAllTweens(),this.hand.x=50,this.addChild(this.bg1),this.curBgIndex=0},p.bgAnim=function(){var e=this;egret.Tween.get(this).wait(1e3).call(function(){return e.curBgIndex++,e.curBgIndex>=e.bgList.length?void e.nextScene():(e.addChild(e.bgList[e.curBgIndex]),void e.bgAnim())})},p.handAnimLeft=function(){var e=this;egret.Tween.get(this.hand).to({x:this.hand.x-100},500).call(function(){e.handAnimRight()})},p.handAnimRight=function(){var e=this;egret.Tween.get(this.hand).to({x:this.hand.x+100},500).call(function(){e.handAnimLeft()})},p.nextScene=function(){LayerManager.getInstance().runScene(GameManager.getInstance().gameScene)},t}(BaseScene);egret.registerClass(IntroduceScene,"IntroduceScene");var LoseScene=function(e){function t(){e.call(this,"resource/myskin/scene/LoseSceneSkin.exml")}__extends(t,e);var i=(__define,t);return p=i.prototype,p.onEnable=function(){this.linkBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onLinkBtnTouch,this),this.againBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onAgainBtnTouch,this)},p.onRemove=function(){this.linkBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onLinkBtnTouch,this),this.againBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onAgainBtnTouch,this)},p.onLinkBtnTouch=function(){alert("点击链接")},p.onAgainBtnTouch=function(){LayerManager.getInstance().runScene(GameManager.getInstance().gameScene)},t}(BaseScene);egret.registerClass(LoseScene,"LoseScene");var PreloadScene=function(e){function t(){e.call(this,"resource/myskin/scene/PreloadSkin.exml")}__extends(t,e);var i=(__define,t);return p=i.prototype,p.setAnimByProcess=function(e){this.loadingUI.setAnimByProcess(e)},t}(BaseScene);egret.registerClass(PreloadScene,"PreloadScene");var RoleScene=function(e){function t(){e.call(this,"resource/myskin/scene/RoleSceneSkin.exml")}__extends(t,e);var i=(__define,t);return p=i.prototype,p.onEnable=function(){this.ringAnimFast(),this.okBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onOkBtnTouch,this),this.noBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onNoBtnTouch,this)},p.onRemove=function(){egret.Tween.removeAllTweens(),this.ring1.rotation=0,this.ring2.rotation=0},p.onOkBtnTouch=function(){LayerManager.getInstance().runScene(GameManager.getInstance().introduceScene)},p.onNoBtnTouch=function(){LayerManager.getInstance().runScene(GameManager.getInstance().homeScene)},p.ringAnimFast=function(){var e=this;egret.Tween.get(this.ring1).to({rotation:this.ring1.rotation+300},1e3),egret.Tween.get(this.ring2).to({rotation:this.ring2.rotation+270},1e3).call(function(){e.ringAnimSlow()})},p.ringAnimSlow=function(){var e=this;egret.Tween.get(this.ring1).to({rotation:this.ring1.rotation+320},2e3),egret.Tween.get(this.ring2).to({rotation:this.ring2.rotation+270},2e3).call(function(){e.ringAnimFast()})},t}(BaseScene);egret.registerClass(RoleScene,"RoleScene");var WinScene=function(e){function t(){e.call(this,"resource/myskin/scene/WinSceneSkin.exml")}__extends(t,e);var i=(__define,t);return p=i.prototype,p.onEnable=function(){this.shareHand.parent&&this.removeChild(this.shareHand),this.shareBg.parent&&this.removeChild(this.shareBg),this.setScoreLabel(GameManager.getInstance().gameScene.score),this.shareBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onShareBtnTouch,this),this.againBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onAgainBtnTouch,this)},p.onRemove=function(){this.shareBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onShareBtnTouch,this),this.againBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onAgainBtnTouch,this)},p.setScoreLabel=function(e){this.scoreLabel.text=e.toString()},p.onShareBtnTouch=function(){this.addChild(this.shareBg),this.addChild(this.shareHand),this.shareBg.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onShareBgTouch,this)},p.onShareBgTouch=function(){this.shareBg.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onShareBgTouch,this),this.removeChild(this.shareBg),this.removeChild(this.shareHand)},p.onAgainBtnTouch=function(){LayerManager.getInstance().runScene(GameManager.getInstance().homeScene)},t}(BaseScene);egret.registerClass(WinScene,"WinScene");var Main=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var i=(__define,t);return p=i.prototype,p.createChildren=function(){e.prototype.createChildren.call(this);var t=new AssetAdapter;this.stage.registerImplementation("eui.IAssetAdapter",t),this.stage.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/default.res.json","resource/")},p.onConfigComplete=function(){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this);var e=new eui.Theme("resource/default.thm.json",this.stage);e.addEventListener(eui.UIEvent.COMPLETE,this.onThemeLoadComplete,this)},p.onThemeLoadComplete=function(){LoadManager.getInstance().loadGroup("preload",this,this.onPreloadComplete)},p.onPreloadComplete=function(){this.preloadScene=new PreloadScene,this.addChild(this.preloadScene),LoadManager.getInstance().loadGroup("game",this,this.onGameComplete,this.onGameProgress)},p.onGameProgress=function(e){this.preloadScene.setAnimByProcess(Math.floor(e.itemsLoaded/e.itemsTotal*10))},p.onGameComplete=function(){this.removeChild(this.preloadScene),this.preloadScene=null,this.createScene()},p.createScene=function(){GameConst.stage=this.stage,LayerManager.getInstance().initialize(this),GameManager.getInstance().startup()},t}(eui.UILayer);egret.registerClass(Main,"Main");var ThemeAdapter=function(){function e(){}var t=(__define,e);return p=t.prototype,p.getTheme=function(e,t,i,n){function s(e){t.call(n,e)}function r(t){t.resItem.url==e&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,r,null),i.call(n))}RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,r,null),RES.getResByUrl(e,s,this,RES.ResourceItem.TYPE_TEXT)},e}();egret.registerClass(ThemeAdapter,"ThemeAdapter",["eui.IThemeAdapter"]);