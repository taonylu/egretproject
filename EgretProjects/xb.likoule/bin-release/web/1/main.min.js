var AssetAdapter=function(){function e(){}var t=(__define,e),i=t.prototype;return i.getAsset=function(e,t,i){function s(s){t.call(i,s,e)}if(RES.hasRes(e)){var n=RES.getRes(e);n?s(n):RES.getResAsync(e,s,this)}else RES.getResByUrl(e,s,this,RES.ResourceItem.TYPE_IMAGE)},e}();egret.registerClass(AssetAdapter,"AssetAdapter",["eui.IAssetAdapter"]);var GameConst=function(){function e(){}var t=(__define,e);t.prototype;return e.orientation=0,e.teamName="",e.debug=!1,e.myName="",e.invitInfo={isInvit:0,nickName:"",teamName:""},e.validSigne={keyword:"",timestamp:0,signature:""},e}();egret.registerClass(GameConst,"GameConst");var GameManager=function(){function e(){this.homeScene=new HomeScene,this.gameScene=new GameScene,this.resultScene=new ResultScene,this.rulePanel=new RulePanel,this.prizePanel=new PrizePanel,this.rankPanel=new RankPanel,this.teamForm=new TeamForm,this.sharePanel=new SharePanel,this.myTeamPanel=new MyTeamPanel,this.luckForm=new LuckForm}var t=(__define,e),i=t.prototype;return i.startup=function(e){GameConst.csrf=window.csrf,GameConst.myName=window.nickName,egret.log("myName:",GameConst.myName),GameConst.debug?(GameConst.invitInfo.isInvit=1,GameConst.invitInfo.nickName="XXXX",GameConst.invitInfo.teamName="XXXX"):GameConst.invitInfo=window.invitInfo,egret.log("invitInfo:",GameConst.invitInfo.isInvit,GameConst.invitInfo.nickName,GameConst.invitInfo.teamName),window.GM=this,GameConst.stage=e.stage,LayerManager.getInstance().initialize(e),LayerManager.getInstance().runScene(this.homeScene)},i.onOrientation=function(e){egret.log(e),GameConst.orientation=e,this.resultScene.parent&&this.resultScene.showCode(),this.sharePanel.parent&&this.sharePanel.onEnable()},e.getInstance=function(){return null==this.instance&&(this.instance=new e),this.instance},e}();egret.registerClass(GameManager,"GameManager");var LayerManager=function(){function e(){this.tweenTime=500}var t=(__define,e),i=t.prototype;return i.initialize=function(e){this.main=e,this.sceneLayer=new eui.Group,this.sceneLayer.percentWidth=100,this.sceneLayer.percentHeight=100,this.main.addChild(this.sceneLayer),this.popLayer=new eui.Group,this.popLayer.percentWidth=100,this.popLayer.percentHeight=100,this.popLayer.touchEnabled=!1,this.popLayer.touchThrough=!0,this.main.addChild(this.popLayer)},i.runScene=function(e,t){void 0===t&&(t=!1),null!=this.curScene&&this.curScene&&(this.sceneLayer.removeChild(this.curScene),this.curScene.onRemove(),t&&this.curScene.onDestroy()),this.curScene=e,this.sceneLayer.addChild(e),e.inited&&e.onEnable()},i.clearPopLayer=function(){var e=this.popLayer.numChildren;if(e>0)for(var t=0;e>t;t++)this.popLayer.removeChildAt(t)},e.getInstance=function(){return null==this.instance&&(this.instance=new e),this.instance},e}();egret.registerClass(LayerManager,"LayerManager");var LoadManager=function(){function e(){this.loadComplete=new Object,this.loadError=new Object,this.loadProgress=new Object,this.thisObject=new Object}var t=(__define,e),i=t.prototype;return e.getInstance=function(){return null==this.instance&&(this.instance=new e),this.instance},i.loadGroup=function(e,t,i,s,n){void 0===i&&(i=null),void 0===s&&(s=null),void 0===n&&(n=null),this.loadComplete[e]=i,this.loadError[e]=n,this.loadProgress[e]=s,this.thisObject[e]=t,RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.loadGroup(e)},i.onResourceLoadComplete=function(e){var t=e.groupName;RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this);var i=this.loadComplete[t];null!=i&&i.call(this.thisObject[t],e),this.clearCallBack(t)},i.onResourceLoadError=function(e){console.warn("Group:"+e.groupName+" has failed to load");var t=this.loadError[e.groupName];null!=t&&t.call(this.thisObject[e.groupName],e),this.clearCallBack(e.groupName)},i.onResourceProgress=function(e){var t=this.loadProgress[e.groupName];null!=t&&t.call(this.thisObject[e.groupName],e)},i.clearCallBack=function(e){this.loadComplete[e]=null,this.loadError[e]=null,this.loadProgress[e]=null},e}();egret.registerClass(LoadManager,"LoadManager");var MapManager=function(){function e(){this.rowMax=10,this.colMax=9,this.level=new Array,this.level1=[[0,1,0,0,1,0,0],[0,0,1,0,0,1,0],[0,0,1,0,0,0,0],[0,0,0,0,0,1,0],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]]}var t=(__define,e);t.prototype;return e.getInstance=function(){return null==this.instance&&(this.instance=new e),this.instance},e}();egret.registerClass(MapManager,"MapManager");var BaseScene=function(e){function t(t){e.call(this),this.inited=!1,this.percentWidth=100,this.percentHeight=100,this.touchEnabled=!1,this.addEventListener(eui.UIEvent.CREATION_COMPLETE,this.componentCreated,this),this.skinName=t}__extends(t,e);var i=(__define,t),s=i.prototype;return s.componentCreated=function(){this.removeEventListener(eui.UIEvent.CREATION_COMPLETE,this.componentCreated,this),this.inited=!0},s.onEnable=function(){},s.onRemove=function(){},s.hide=function(){this.parent&&this.parent.removeChild(this)},s.onDestroy=function(){},t}(eui.Component);egret.registerClass(BaseScene,"BaseScene");var BaseUI=function(e){function t(t){e.call(this),this.inited=!1,this.addEventListener(eui.UIEvent.CREATION_COMPLETE,this.componentCreated,this),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.onEnable,this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemove,this),this.skinName=t}__extends(t,e);var i=(__define,t),s=i.prototype;return s.componentCreated=function(){this.removeEventListener(eui.UIEvent.CREATION_COMPLETE,this.componentCreated,this),this.inited=!0},s.onEnable=function(){},s.onRemove=function(){},s.hide=function(){this.parent&&this.parent.removeChild(this)},t}(eui.Component);egret.registerClass(BaseUI,"BaseUI");var CImageLoader=function(){function e(){this.loader=new egret.ImageLoader}var t=(__define,e),i=t.prototype;return i.load=function(e){this.loader.addEventListener(egret.Event.COMPLETE,this.loadCompleteHandler,this),this.loader.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onLoadError,this),this.loader.load(e)},i.loadCompleteHandler=function(e){var t=e.currentTarget,i=new egret.Bitmap(t.data);i.width=60,i.height=60,this.doc.addChild(i)},i.onLoadError=function(){alert("加载头像错误")},i.clear=function(){this.doc&&this.doc.numChildren>0&&this.doc.removeChildAt(0)},e}();egret.registerClass(CImageLoader,"CImageLoader");var DateTimer=function(e){function t(t,i){void 0===i&&(i=0),e.call(this),this.delay=t,this.repeatCount=i}__extends(t,e);var i=(__define,t),s=i.prototype;return s.start=function(){this.$previous=egret.getTimer(),this.$accTime=0,egret.startTick(this.update,this)},s.reset=function(){this.$previous=egret.getTimer(),this.$accTime=0,this.currentCount=0},s.stop=function(){egret.stopTick(this.update,this)},s.update=function(){for(this.$curTime=egret.getTimer(),this.$passTime=this.$curTime-this.$previous,this.$previous=this.$curTime,this.$accTime+=this.$passTime;this.$accTime>=this.delay;)this.$accTime-=this.delay,this.currentCount++,this.repeatCount>0&&this.currentCount==this.repeatCount&&(this.dispatchEvent(new egret.TimerEvent(egret.TimerEvent.TIMER_COMPLETE)),this.stop()),this.dispatchEvent(new egret.TimerEvent(egret.TimerEvent.TIMER));return!1},t}(egret.EventDispatcher);egret.registerClass(DateTimer,"DateTimer");var HttpUtil=function(){function e(){this.httpMethod=egret.HttpMethod.GET,this.request=new egret.HttpRequest,this.request.responseType=egret.HttpResponseType.TEXT,this.request.addEventListener(egret.Event.COMPLETE,this.onPostComplete,this),this.request.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onPostIOError,this)}var t=(__define,e),i=t.prototype;return i.send=function(e,t,i){this.thisObject=i,this.request.open(e,this.httpMethod),this.request.setRequestHeader("Content-type","application/x-www-form-urlencoded"),""!=t?this.request.send(t):this.request.send()},i.onPostComplete=function(e){this.completeHandler&&this.completeHandler.call(this.thisObject,this.request.response)},i.onPostIOError=function(e){egret.log("http error"),this.errorHandler&&this.errorHandler.call(this.thisObject,e)},e}();egret.registerClass(HttpUtil,"HttpUtil");var LabelFactory=function(){function e(){}var t=(__define,e);t.prototype;return e.getLabel=function(){var e=new eui.Label;return e.verticalAlign=egret.VerticalAlign.MIDDLE,e.textAlign=egret.HorizontalAlign.CENTER,e.size=25,e.fontFamily="微软雅黑",e.textColor=0,e},e}();egret.registerClass(LabelFactory,"LabelFactory");var ObjectPool=function(){function e(e){this.className=e,this.list=[]}var t=(__define,e),i=t.prototype;return i.getObject=function(){if(this.list.length>0)return this.list.shift();var e=egret.getDefinitionByName(this.className);return new e},i.returnObject=function(e){this.list.push(e)},e.getPool=function(t,i){if(void 0===i&&(i=0),!e.pool[t]&&(e.pool[t]=new e(t),0!=i))for(var s=egret.getDefinitionByName(t),n=e.pool[t],r=0;i>r;r++)n.returnObject(new s);return e.pool[t]},e.pool={},e}();egret.registerClass(ObjectPool,"ObjectPool");var QRCode=function(){function e(){}var t=(__define,e),i=t.prototype;return i.createCode=function(){if(null==this.myImg){egret.log("create");var e=document.getElementById("gameDiv");this.myImg=document.createElement("img"),this.myImg.src="resource/assets/codeHitArea.png",this.myImg.style.position="absolute",this.myImg.style.display="none",e.appendChild(this.myImg)}},i.showCode=function(){this.myImg&&(egret.log("show"),this.myImg.style.display="inline")},i.hideCode=function(){this.myImg&&(this.myImg.style.display="none")},i.setPosition=function(e,t){if(this.myImg){egret.log("setPos");var i,s=document.body.clientWidth,n=document.body.clientHeight,r=(GameConst.stage.stageWidth,GameConst.stage.stageHeight);s>n?(i=n/r,this.myImg.style.width=150*i+"px",this.myImg.style.height=150*i*248/215+"px",this.myImg.style.top=t*i+"px",this.myImg.style.left=e*i+"px"):(i=s/r,this.myImg.style.width=150*i+"px",this.myImg.style.height=150*i*248/215+"px",this.myImg.style.right=i*t+"px",this.myImg.style.top=i*e+"px")}},e}();egret.registerClass(QRCode,"QRCode");var SimpleMC=function(e){function t(t,i,s){var n=RES.getRes(t),r=RES.getRes(i),a=new egret.MovieClipDataFactory(r,n);e.call(this,a.generateMovieClipData(s))}__extends(t,e);var i=(__define,t);i.prototype;return t}(egret.MovieClip);egret.registerClass(SimpleMC,"SimpleMC");var GameScene=function(e){function t(){e.call(this,"GameSceneSkin"),this.bee=new Bee,this.grass=0,this.timeLimit=15,this.gameTimer=new DateTimer(1e3),this.itemList=new Array,this.item2Pool=ObjectPool.getPool(Item2.NAME,5),this.item5Pool=ObjectPool.getPool(Item5.NAME,5),this.score2Pool=ObjectPool.getPool(Score2.NAME,5),this.score5Pool=ObjectPool.getPool(Score5.NAME,5),this.score20Pool=ObjectPool.getPool(Score20.NAME,3),this.ballPool=ObjectPool.getPool(Ball.NAME,3),this.countDownTimer=new egret.Timer(600),this.countDownLimit=3,this.http=new HttpUtil,this.itemCount=0}__extends(t,e);var i=(__define,t),s=i.prototype;return s.componentCreated=function(){e.prototype.componentCreated.call(this),this.stageWidth=GameConst.stage.stageWidth,this.stageHeight=GameConst.stage.stageHeight,this.initHandY=this.hand.y},s.onEnable=function(){this.reset(),this.startCountDown()},s.onRemove=function(){this.bee.stop()},s.configListeners=function(){this.controlBtn.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.onControlTouch,this),this.addEventListener(egret.Event.ENTER_FRAME,this.onEnterFrame,this)},s.deConfigListeners=function(){this.controlBtn.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.onControlTouch,this),this.removeEventListener(egret.Event.ENTER_FRAME,this.onEnterFrame,this)},s.onEnterFrame=function(){this.createItem(),this.moveBee(),this.gameBg.render(),this.moveItem()},s.startGame=function(){this.startGameTimer(),this.configListeners(),this.bee.play(1e4),this.addChild(this.bee)},s.reset=function(){this.score=0,this.scoreLabel.text=this.score+"",this.curTime=this.timeLimit,this.timeLabel.text=this.curTime+"s",this.grass=0,this.bee.play(1e4),this.bee.x=this.controlBtn.x+this.controlBtn.width,this.bee.y=(this.stageHeight-this.bee.height)/2,this.bee.parent&&this.removeChild(this.bee),this.gameBg.reset();for(var e=this.itemList.length,t=0;e>t;t++){var i=this.itemList[t];i.recycle()}this.itemList.length=0,this.curFingerPos=this.bee.y},s.gameOver=function(){this.deConfigListeners(),this.stopGameTimer();var e=GameManager.getInstance().resultScene;LayerManager.getInstance().runScene(e),e.setSceneValue(0,this.score,this.grass),this.sendSaveScoreRequeset()},s.sendSaveScoreRequeset=function(){if(egret.log("sendSaveScore"),GameConst.debug){var e={status:!0,code:200,msg:""};this.revSaveScore(JSON.stringify(e))}else{this.http.completeHandler=this.revSaveScore,this.http.httpMethod=egret.HttpMethod.POST;var t=window.httpUrl+"gamescore",i="_csrf="+GameConst.csrf,s="&score="+this.score,n="&teamName="+GameConst.teamName,r=GameConst.validSigne,a="&keyword="+r.keyword,o="&timestamp="+r.timestamp,h="&signature="+r.signature,c=i+s+n+a+o+h;this.http.send(t,c,this)}},s.revSaveScore=function(e){egret.log("revSaveScore:",e);var t=JSON.parse(e),i=t.status,s=t.code,n=t.msg;1==i&&200==s||alert(n)},s.onControlTouch=function(e){this.curFingerPos=e.stageY,this.bee.y>e.stageY?this.bee.direction=-1:this.bee.direction=1},s.moveBee=function(){Math.abs(this.bee.y-this.curFingerPos)>this.bee.speedY&&(this.bee.y+=this.bee.direction*this.bee.speedY)},s.moveItem=function(){for(var e,t=this.itemList.length,i=t-1;i>=0;i--)e=this.itemList[i],e.x-=this.bee.speedX,e.x<=-e.width?(e.recycle(),this.itemList.splice(i,1)):Math.abs(e.y+25-this.bee.y)<50&&Math.abs(e.x-this.bee.x)<50&&(this.createScoreText(e),e.recycle(),this.itemList.splice(i,1),this.score+=e.score,this.scoreLabel.text=this.score+"",this.grass++)},s.createItem=function(){if(this.itemCount++,this.itemCount>8){this.itemCount=0;var e,t=Math.random();t>.5?e=ObjectPool.getPool(Item2.NAME).getObject():t>.1?e=ObjectPool.getPool(Item5.NAME).getObject():(e=ObjectPool.getPool(Ball.NAME).getObject(),e.play(1e3)),this.itemList.push(e),e.x=this.stageWidth+e.width,e.y=50+(this.stageHeight-100)*Math.random(),this.addChild(e)}},s.createScoreText=function(e){var t,i=e.score;t=2==i?ObjectPool.getPool(Score2.NAME).getObject():5==i?ObjectPool.getPool(Score5.NAME).getObject():ObjectPool.getPool(Score20.NAME).getObject(),t.x=e.x,t.y=e.y,this.addChild(t);egret.Tween.get(t).wait(300).call(function(){t.recycle()},this)},s.startGameTimer=function(){this.gameTimer.addEventListener(egret.TimerEvent.TIMER,this.onGameTimerHandler,this),this.gameTimer.reset(),this.gameTimer.start()},s.onGameTimerHandler=function(e){this.curTime--,this.timeLabel.text=this.curTime+"s",this.curTime<=0&&this.gameOver()},s.stopGameTimer=function(){this.gameTimer.stop(),this.gameTimer.removeEventListener(egret.TimerEvent.TIMER,this.onGameTimerHandler,this)},s.startCountDown=function(){this.countDownGroup.visible=!0,this.countDown1.visible=!1,this.countDown2.visible=!1,this.countDown3.visible=!0,this.countDownTimer.addEventListener(egret.TimerEvent.TIMER,this.onCountDown,this),this.countDownTimer.reset(),this.countDownTimer.start(),this.hand.y=this.initHandY,egret.Tween.get(this.hand,{loop:3}).to({y:this.initHandY+100},500).to({y:this.initHandY},500)},s.onCountDown=function(){var e=this.countDownLimit-this.countDownTimer.currentCount;2==e?(this.countDown3.visible=!1,this.countDown2.visible=!0):1==e?(this.countDown2.visible=!1,this.countDown1.visible=!0):(this.countDownGroup.visible=!1,this.countDownTimer.removeEventListener(egret.TimerEvent.TIMER,this.onCountDown,this),this.countDownTimer.stop(),egret.Tween.removeTweens(this.hand),this.startGame())},t}(BaseScene);egret.registerClass(GameScene,"GameScene");var Ball=function(e){function t(){e.call(this,"ball_png","ball_json","ball"),this.score=20}__extends(t,e);var i=(__define,t),s=i.prototype;return s.recycle=function(){this.stop(),this.parent&&this.parent.removeChild(this),ObjectPool.getPool(t.NAME).returnObject(this)},t.NAME="Ball",t}(SimpleMC);egret.registerClass(Ball,"Ball");var BaseItem=function(e){function t(t){e.call(this),this.score=0,this.bitmapData=RES.getRes(t)}__extends(t,e);var i=(__define,t),s=i.prototype;return s.reset=function(){},s.hide=function(){this.parent&&this.parent.removeChild(this)},s.recycle=function(){},t}(egret.Bitmap);egret.registerClass(BaseItem,"BaseItem");var Bee=function(e){function t(){e.call(this,"bee_png","bee_json","bee"),this.direction=0,this.speedX=8,this.speedY=8,this.anchorOffsetX=this.width/2,this.anchorOffsetY=this.height/2+30}__extends(t,e);var i=(__define,t);i.prototype;return t}(SimpleMC);egret.registerClass(Bee,"Bee");var Item2=function(e){function t(){e.call(this,"item00"),this.score=2}__extends(t,e);var i=(__define,t),s=i.prototype;return s.recycle=function(){this.hide(),ObjectPool.getPool(t.NAME).returnObject(this)},t.NAME="Item2",t}(BaseItem);egret.registerClass(Item2,"Item2");var Item5=function(e){function t(){e.call(this,"item01"),this.score=5}__extends(t,e);var i=(__define,t),s=i.prototype;return s.recycle=function(){this.hide(),ObjectPool.getPool(t.NAME).returnObject(this)},t.NAME="Item5",t}(BaseItem);egret.registerClass(Item5,"Item5");var Score2=function(e){function t(){e.call(this,"num2")}__extends(t,e);var i=(__define,t),s=i.prototype;return s.recycle=function(){this.hide(),ObjectPool.getPool(t.NAME).returnObject(this)},t.NAME="Score2",t}(BaseItem);egret.registerClass(Score2,"Score2");var Score20=function(e){function t(){e.call(this,"num20")}__extends(t,e);var i=(__define,t),s=i.prototype;return s.recycle=function(){this.hide(),ObjectPool.getPool(t.NAME).returnObject(this)},t.NAME="Score20",t}(BaseItem);egret.registerClass(Score20,"Score20");var Score5=function(e){function t(){e.call(this,"num5")}__extends(t,e);var i=(__define,t),s=i.prototype;return s.recycle=function(){this.hide(),ObjectPool.getPool(t.NAME).returnObject(this)},t.NAME="Score5",t}(BaseItem);egret.registerClass(Score5,"Score5");var GameBg=function(e){function t(){e.call(this,"GameBgSkin"),this.skySpeed=-.1,this.hillSpeed=-.5,this.grassSpeed=-2}__extends(t,e);var i=(__define,t),s=i.prototype;return s.componentCreated=function(){e.prototype.componentCreated.call(this),this.reset()},s.render=function(){this.grass.x+=this.grassSpeed,this.grass0.x+=this.grassSpeed,this.grass.x<-this.grass.width?this.grass.x=this.grass0.x+this.grass0.width:this.grass0.x<-this.grass0.width&&(this.grass0.x=this.grass.x+this.grass.width)},s.reset=function(){this.sky.x=0,this.hill.x=0,this.grass.x=0,this.sky0.x=this.sky.width,this.hill0.x=this.hill.width,this.grass0.x=this.grass.width},t}(BaseUI);egret.registerClass(GameBg,"GameBg");var HomeScene=function(e){function t(){e.call(this,"HomeSceneSkin"),this.http=new HttpUtil,this.bFirstEnter=!0}__extends(t,e);var i=(__define,t),s=i.prototype;return s.componentCreated=function(){e.prototype.componentCreated.call(this),window.playBGM()},s.onEnable=function(){this.acceptGroup.visible=!1,this.invitFailGroup.visible=!1,this.beginGroup.visible=!1,this.rankGroup.visible=!0;var e=GameConst.invitInfo;this.bFirstEnter&&e.isInvit?(this.bFirstEnter=!1,this.acceptGroup.visible=!0,this.acceptLabel.text=e.nickName+" 邀请你参加"+e.teamName+"队伍"):this.beginGroup.visible=!0,this.configListeners()},s.onRemove=function(){},s.configListeners=function(){this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTap,this)},s.deConfigListeners=function(){this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTap,this)},s.onTouchTap=function(e){switch(e.target){case this.acceptBtn:this.sendAcceptRequest();break;case this.ruleBtn:case this.ruleBtn2:this.addChild(GameManager.getInstance().rulePanel);break;case this.closeInvitBtn:this.invitFailGroup.visible=!1,this.beginGroup.visible=!0;break;case this.beginBtn:this.sendStartGame();break;case this.teamBtn:this.sendTeamRequest();break;case this.rankBtn:this.sendRankRequest();break;case this.prizeBtn:GameConst.prizeLastView=this,this.sendPrizeRequest()}},s.sendAcceptRequest=function(){if(egret.log("sendAccept,teamName=",GameConst.invitInfo.teamName),GameConst.debug){var e={status:!1,code:400,msg:"失败"};this.revAccept(JSON.stringify(e))}else{this.http.completeHandler=this.revAccept,this.http.httpMethod=egret.HttpMethod.POST;var t=window.httpUrl+"acceptinvitation",i="_csrf="+GameConst.csrf+"&teamName="+GameConst.invitInfo.teamName;this.http.send(t,i,this)}},s.revAccept=function(e){egret.log("revAccept:",e);var t=JSON.parse(e),i=t.status,s=t.code,n=t.msg;this.acceptGroup.visible=!1,1==i&&200==s?(this.beginGroup.visible=!0,GameConst.teamName=GameConst.invitInfo.teamName):(GameConst.teamName="",this.invitFailGroup.visible=!0,this.invitFailLabel.text=n)},s.sendStartGame=function(){if(egret.log("sendStartGame"),GameConst.debug){var e={status:!0,code:200,msg:"aa",data:{teamName:"ABCD",validSigne:{keyword:"",timestamp:123,signature:""}}};this.revStartGame(JSON.stringify(e))}else{this.http.completeHandler=this.revStartGame,this.http.httpMethod=egret.HttpMethod.POST;var t=window.httpUrl+"createteam ",i="_csrf="+GameConst.csrf;this.http.send(t,i,this)}},s.revStartGame=function(e){egret.log("revStartGame:",e);var t=JSON.parse(e),i=t.status,s=t.code,n=t.msg,r=t.data;1==i&&200==s?(GameConst.teamName=r.teamName,GameConst.validSigne.keyword=r.validSigne.keyword,GameConst.validSigne.timestamp=r.validSigne.timestamp,GameConst.validSigne.signature=r.validSigne.signature,LayerManager.getInstance().runScene(GameManager.getInstance().gameScene),window.tn=GameConst.teamName,window.nick=GameConst.myName,window.wxshare()):alert(n)},s.sendTeamRequest=function(){if(egret.log("sendTeam"),GameConst.debug){var e={status:!0,code:200,msg:"aa",data:{teamName:"ABCD"}};this.revTeam(JSON.stringify(e))}else{this.http.completeHandler=this.revTeam,this.http.httpMethod=egret.HttpMethod.POST;var t=window.httpUrl+"createteam ",i="_csrf="+GameConst.csrf;this.http.send(t,i,this)}},s.revTeam=function(e){egret.log("revTeam:",e);var t=JSON.parse(e),i=t.status,s=t.code,n=t.msg,r=t.data;1==i&&200==s?(GameConst.teamName=r.teamName,window.tn=GameConst.teamName,window.nick=GameConst.myName,window.wxshare(),this.addChild(GameManager.getInstance().sharePanel)):alert(n)},s.sendRankRequest=function(){if(egret.log("sendRank"),GameConst.debug){var e={status:!0,code:200,data:[{teamName:"队名1",teamScore:"分数"},{teamName:"队名2",teamScore:"分数"},{teamName:"队名3",teamScore:"分数"},{teamName:"队名4",teamScore:"分数"},{teamName:"队名5",teamScore:"分数"},{teamName:"队名6",teamScore:"分数"},{teamName:"队名7",teamScore:"分数"},{teamName:"队名8",teamScore:"分数"},{teamName:"队名9",teamScore:"分数"},{teamName:"队名10",teamScore:"分数"},{teamName:"队名11",teamScore:"分数"},{teamName:"队名12",teamScore:"分数"},{teamName:"队名13",teamScore:"分数"},{teamName:"队名14",teamScore:"分数"},{teamName:"队名15",teamScore:"分数"},{teamName:"队名16",teamScore:"分数"}]};this.revRank(JSON.stringify(e))}else{this.http.completeHandler=this.revRank,this.http.httpMethod=egret.HttpMethod.POST;var t=window.httpUrl+"gamerank",i="_csrf="+GameConst.csrf;this.http.send(t,i,this)}},s.revRank=function(e){egret.log("revRank:",e);var t=JSON.parse(e),i=t.status,s=t.code,n=t.msg,r=t.data;if(1==i&&200==s){this.rankGroup.visible=!1;var a=GameManager.getInstance().rankPanel;LayerManager.getInstance().popLayer.addChild(a),a.setView(r)}else this.rankGroup.visible=!0,alert(n)},s.sendPrizeRequest=function(){if(egret.log("sendPrize"),GameConst.debug){var e={status:!0,code:200,msg:"",data:{weekRank:[{teamName:"ABCD",teamScore:123},{teamName:"BCDE",teamScore:321},{teamName:"BCDE",teamScore:321},{teamName:"BCDE",teamScore:321},{teamName:"BCDE",teamScore:321},{teamName:"BCDE",teamScore:321},{teamName:"ECDE",teamScore:321}],rankWin:[{teamName:"EEEE",teamScore:111},{teamName:"BBBB",teamScore:222},{teamName:"BBBB",teamScore:222},{teamName:"CBBB",teamScore:222},{teamName:"ABBB",teamScore:222}]}};this.revPrize(JSON.stringify(e))}else{this.http.completeHandler=this.revPrize,this.http.httpMethod=egret.HttpMethod.POST;var t=window.httpUrl+"winners",i="_csrf="+GameConst.csrf;this.http.send(t,i,this)}},s.revPrize=function(e){egret.log("revPrize:",e);var t=JSON.parse(e),i=t.status,s=t.code,n=t.msg,r=t.data;if(1==i&&200==s){var a=GameManager.getInstance().prizePanel;LayerManager.getInstance().clearPopLayer(),LayerManager.getInstance().popLayer.addChild(a),a.setView(r)}else alert(n)},t}(BaseScene);egret.registerClass(HomeScene,"HomeScene");var MyTeamPanel=function(e){function t(){e.call(this,"MyTeamPanelSkin"),this.memberHeadList=new Array,this.memberNameList=new Array,this.memberScoreList=new Array,this.memberNum=6,this.imageLoaderList=new Array,this.percentWidth=100,this.percentHeight=100}__extends(t,e);var i=(__define,t),s=i.prototype;return s.componentCreated=function(){e.prototype.componentCreated.call(this);for(var t=0;t<this.memberNum;t++)this.memberHeadList.push(this["memberHead"+t]),this.memberNameList.push(this["memberName"+t]),this.memberScoreList.push(this["memberScore"+t]),this.imageLoaderList.push(new CImageLoader)},s.onEnable=function(){this.closeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onCloseTouch,this)},s.onRemove=function(){this.closeBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onCloseTouch,this)},s.onCloseTouch=function(){this.hide(),LayerManager.getInstance().popLayer.addChild(GameManager.getInstance().rankPanel)},s.setView=function(e){this.teamLabel0.text="",this.teamLabel1.text="";for(var t=0;t<this.memberNum;t++)this.memberHeadList[t].numChildren>0&&this.memberHeadList[t].removeChildAt(0),this.memberNameList[t].text="",this.memberScoreList[t].text="",this.imageLoaderList[t].clear();for(var i=e.length,t=0;i>t;t++){var s=e[t];this["teamLabel"+t].text=s.teamName;for(var n=s.member,r=0;r<n.length;r++){var a=r+3*t;this.memberNameList[a].text=n[r].nickName,this.memberScoreList[a].text=n[r].score;var o=this.imageLoaderList[a];o.doc=this.memberHeadList[a],o.load(n[r].headImg)}}},t}(BaseUI);egret.registerClass(MyTeamPanel,"MyTeamPanel");var PrizePanel=function(e){function t(){e.call(this,"PrizePanelSkin"),this.weekLabelList=new Array,this.weekNum=6,this.percentWidth=100,this.percentHeight=100}__extends(t,e);var i=(__define,t),s=i.prototype;return s.componentCreated=function(){e.prototype.componentCreated.call(this);for(var t=0;t<this.weekNum;t++)this.weekLabelList.push(this["weekLabel"+t])},s.onEnable=function(){this.closeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onCloseBtnTouch,this),this.leaderBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onLeaderBtnTouch,this)},s.onRemove=function(){this.closeBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onCloseBtnTouch,this),this.leaderBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onLeaderBtnTouch,this)},s.onCloseBtnTouch=function(){this.hide(),GameConst.prizeLastView==GameManager.getInstance().homeScene?GameManager.getInstance().homeScene.rankGroup.visible=!0:LayerManager.getInstance().popLayer.addChild(GameManager.getInstance().rankPanel)},s.onLeaderBtnTouch=function(){this.hide(),LayerManager.getInstance().popLayer.addChild(GameManager.getInstance().teamForm)},s.setView=function(e){for(var t=0;t<this.weekNum;t++)this.weekLabelList[t].text="";this.fourLabel.text="";var i=e.weekRank,s=e.rankWin,n=i.length;n=n>6?6:n,n=n>this.weekNum?this.weekNum:n;for(var t=0;n>t;t++){var r=i[t].teamName;i[t].teamScore;this.weekLabelList[t].text="第"+(t+1)+"周最高奖："+r}n=s.length,n=n>4?4:n;for(var t=0;n>t;t++)this.fourLabel.text+=s[t].teamName+" "},t}(BaseUI);egret.registerClass(PrizePanel,"PrizePanel");var RankPanel=function(e){function t(){e.call(this,"RankPanelSkin"),this.rankGroupList=new Array,this.rankLabelList=new Array,this.nameLabelList=new Array,this.scoreLabelList=new Array,this.rankLimit=15,this.http=new HttpUtil,this.percentWidth=100,this.percentHeight=100}__extends(t,e);var i=(__define,t),s=i.prototype;return s.componentCreated=function(){e.prototype.componentCreated.call(this);for(var t=0;t<this.rankLimit;t++)this.rankGroupList.push(this["rankGroup"+t]),this.rankLabelList.push(this["rankLabel"+t]),this.nameLabelList.push(this["nameLabel"+t]),this.scoreLabelList.push(this["scoreLabel"+t])},s.onEnable=function(){this.closeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onCloseBtnTouch,this),this.myTeamBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.myTeamTouch,this),this.prizeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onPrizeTouch,this),this.isClickMyTeam=!1,this.sendMyTeamRequest()},s.onRemove=function(){this.closeBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onCloseBtnTouch,this),this.myTeamBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.myTeamTouch,this),this.prizeBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onPrizeTouch,this)},s.onCloseBtnTouch=function(){this.hide(),GameManager.getInstance().homeScene.rankGroup.visible=!0},s.myTeamTouch=function(){this.isClickMyTeam=!0,this.myTeamData?this.showMyTeam(this.myTeamData):this.sendMyTeamRequest()},s.onPrizeTouch=function(){GameConst.prizeLastView=this,GameManager.getInstance().homeScene.sendPrizeRequest()},s.setView=function(e){for(var t=0;t<this.rankLimit;t++)this.rankLabelList[t].text="",this.nameLabelList[t].text="",this.scoreLabelList[t].text="";this.myNameLabel0.text="",this.myNameLabel1.text="",this.myRankLabel0.text="",this.myRankLabel1.text="",this.myScoreLabel0.text="",this.myScoreLabel1.text="";var i=e.length;i=i>15?15:i;for(var t=0;i>t;t++){var s=e[t].teamName,n=e[t].teamScore;this.rankLabelList[t].text=t+1+"",this.nameLabelList[t].text=s+"",this.scoreLabelList[t].text=n+""}},s.sendMyTeamRequest=function(){if(egret.log("sendMyTeamRequest"),GameConst.debug){var e={status:!0,code:200,msg:"a",data:[{teamName:"A",totalScore:"1",member:[{headImg:"",nickName:"A",score:"1"},{headImg:"",nickName:"A",score:"1"},{headImg:"",nickName:"A",score:"1"}]},{teamName:"B",totalScore:"1",member:[{headImg:"",nickName:"A",score:"1"},{headImg:"",nickName:"A",score:"1"},{headImg:"",nickName:"A",score:"1"}]}]};this.revMyTeam(JSON.stringify(e))}else{this.myTeamData=null,this.http.completeHandler=this.revMyTeam,this.http.httpMethod=egret.HttpMethod.POST;var t=window.httpUrl+"teammembers",i="_csrf="+GameConst.csrf;this.http.send(t,i,this)}},s.revMyTeam=function(e){egret.log("revMyTeam:",e);var t=JSON.parse(e),i=t.status,s=t.code,n=t.msg,r=t.data;if(1==i&&200==s)if(this.myTeamData=r,this.isClickMyTeam)this.showMyTeam(r);else{var a;r[0]&&(a=r[0],this.myNameLabel0.text=a.teamName,this.myRankLabel0.text=a.rank,this.myScoreLabel0.text=a.totalScore),r[1]&&(a=r[1],this.myNameLabel1.text=a.teamName,this.myRankLabel1.text=a.rank,this.myScoreLabel1.text=a.totalScore)}else alert(n)},s.showMyTeam=function(e){this.hide();var t=GameManager.getInstance().myTeamPanel;LayerManager.getInstance().clearPopLayer(),LayerManager.getInstance().popLayer.addChild(t),t.setView(e)},t}(BaseUI);egret.registerClass(RankPanel,"RankPanel");var RulePanel=function(e){function t(){e.call(this,"RulePanelSkin"),this.percentWidth=100,this.percentHeight=100}__extends(t,e);var i=(__define,t),s=i.prototype;return s.componentCreated=function(){e.prototype.componentCreated.call(this),this.scroller.scrollPolicyV=eui.ScrollPolicy.AUTO,this.scroller.verticalScrollBar.autoVisibility=!1},s.onEnable=function(){this.playArrowAnim(),this.knowBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onKnowBtnTouch,this)},s.onRemove=function(){this.stopArrowAnim(),this.knowBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onKnowBtnTouch,this)},s.onKnowBtnTouch=function(){this.hide()},s.playArrowAnim=function(){this.initArrowY=this.arrow.y,egret.Tween.get(this.arrow,{loop:!0}).to({y:this.initArrowY-10},300).to({y:this.initArrowY},300)},s.stopArrowAnim=function(){egret.Tween.removeTweens(this.arrow),this.arrow.y=this.initArrowY},t}(BaseUI);
egret.registerClass(RulePanel,"RulePanel");var TeamForm=function(e){function t(){e.call(this,"TeamFormSkin"),this.http=new HttpUtil,this.percentWidth=100,this.percentHeight=100}__extends(t,e);var i=(__define,t),s=i.prototype;return s.componentCreated=function(){e.prototype.componentCreated.call(this)},s.onEnable=function(){this.nameLabel.text="",this.telLabel.text="",this.addressLabel.text="",this.submitBtn.visible=!1,this.submitBtn_Black.visible=!0,this.closeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onCloseBtnTouch,this),this.submitBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSubmitBtnTouch,this),this.addEventListener(egret.Event.ENTER_FRAME,this.onEnterFrame,this)},s.onRemove=function(){this.closeBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onCloseBtnTouch,this),this.submitBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onSubmitBtnTouch,this),this.removeEventListener(egret.Event.ENTER_FRAME,this.onEnterFrame,this)},s.onEnterFrame=function(){""==this.nameLabel.text||""==this.telLabel.text||""==this.addressLabel.text?(this.submitBtn_Black.visible=!0,this.submitBtn.visible=!1):(this.submitBtn.visible=!0,this.submitBtn_Black.visible=!1)},s.onCloseBtnTouch=function(){this.hide(),GameManager.getInstance().homeScene.rankGroup.visible=!0},s.onSubmitBtnTouch=function(){if(egret.log("sendSubmit"),GameConst.debug){var e={status:!0,code:200,msg:"abc"};this.revSubmit(JSON.stringify(e))}else{this.http.completeHandler=this.revSubmit,this.http.httpMethod=egret.HttpMethod.POST;var t=window.httpUrl+"saveinfo",i="_csrf="+GameConst.csrf,s="&tel="+this.telLabel.text,n="&name="+this.nameLabel.text,r="&addr="+this.addressLabel.text,a=i+s+n+r;this.http.send(t,a,this)}},s.revSubmit=function(e){egret.log("revSubmit:",e);var t=JSON.parse(e),i=t.status,s=t.code,n=t.msg;1==i&&200==s||alert(n),this.hide()},t}(BaseUI);egret.registerClass(TeamForm,"TeamForm");var PreloadScene=function(e){function t(){e.call(this,"PreloadSceneSkin")}__extends(t,e);var i=(__define,t),s=i.prototype;return s.componentCreated=function(){e.prototype.componentCreated.call(this),this.progressLabel.text="0%",this.loadBar.mask=this.barMask,this.barMask.scaleX=0,this.bee=new SimpleMC("bee_png","bee_json","bee"),this.bee.play(1e3),this.beeGroup.addChild(this.bee)},s.setProgress=function(e){this.inited&&(this.progressLabel.text=e.toString()+"%",this.barMask.scaleX=e/100,this.beeGroup.x=this.loadBg.x+this.loadBg.width*e/100-this.beeGroup.width/2)},s.destroy=function(){this.bee.parent&&this.bee.parent.removeChild(this.bee),this.bee.stop(),this.bee=null},t}(BaseScene);egret.registerClass(PreloadScene,"PreloadScene");var LuckForm=function(e){function t(){e.call(this,"LuckFormSkin"),this.http=new HttpUtil,this.percentWidth=100,this.percentHeight=100}__extends(t,e);var i=(__define,t),s=i.prototype;return s.componentCreated=function(){e.prototype.componentCreated.call(this)},s.onEnable=function(){this.reset(),this.configListeners()},s.onRemove=function(){this.deConfigListeners()},s.reset=function(){this.nameLabel.text="",this.telLabel.text="",this.addressLabel.text="",this.submitBtn.visible=!1,this.submitBtn_Black.visible=!0},s.configListeners=function(){this.addEventListener(egret.Event.ENTER_FRAME,this.onEnterFrame,this),this.submitBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSubmitTouch,this),this.closeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onCloseTouch,this)},s.deConfigListeners=function(){this.removeEventListener(egret.Event.ENTER_FRAME,this.onEnterFrame,this),this.submitBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onSubmitTouch,this),this.closeBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onCloseTouch,this)},s.onEnterFrame=function(){""==this.nameLabel.text||""==this.telLabel.text||""==this.addressLabel.text?(this.submitBtn.visible=!1,this.submitBtn_Black.visible=!0):(this.submitBtn.visible=!0,this.submitBtn_Black.visible=!1)},s.onSubmitTouch=function(){this.sendSubmitRequest()},s.onCloseTouch=function(){this.hide(),GameManager.getInstance().resultScene.btnGroup.visible=!0},s.setView=function(e){this.prizeLabel.text="恭喜你获得"+e},s.sendSubmitRequest=function(){if(egret.log("sendSubmit"),GameConst.debug){var e={status:!0,code:200,msg:"aa"};this.revSubmit(JSON.stringify(e))}else{this.http.completeHandler=this.revSubmit,this.http.httpMethod=egret.HttpMethod.POST;var t=window.httpUrl+"prizeinfo",i="_csrf="+GameConst.csrf,s="&tel="+this.telLabel.text,n="&name="+this.nameLabel.text,r="&addr="+this.addressLabel.text,a=i+s+n+r;this.http.send(t,a,this)}egret.log(t)},s.revSubmit=function(e){egret.log("revSubmit:",e);var t=JSON.parse(e),i=t.status,s=t.code,n=t.msg;t.data;1==i&&200==s||alert(n),this.hide(),GameManager.getInstance().resultScene.btnGroup.visible=!0},t}(BaseUI);egret.registerClass(LuckForm,"LuckForm");var PrizeGrid=function(e){function t(){e.call(this),this.skinName="PrizeGridSkin"}__extends(t,e);var i=(__define,t),s=i.prototype;return s.hideAll=function(){this.back.visible=!1,this.resultBg.visible=!1,this.light.visible=!1,this.thx.visible=!1,this.luck.visible=!1,this.bigLuck.visible=!1},s.showLight=function(){this.light.visible=!0},s.showBack=function(){this.hideAll(),this.back.visible=!0},s.showThx=function(){this.hideAll(),this.resultBg.visible=!0,this.thx.visible=!0},s.showLuck=function(){this.hideAll(),this.resultBg.visible=!0,this.luck.visible=!0},s.showBigLuck=function(){this.hideAll(),this.resultBg.visible=!0,this.bigLuck.visible=!0},t}(eui.Component);egret.registerClass(PrizeGrid,"PrizeGrid");var ResultScene=function(e){function t(){e.call(this,"ResultSceneSkin"),this.gridList=new Array,this.gridNum=8,this.timer=new egret.Timer(200),this.http=new HttpUtil}__extends(t,e);var i=(__define,t),s=i.prototype;return s.componentCreated=function(){e.prototype.componentCreated.call(this);for(var t=0;t<this.gridNum;t++)this.gridList.push(this["grid"+t])},s.onEnable=function(){this.scoreGroup.visible=!0,this.btnGroup.visible=!1,this.luckGroup.visible=!1,this.configListeners(),this.reset();var e=GameConst.stage.stageWidth,t=this.btnMidGroup.width;e>=t?this.btnMidGroup.x=(e-t)/2:this.btnMidGroup.x=e-t},s.onRemove=function(){this.deConfigListeners()},s.configListeners=function(){this.teamBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTeamBtnTouch,this),this.againBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onAgainBtnTouch,this),this.rankBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onRankBtnTouch,this),this.luckBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onLuckBtnTouch,this)},s.deConfigListeners=function(){this.teamBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTeamBtnTouch,this),this.againBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onAgainBtnTouch,this),this.rankBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onRankBtnTouch,this),this.luckBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onLuckBtnTouch,this)},s.onTeamBtnTouch=function(){this.addChild(GameManager.getInstance().sharePanel)},s.onAgainBtnTouch=function(){LayerManager.getInstance().runScene(GameManager.getInstance().homeScene)},s.onRankBtnTouch=function(){GameManager.getInstance().homeScene.sendRankRequest()},s.onLuckBtnTouch=function(){this.luckBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onLuckBtnTouch,this),this.sendLuckRequest()},s.setSceneValue=function(e,t,i){this.setScoreLabel(t),this.setGrasslabel(i);var s=egret.localStorage.getItem("lkl_luckTime");GameConst.debug&&(s="false"),"true"==s?this.btnGroup.visible=!0:this.luckGroup.visible=!0},s.setTimeLabel=function(e){},s.setScoreLabel=function(e){this.scoreLabel.text=e+"",this.totalScoreLabel.text=e+""},s.setGrasslabel=function(e){this.grassLabel.text=e+""},s.reset=function(){for(var e=this.gridList.length,t=0;e>t;t++){var i=this.gridList[t];i.showBack()}},s.sendLuckRequest=function(){if(egret.log("sendLuck"),GameConst.debug){var e={status:!0,code:200,msg:"aa",data:{prizeName:"幸运奖",prizeIndex:5,winMark:"Y"}};this.revLuck(JSON.stringify(e))}else{this.http.completeHandler=this.revLuck,this.http.httpMethod=egret.HttpMethod.POST;var t=window.httpUrl+"lottery",i="_csrf="+GameConst.csrf;this.http.send(t,i,this)}},s.revLuck=function(e){egret.log("revLuck:",e);var t=JSON.parse(e),i=t.status,s=t.code,n=t.msg,r=t.data;1==i&&200==s?(this.prizeName=r.prizeName,this.winMark=r.winMark,this.startPlayLuck(r)):(alert(n),this.luckGroup.visible=!1,this.btnGroup.visible=!0),egret.localStorage.setItem("lkl_luckTime","true")},s.startPlayLuck=function(e){this.timeLimit=this.gridNum+e.prizeIndex,this.timer.addEventListener(egret.TimerEvent.TIMER,this.onTimer,this),this.timer.reset(),this.timer.start(),this.gridList[0].showLight()},s.onTimer=function(){var e=this.timer.currentCount%this.gridNum;if(0==e?this.gridList[this.gridNum-1].showBack():this.gridList[e-1].showBack(),this.gridList[e].showLight(),this.timeLimit==this.timer.currentCount){this.timer.stop(),this.timer.removeEventListener(egret.TimerEvent.TIMER,this.onTimer,this),this.gridList[0].showLuck(),this.gridList[1].showThx(),this.gridList[2].showBigLuck(),this.gridList[3].showThx(),this.gridList[4].showLuck(),this.gridList[5].showThx(),this.gridList[6].showLuck(),this.gridList[7].showThx(),this.gridList[e].showLight();var t=this;egret.Tween.get(this).wait(3e3).call(function(){t.luckComplete()},this)}},s.luckComplete=function(){if("Y"==this.winMark){this.luckGroup.visible=!1;var e=GameManager.getInstance().luckForm;this.addChild(e),e.setView(this.prizeName)}else this.luckGroup.visible=!1,this.btnGroup.visible=!0},s.showCode=function(){this.code.showCode(),this.code.setPosition(this.codeGroup.x,this.codeGroup.y)},t}(BaseScene);egret.registerClass(ResultScene,"ResultScene");var SharePanel=function(e){function t(){e.call(this,"SharePanelSkin")}__extends(t,e);var i=(__define,t),s=i.prototype;return s.componentCreated=function(){e.prototype.componentCreated.call(this),this.percentWidth=100,this.percentHeight=100},s.onEnable=function(){0==GameConst.orientation?this.arrowGroup.scaleX=-1:this.arrowGroup.scaleX=1,this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouch,this)},s.onRemove=function(){this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouch,this)},s.onTouch=function(){this.hide()},t}(BaseUI);egret.registerClass(SharePanel,"SharePanel");var Main=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var i=(__define,t),s=i.prototype;return s.createChildren=function(){e.prototype.createChildren.call(this);var t=new AssetAdapter;this.stage.registerImplementation("eui.IAssetAdapter",t),this.stage.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/default.res.json","resource/")},s.onConfigComplete=function(e){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this);var t=new eui.Theme("resource/default.thm.json",this.stage);t.addEventListener(eui.UIEvent.COMPLETE,this.onThemeLoadComplete,this)},s.onThemeLoadComplete=function(){LoadManager.getInstance().loadGroup("preload",this,this.onPreloadComplete)},s.onPreloadComplete=function(e){this.preloadScene=new PreloadScene,this.addChild(this.preloadScene),LoadManager.getInstance().loadGroup("home",this,this.onGameComplete,this.onGameProgress)},s.onGameProgress=function(e){this.preloadScene.setProgress(Math.round(e.itemsLoaded/e.itemsTotal*100))},s.onGameComplete=function(){this.removeChild(this.preloadScene),this.preloadScene.destroy(),this.preloadScene=null,LoadManager.getInstance().loadGroup("panel",this),LoadManager.getInstance().loadGroup("result",this),LoadManager.getInstance().loadGroup("luck",this),LoadManager.getInstance().loadGroup("share",this),GameManager.getInstance().startup(this)},t}(eui.UILayer);egret.registerClass(Main,"Main");var ThemeAdapter=function(){function e(){}var t=(__define,e),i=t.prototype;return i.getTheme=function(e,t,i,s){function n(e){t.call(s,e)}function r(t){t.resItem.url==e&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,r,null),i.call(s))}RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,r,null),RES.getResByUrl(e,n,this,RES.ResourceItem.TYPE_TEXT)},e}();egret.registerClass(ThemeAdapter,"ThemeAdapter",["eui.IThemeAdapter"]);