var AssetAdapter=function(){function e(){}var t=(__define,e),i=t.prototype;return i.getAsset=function(e,t,i){function s(s){t.call(i,s,e)}if(RES.hasRes(e)){var n=RES.getRes(e);n?s(n):RES.getResAsync(e,s,this)}else RES.getResByUrl(e,s,this,RES.ResourceItem.TYPE_IMAGE)},e}();egret.registerClass(AssetAdapter,"AssetAdapter",["eui.IAssetAdapter"]);var place={chongqing_png:"重庆",hunan_png:"湖南",anhui_png:"安徽",jiangsu_png:"江苏",sichuang_png:"四川",yunnan_png:" 云南",ningxia_png:"宁夏",neimenggu_png:"内蒙古",xinjiang_png:"新疆",changde_png:"常德",hefei_png:"合肥",changzhou_png:"常州",yancheng_png:"盐城",chendu_png:"成都",deyang_png:"德阳",neijiang_png:"内江",nanchong_png:"南充",yibin_png:"宜宾",xichang_png:"西昌",panzhihua_png:"攀枝花",kunming_png:"昆明",yuxi_png:"玉溪",honghe_png:"红河",simao_png:"思茅",lincang_png:"临沧",xishuangbanna_png:"西双版纳",baoshan_png:"宝山",ruili_png:"瑞丽",shizuishan_png:"石嘴山",yinchuang_png:"银川",wuzhong_png:"吴忠",guyuan_png:"固原",qingyang_png:"庆阳",zhongwei_png:"中卫",wulvmuqi_png:"乌鲁木齐",kuerle_png:"库尔勒",kuitun_png:"奎屯",akesu_png:"阿克苏",changji_png:"昌吉",hami_png:"哈密",wuhai_png:"乌海"},Games=function(e){function t(){e.call(this),this.provinces=[],this.citys=[],this.arr=[],this.Cq_arr=[],this.Hn_arr=[],this.Ah_arr=[],this.Js_arr=[],this.Sc_arr=[],this.Yn_arr=[],this.Nx_arr=[],this.Nm_arr=[],this.Xj_arr=[],this.isShow=!1,this.cityShow=!1,this.province_text=new eui.Label,this.city_text=new eui.Label,this.xPos=0,this.yPos=0,this.zPos=0,this.last_x=0,this.last_y=0,this.last_z=0,this.last_update=0,this.SHAKE_THRESHOLD=.25,this.shakeCount=0,this.skinName="resource/games/games.exml",this.percentWidth=100,this.percentHeight=100}__extends(t,e);var i=(__define,t),s=i.prototype;return s.childrenCreated=function(){this.huanghu=RES.getRes("huanghu_mp3"),this.beng=RES.getRes("beng_mp3"),this.init(),this.provicefun(),this.shakeSound=RES.getRes("shake_mp3")},s.init=function(){this.province=new eui.Image,this.province.source="list0_png",this.province.x=36,this.province.y=550,this.addChildAt(this.province,99),this.province_icon=new eui.Image,this.province_icon.source="shengfen_png",this.province_icon.x=158,this.province_icon.y=575,this.province_icon.touchEnabled=!1,this.addChildAt(this.province_icon,100),this.city=new eui.Image,this.city.source="list1_png",this.city.x=330,this.city.y=510,this.addChildAt(this.city,99),this.city_icon=new eui.Image,this.city_icon.source="chengshi_png",this.city_icon.x=411,this.city_icon.y=545,this.city_icon.touchEnabled=!1,this.addChildAt(this.city_icon,100),this.gobtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.gobtnfun,this),this.province.addEventListener(egret.TouchEvent.TOUCH_TAP,this.provincefun,this)},s.provincefun=function(){this.isShow?(egret.Tween.get(this.sheng_s).to({y:-130},300),this.isShow=!1):(egret.Tween.get(this.sheng_s).to({y:630},300),this.isShow=!0,this.city.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.cityfun,this),1==this.cityShow&&egret.Tween.get(this.cityScroller).to({y:-130},300),this.city_icon.source="chengshi_png",this.cityShow=!1)},s.provicefun=function(){this.arr=["chongqing_png","hunan_png","anhui_png","jiangsu_png","sichuang_png","yunnan_png","ningxia_png","neimenggu_png","xinjiang_png"],this.Cq_arr=["chongqing_png"],this.Hn_arr=["changde_png"],this.Ah_arr=["hefei_png"],this.Js_arr=["changzhou_png","yancheng_png"],this.Sc_arr=["chendu_png","deyang_png","neijiang_png","nanchong_png","yibin_png","xichang_png","panzhihua_png"],this.Yn_arr=["kunming_png","yuxi_png","honghe_png","simao_png","lincang_png","xishuangbanna_png","baoshan_png","ruili_png"],this.Nx_arr=["shizuishan_png","yinchuang_png","wuzhong_png","guyuan_png","qingyang_png","zhongwei_png"],this.Nm_arr=["wuhai_png"],this.Xj_arr=["wulvmuqi_png","kuerle_png","kuitun_png","akesu_png","changji_png","hami_png"],this.provinces=[];for(var e=0;9>e;e++)this.provinces.push({label:this.arr[e]});var t='\n        <e:Skin xmlns:e="http://ns.egret.com/eui"> \n            <e:Image source="{data.label}" y="20" x="120" horizontalCenter="0"></e:Image> \n        </e:Skin>',i=new eui.List;i.width=160,i.height=56,i.dataProvider=new eui.ArrayCollection(this.provinces),i.itemRendererSkinName=t,this.list_s=i;var s=new eui.Scroller;s.height=400,s.x=30,s.y=-130,this.sheng_s=s,this.addChildAt(this.sheng_s,5);var n=new eui.Image;n.source="tiao_bg_png",n.width=280,n.y=-30,n.x=30,n.height=450,s.viewport=i,s.addChildAt(n,0);var h=new egret.Shape;h.graphics.beginFill(16777215),h.graphics.drawRect(0,625,294,520),h.graphics.endFill(),h.touchEnabled=!1,this.addChild(h),this.sheng_s.mask=h,i.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onChange,this)},s.onChange=function(e){this.province_icon.source=this.arr[this.list_s.selectedIndex],this.province_text.text=place[this.arr[this.list_s.selectedIndex]],this.city.addEventListener(egret.TouchEvent.TOUCH_TAP,this.cityfun,this),this.cityScrollefun(this.list_s.selectedIndex),egret.Tween.get(this.sheng_s).to({y:0},300),this.isShow=!1,this.index=this.list_s.selectedIndex},s.cityfun=function(){this.cityShow?(egret.Tween.get(this.cityScroller).to({y:-130},300),this.cityShow=!1):(egret.Tween.get(this.cityScroller).to({y:610},300),this.cityShow=!0)},s.cityScrollefun=function(e){this.citys=[];var t=new eui.Scroller;switch(t.height=400,t.x=300,t.y=-130,this.cityScroller=t,this.addChildAt(this.cityScroller,5),e){case 0:for(var i=0;i<this.Cq_arr.length;i++)this.citys.push({label:this.Cq_arr[i]});break;case 1:for(var i=0;i<this.Hn_arr.length;i++)this.citys.push({label:this.Hn_arr[i]});break;case 2:for(var i=0;i<this.Ah_arr.length;i++)this.citys.push({label:this.Ah_arr[i]});break;case 3:for(var i=0;i<this.Js_arr.length;i++)this.citys.push({label:this.Js_arr[i]});break;case 4:for(var i=0;i<this.Sc_arr.length;i++)this.citys.push({label:this.Sc_arr[i]});break;case 5:for(var i=0;i<this.Yn_arr.length;i++)this.citys.push({label:this.Yn_arr[i]});break;case 6:for(var i=0;i<this.Nx_arr.length;i++)this.citys.push({label:this.Nx_arr[i]});break;case 7:for(var i=0;i<this.Nm_arr.length;i++)this.citys.push({label:this.Nm_arr[i]});break;case 8:for(var i=0;i<this.Xj_arr.length;i++)this.citys.push({label:this.Xj_arr[i]})}var s='\n        <e:Skin xmlns:e="http://ns.egret.com/eui"> \n            <e:Image source="{data.label}" y="20" x="120" horizontalCenter="0"></e:Image> \n        </e:Skin>',n=new eui.List;n.width=160,n.height=56,n.dataProvider=new eui.ArrayCollection(this.citys),n.itemRendererSkinName=s,this.cityList=n;var h=new eui.Image;h.source="tiao_bg_png",h.width=260,h.y=-30,h.x=30,h.height=450,t.viewport=n,t.addChildAt(h,0);var r=new egret.Shape;r.graphics.beginFill(16777215),r.graphics.drawRect(330,560,294,490),r.graphics.endFill(),r.touchEnabled=!1,this.addChild(r),this.cityScroller.mask=r,n.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onChangeS,this)},s.onChangeS=function(){switch(egret.Tween.get(this.cityScroller).to({y:-130},300),this.index){case 0:this.city_icon.source=this.Cq_arr[this.cityList.selectedIndex],this.city_text.text=place[this.Cq_arr[this.cityList.selectedIndex]];break;case 1:this.city_icon.source=this.Hn_arr[this.cityList.selectedIndex],this.city_text.text=place[this.Hn_arr[this.cityList.selectedIndex]];break;case 2:this.city_icon.source=this.Ah_arr[this.cityList.selectedIndex],this.city_text.text=place[this.Ah_arr[this.cityList.selectedIndex]];break;case 3:this.city_icon.source=this.Js_arr[this.cityList.selectedIndex],this.city_text.text=place[this.Js_arr[this.cityList.selectedIndex]];break;case 4:this.city_icon.source=this.Sc_arr[this.cityList.selectedIndex],this.city_text.text=place[this.Sc_arr[this.cityList.selectedIndex]];break;case 5:this.city_icon.source=this.Yn_arr[this.cityList.selectedIndex],this.city_text.text=place[this.Yn_arr[this.cityList.selectedIndex]];break;case 6:this.city_icon.source=this.Nx_arr[this.cityList.selectedIndex],this.city_text.text=place[this.Nx_arr[this.cityList.selectedIndex]];break;case 7:this.city_icon.source=this.Nm_arr[this.cityList.selectedIndex],this.city_text.text=place[this.Nm_arr[this.cityList.selectedIndex]];break;case 8:this.city_icon.source=this.Xj_arr[this.cityList.selectedIndex],this.city_text.text=place[this.Xj_arr[this.cityList.selectedIndex]]}},s.gongxifun=function(e){this.games_group.visible=!1,this.gongxi_group.visible=!0,this.goshare.addEventListener(egret.TouchEvent.TOUCH_TAP,this.sharefun,this);var t=document.getElementById("ewm"),i=document.createElement("img");i.src="resource/assets/code.jpg",i.style.width="100%",t.appendChild(i),document.getElementById("texts").style.display="block",document.getElementById("texts").innerHTML=e},s.overfun=function(){Math.random()>.5?this.over_group.visible=!0:this.over_group1.visible=!0,this.games_group.visible=!1,this.sharebtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.sharefun,this),this.sharebtn1.addEventListener(egret.TouchEvent.TOUCH_TAP,this.sharefun,this)},s.sharefun=function(){window.shareclick(),document.getElementById("share").style.display="block";var e=this;document.getElementById("share").onclick=function(){e.closeshare()}},s.closeshare=function(){document.getElementById("share").style.display="none"},s.gamefun=function(){},s.leftbtnfun=function(){egret.Tween.get(this.l_cap).to({y:-1e3},100),this.beng.play(0,1),this.clickfun()},s.minbtnfun=function(){egret.Tween.get(this.m_cap).to({y:-1e3},100),this.beng.play(0,1),this.clickfun()},s.rightbtnfun=function(){egret.Tween.get(this.r_cap).to({y:-1e3},100),this.beng.play(0,1),this.clickfun()},s.clickfun=function(){window.removeclick();var e=window.apiUrl+"/lottery",t=new egret.URLLoader;t.dataFormat=egret.URLLoaderDataFormat.TEXT,t.addEventListener(egret.Event.COMPLETE,this.onPostComplete,this);var i=new egret.URLRequest(e);i.method=egret.URLRequestMethod.POST;var s="?_csrf="+window._csrf+"&timeStr="+window.timeStr+"&tokenStr="+window.tokenStr+"&signStr="+window.signStr+"&province="+this.province_text.text+"&city="+this.city_text.text;i.data=new egret.URLVariables(s),t.load(i)},s.onPostComplete=function(e){var t=JSON.parse(e.target.data);console.log("抽奖结果：",t),200==t.pcode&&window.chanyuclick(),1==t.status?200==t.code&&(1==t.data.isWin?(this.gongxifun(t.data.prize),this.huanghu.play(0,1)):this.overfun()):(404==t.code&&alert(t.msg),(403==t.code||500==t.code)&&alert(t.msg))},s.gobtnfun=function(){var e=this;return"shengfen_png"==this.province_icon.source?void alert("请选择省份"):"chengshi_png"==this.city_icon.source?void alert("请选择城市"):(window.chouclick(),this.sheng_s.visible=!1,this.province.visible=!1,this.city.visible=!1,this.city_icon.visible=!1,this.province_icon.visible=!1,this.begin_group.visible=!1,this.games_group.visible=!0,this.startShake(),void this.shakePanel.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.shakePanel.parent&&e.shakePanel.parent.removeChild(e.shakePanel)},this))},s.startShake=function(){egret.log("start shake beta1.0"),this.orientation=new egret.DeviceOrientation,this.orientation.addEventListener(egret.Event.CHANGE,this.onOrientation,this),this.orientation.start()},s.stopShake=function(){var e=this;this.orientation&&(this.orientation.removeEventListener(egret.Event.CHANGE,this.onOrientation,this),this.orientation.stop()),egret.Tween.get(this.beer).wait(1e3).call(function(){egret.Tween.removeTweens(e.beer)})},s.onOrientation=function(e){var t=egret.getTimer();if(t-this.last_update>100){var i=t-this.last_update;this.last_update=t,this.xPos=e.beta,this.yPos=e.gamma,this.zPos=e.alpha;var s=Math.abs(this.xPos+this.yPos+this.zPos-this.last_x-this.last_y-this.last_z)/i;if(s>this.SHAKE_THRESHOLD)if(this.shakeCount++,egret.log("摇动次数:",this.shakeCount),1==this.shakeCount)egret.Tween.get(this.beer,{loop:!0}).to({rotation:5},100).to({rotation:-5},100),this.shakeChannel=this.shakeSound.play();else if(2==this.shakeCount)this.shakePanel.parent&&this.shakePanel.parent.removeChild(this.shakePanel);else if(this.shakeCount>4)return this.shakeCount=0,this.stopShake(),this.clickfun(),void(this.shakeChannel&&this.shakeChannel.stop());this.last_x=this.xPos,this.last_y=this.yPos,this.last_z=this.zPos}},t}(eui.Component);egret.registerClass(Games,"Games");var LoadingUI=function(e){function t(){e.call(this),this.percentWidth=100,this.percentHeight=100,this.skinName="resource/games/loading.exml"}__extends(t,e);var i=(__define,t),s=i.prototype;return s.childrenCreated=function(){},s.setProgress=function(e,t){this.loading_text.text="Loading..."+Math.floor(100*e/t)+"%"},t}(eui.Component);egret.registerClass(LoadingUI,"LoadingUI");var Main=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var i=(__define,t),s=i.prototype;return s.createChildren=function(){e.prototype.createChildren.call(this);var i=new AssetAdapter;this.stage.registerImplementation("eui.IAssetAdapter",i),this.stage.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),t.H=this.stage.stageHeight,t.W=this.stage.stageWidth,this.loadingView=new LoadingUI,RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/default.res.json","resource/")},s.onConfigComplete=function(e){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this);var t=new eui.Theme("resource/default.thm.json",this.stage);t.addEventListener(eui.UIEvent.COMPLETE,this.onThemeLoadComplete,this)},s.onThemeLoadComplete=function(){RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),RES.loadGroup("loading")},s.onResourceLoadComplete=function(e){"loading"==e.groupName?(this.addChild(this.loadingView),RES.loadGroup("preload")):"preload"==e.groupName&&(RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),this.createScene())},s.createScene=function(){this.removeChild(this.loadingView),this.startCreateScene()},s.onItemLoadError=function(e){console.warn("Url:"+e.resItem.url+" has failed to load")},s.onResourceLoadError=function(e){console.warn("Group:"+e.groupName+" has failed to load"),this.onResourceLoadComplete(e)},s.onResourceProgress=function(e){"loading"!==e.groupName&&this.loadingView.setProgress(e.itemsLoaded,e.itemsTotal)},s.startCreateScene=function(){this.addChild(new Games)},t}(eui.UILayer);egret.registerClass(Main,"Main");var ThemeAdapter=function(){function e(){}var t=(__define,e),i=t.prototype;return i.getTheme=function(e,t,i,s){function n(e){t.call(s,e)}function h(t){t.resItem.url==e&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,h,null),i.call(s))}RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,h,null),RES.getResByUrl(e,n,this,RES.ResourceItem.TYPE_TEXT)},e}();egret.registerClass(ThemeAdapter,"ThemeAdapter",["eui.IThemeAdapter"]);