var egret;!function(t){var e=["source-over","lighter","destination-out"],i="source-over",s=function(s){function r(){s.call(this),this.$displayListMap={}}__extends(r,s);var h=(__define,r);return p=h.prototype,p.drawToTexture=function(e,i,s){if(void 0===s&&(s=1),i&&(0==i.width||0==i.height))return!1;this.dispose();var r=i||e.$getOriginalBounds();if(0==r.width||0==r.height)return!1;s/=t.$TextureScaleFactor;var h=r.width*s,n=r.height*s;if(this.context=this.createRenderContext(h,n),!this.context)return!1;this.$update(e);var a=new t.DisplayObjectContainer;if(a.$children.push(e),a.scaleX=a.scaleY=s,i){var o=new t.Rectangle;o.setTo(i.x,i.y,i.width,i.height),a.scrollRect=o}var c=new t.DisplayObjectContainer;this.rootDisplayList=t.sys.DisplayList.create(c),c.$displayList=this.rootDisplayList,c.addChild(a);var l=e.$renderMatrix,d=l.a,g=l.b,p=l.c,u=l.d,m=l.tx,x=l.ty;l.identity(),i&&l.translate(-i.x,-i.y),c.$displayList=null,this.context.clearRect(0,0,h,n);this.drawDisplayObject(c,this.context,null);return l.setTo(d,g,p,u,m,x),this._setBitmapData(this.context.surface),this.$initData(0,0,h,n,0,0,h,n,h,n),this.$reset(e),this.$displayListMap={},!0},p.$update=function(e){if(this.$displayListMap[e.$hashCode]=e.$parentDisplayList,e.$renderRegion&&(e.$renderRegion.moved=!0,e.$update()),e instanceof t.DisplayObjectContainer)for(var i=e.$children,s=i.length,r=0;s>r;r++){var h=i[r];this.$update(h)}},p.$reset=function(e){if(e.$parentDisplayList=this.$displayListMap[e.$hashCode],e.$removeFlags(768),e instanceof t.DisplayObjectContainer)for(var i=e.$children,s=i.length,r=0;s>r;r++){var h=i[r];this.$reset(h)}},p.drawDisplayObject=function(t,e,i){var s,r,h=0;if(t.$renderRegion&&(s=t,r=t.$renderAlpha),s){h++,e.globalAlpha=r;var n=s.$renderMatrix;i?(e.transform(n.a,n.b,n.c,n.d,n.tx,n.ty),s.$render(e),e.setTransform(i.a,i.b,i.c,i.d,i.tx,i.ty)):(e.setTransform(n.a,n.b,n.c,n.d,n.tx,n.ty),s.$render(e))}var a=t.$children;if(a)for(var o=a.length,c=0;o>c;c++){var l=a[c];!l.$visible||l.$alpha<=0||l.$maskedObject||(h+=0!==l.$blendMode||l.$mask?this.drawWithClip(l,e,i):l.$scrollRect||l.$maskRect?this.drawWithScrollRect(l,e,i):this.drawDisplayObject(l,e,i))}return h},p.drawWithClip=function(s,r,h){var n=0,a=0!==s.$blendMode;if(a){var o=e[s.$blendMode];o||(o=i)}var c,l=s.$scrollRect,d=s.$mask,g=s.$getConcatenatedMatrix();if(d){var p=d.$getOriginalBounds();c=t.sys.Region.create(),c.updateRegion(p,d.$getConcatenatedMatrix())}var u;if(l&&(u=t.sys.Region.create(),u.updateRegion(l,g)),u&&c?(u.intersect(c),t.sys.Region.release(c)):!u&&c&&(u=c),u){if(u.isEmpty())return t.sys.Region.release(u),n}else u=t.sys.Region.create(),p=s.$getOriginalBounds(),u.updateRegion(p,s.$getConcatenatedMatrix());var m=this.createRenderContext(u.width,u.height);if(!m)return n+=this.drawDisplayObject(s,r,h),t.sys.Region.release(u),n;if(l){var x=g;m.setTransform(x.a,x.b,x.c,x.d,x.tx-u.minX,x.ty-u.minY),m.beginPath(),m.rect(l.x,l.y,l.width,l.height),m.clip()}m.setTransform(1,0,0,1,-u.minX,-u.minY);var f=t.Matrix.create().setTo(1,0,0,1,-u.minX,-u.minY);if(n+=this.drawDisplayObject(s,m,f),t.Matrix.release(f),d){var T=this.createRenderContext(u.width,u.height);if(!T)return n+=this.drawDisplayObject(s,r,h),t.sys.surfaceFactory.release(m.surface),t.sys.Region.release(u),n;T.setTransform(1,0,0,1,-u.minX,-u.minY),f=t.Matrix.create().setTo(1,0,0,1,-u.minX,-u.minY);var v=this.drawDisplayObject(d,T,f);t.Matrix.release(f),v>0&&(n+=v,m.globalCompositeOperation="destination-in",m.setTransform(1,0,0,1,0,0),m.globalAlpha=1,m.drawImage(T.surface,0,0)),t.sys.surfaceFactory.release(T.surface)}return n>0&&(n++,a&&(r.globalCompositeOperation=o),r.setTransform(1,0,0,1,u.minX,u.minY),r.drawImage(m.surface,0,0),a&&(r.globalCompositeOperation=i)),t.sys.surfaceFactory.release(m.surface),t.sys.Region.release(u),n},p.drawWithScrollRect=function(e,i,s){var r=0,h=e.$scrollRect?e.$scrollRect:e.$maskRect;if(0==h.width||0==h.height)return r;var n=e.$getConcatenatedMatrix(),a=t.sys.Region.create();return h.isEmpty()||a.updateRegion(h,n),a.isEmpty()?(t.sys.Region.release(a),r):(i.save(),s?(i.setTransform(s.a,s.b,s.c,s.d,s.tx,s.ty),i.transform(n.a,n.b,n.c,n.d,n.tx,n.ty)):i.setTransform(n.a,n.b,n.c,n.d,n.tx,n.ty),i.beginPath(),i.rect(h.x,h.y,h.width,h.height),i.clip(),s&&i.setTransform(s.a,s.b,s.c,s.d,s.tx,s.ty),r+=this.drawDisplayObject(e,i,s),i.restore(),t.sys.Region.release(a),r)},p.createRenderContext=function(e,i){var s=t.sys.surfaceFactory.create(!0);return s?(s.width=Math.max(257,e),s.height=Math.max(257,i),s.renderContext):null},p.dispose=function(){s.prototype.dispose.call(this),this.rootDisplayList&&(t.sys.DisplayList.release(this.rootDisplayList),this.rootDisplayList=null),this.context&&t.sys.surfaceFactory.release(this.context.surface)},r}(t.Texture);t.MyRenderTexture=s,t.registerClass(s,"egret.MyRenderTexture")}(egret||(egret={}));var NumberTool=function(){function t(){}var e=(__define,t);return p=e.prototype,t.getRandomInt=function(t,e){return Math.round(Math.random()*(e-t))+t},t}();egret.registerClass(NumberTool,"NumberTool");var GameConst=function(){function t(){}var e=(__define,t);return p=e.prototype,t.cellWidth=80,t.pieceScore=10,t}();egret.registerClass(GameConst,"GameConst");var DiscountUI=function(t){function e(){t.call(this),this.zhe0=new egret.Bitmap(RES.getRes("zhe0_png")),this.addChild(this.zhe0),this.zhe1=new egret.Bitmap(RES.getRes("zhe1_png")),this.addChild(this.zhe1),this.displayText=new egret.TextField,this.displayText.width=this.zhe0.width,this.displayText.height=this.zhe0.height,this.displayText.size=18,this.displayText.textColor=0,this.displayText.textAlign=egret.HorizontalAlign.CENTER,this.displayText.verticalAlign=egret.VerticalAlign.MIDDLE,this.addChild(this.displayText)}__extends(e,t);var i=(__define,e);return p=i.prototype,p.setZhe=function(t){this.zhe0.visible=!t,this.zhe1.visible=t},p.setText=function(t){this.displayText.text=t},e}(egret.Sprite);egret.registerClass(DiscountUI,"DiscountUI");var GameScene=function(t){function e(){t.call(this),this.curLevel=0,this.rectList=[],this.pieceList=[],this.gameTimer=new egret.Timer(1e3),this.initConfig(),this.initView()}__extends(e,t);var i=(__define,e);return p=i.prototype,p.initConfig=function(){var t=RES.getRes("config_json");GameConst.scoreList=t.scoreList,GameConst.discountList=t.discountList,GameConst.scoreMax=t.scoreList[t.scoreList.length-1],GameConst.timeLimit=t.timeLimit,this.rectNumList=t.rectNumList},p.initView=function(){this.mStage=GameConst.stage,this.cellWidth=GameConst.cellWidth,this.halfCellWidth=this.cellWidth/2,this.picX=0,this.picY=Math.floor(this.mStage.stageHeight/4.2),this.gameBg=new egret.Bitmap(RES.getRes("gamebg_png")),this.addChild(this.gameBg),this.timerUI=new TimerUI,this.timerUI.x=(this.mStage.stageWidth-this.timerUI.width)/2,this.timerUI.y=this.mStage.stageHeight/50,this.addChild(this.timerUI),this.scoreBarUI=new ScoreBarUI,this.scoreBarUI.x=(this.mStage.stageWidth-this.scoreBarUI.scoreBg.width)/2,this.scoreBarUI.y=this.mStage.stageHeight/10,this.addChild(this.scoreBarUI),this.pieceContainer=new egret.DisplayObjectContainer,this.scrollView=new egret.ScrollView,this.scrollView.width=450,this.scrollView.height=100,this.scrollView.x=0,this.scrollView.y=this.mStage.stageHeight/1.18,this.scrollView.setContent(this.pieceContainer),this.scrollView.scrollBeginThreshold=1,this.scrollView.horizontalScrollPolicy="off",this.scrollView.verticalScrollPolicy="off",this.addChild(this.scrollView),this.startBtn=new egret.Bitmap(RES.getRes("start_png")),this.startBtn.x=(this.mStage.stageWidth-this.startBtn.width)/2,this.startBtn.y=(this.mStage.stageHeight-this.startBtn.height)/2,this.startBtn.touchEnabled=!0,this.addChild(this.startBtn),this.resultPanel=new ResultPanel,this.scrollView.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onScollViewTouch,this),this.startBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.startGame,this)},p.startGame=function(){this.startBtn.parent&&this.removeChild(this.startBtn),this.startTimer(),this.resetGame(),this.createPic(),this.createRect(),this.createPiece()},p.resetGame=function(){this.timeLimit=GameConst.timeLimit,this.score=0,this.resultPanel.hide(),this.timerUI.setTimeText(this.timeLimit),this.scoreBarUI.setScore(0),this.scoreBarUI.curDiscount=0;for(var t=this.rectList.length,e=0;t>e;e++){var i=this.rectList[e];i.parent&&i.parent.removeChild(i)}for(this.rectList.length=0,t=this.pieceList.length,e=0;t>e;e++){var s=this.pieceList[e];s.parent&&s.parent.removeChild(s)}this.pieceList.length=0,this.pic&&this.pic.parent&&this.pic.parent.removeChild(this.pic),this.pic=null},p.nextLevel=function(){this.curLevel++,this.startGame()},p.checkGameOver=function(){this.pieceContainer.numChildren<=0&&(this.curLevel>=this.rectNumList.length-1?this.gameOver():this.nextLevel())},p.gameOver=function(){this.stopTimer(),this.scrollView.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onScollViewTouch,this),this.showResult()},p.createPic=function(){this.pic=new egret.Bitmap(RES.getRes("pic"+this.curLevel+"_jpg")),this.pic.x=this.picX,this.pic.y=this.picY,this.addChild(this.pic)},p.createRect=function(){var t,e,i=this.rectNumList[this.curLevel],s=this.pic.width,r=this.pic.height;6>=i?(t=3,e=3):(t=4,e=4);for(var h,n,a,o,c,l,d=Math.floor(s/e),g=Math.floor(r/t),p=[],u=0;t>u;u++)for(var m=0;e>m;m++){if(u%2==0&&e-1>m)h=m*d+Math.floor(d/2),n=m*d+d-this.cellWidth+Math.floor(d/2);else{if(u%2==0)continue;h=m*d,n=m*d+d-this.cellWidth}a=u*g,o=u*g+g-this.cellWidth,c=NumberTool.getRandomInt(h,n),l=NumberTool.getRandomInt(a,o),p.push([c,l])}for(var u=i-1;u>=0;u--){var x;if(i-2>=u){var f=Math.floor(p.length/4);x=NumberTool.getRandomInt(f,2*f)}else x=NumberTool.getRandomInt(0,p.length-1);var T=p[x];p.splice(x,1);var v=new RectUI;v.ID=u,v.x=this.picX+T[0],v.y=this.picY+T[1],this.addChild(v),this.rectList.push(v)}},p.createPiece=function(){for(var t=this.rectList.length,e=0;t>e;e++){var i=this.rectList[e],s=new egret.Rectangle(i.x-this.picX,i.y-this.picY,this.cellWidth,this.cellWidth),r=new egret.MyRenderTexture;r.drawToTexture(this.pic,s,1);var h=new PieceUI(r);h.touchEnabled=!0,h.anchorOffsetX=this.halfCellWidth,h.anchorOffsetY=this.halfCellWidth,h.x=this.cellWidth*e+10*(e+1)+this.halfCellWidth,h.y=this.halfCellWidth,h.ID=i.ID,this.pieceContainer.addChild(h),this.pieceList.push(h)}},p.onScollViewTouch=function(t){console.log("tap:",t.target),t.target instanceof PieceUI&&(this.dragPiece=t.target,this.dragPieceX=t.target.x,this.dragPieceY=t.target.y,this.addChild(this.dragPiece),this.dragPiece.x=t.stageX,this.dragPiece.y=t.stageY,egret.Tween.get(this.dragPiece).to({rotation:36e3},5e5),this.stage.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.onTouchMove,this),this.stage.addEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEnd,this))},p.onTouchMove=function(t){this.dragPiece.x=t.stageX,this.dragPiece.y=t.stageY},p.onTouchEnd=function(){console.log("end"),this.stage.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.onTouchMove,this),this.stage.removeEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEnd,this),egret.Tween.removeTweens(this.dragPiece),this.dragPiece.rotation=0;for(var t=this.rectList.length,e=0;t>e;e++){var i=this.rectList[e];if(this.checkColloise(this.dragPiece,i)&&i.ID==this.dragPiece.ID)return egret.Tween.get(this.dragPiece).to({x:i.x+this.halfCellWidth,y:i.y+this.halfCellWidth},100),this.sortScrollView(),this.scoreBarUI.setScore(this.score+=GameConst.pieceScore),void this.checkGameOver()}var s=this,r=this.scrollView.x+this.dragPieceX,h=this.scrollView.y+this.dragPieceY;egret.Tween.get(this.dragPiece).to({x:r,y:h},100).call(function(){s.dragPiece.x=s.dragPieceX,s.dragPiece.y=s.dragPieceY,s.pieceContainer.addChild(s.dragPiece)})},p.checkColloise=function(t,e){return this.dragPiece.x>e.x-this.halfCellWidth&&this.dragPiece.x<e.x+this.cellWidth+this.halfCellWidth&&this.dragPiece.y>e.y-this.halfCellWidth&&this.dragPiece.y<e.y+this.cellWidth+this.halfCellWidth?!0:!1},p.sortScrollView=function(){for(var t=this.pieceList.length,e=0,i=0;t>i;i++){var s=this.pieceList[i];if(s.parent==this.pieceContainer){var r=this.cellWidth*e+10*(e+1)+this.halfCellWidth,h=this.halfCellWidth;egret.Tween.get(s).to({x:r,y:h},200),e++}}},p.startTimer=function(){this.gameTimer.addEventListener(egret.TimerEvent.TIMER,this.onTimerHandler,this),this.gameTimer.reset(),this.gameTimer.start()},p.onTimerHandler=function(){this.timeLimit--,this.timerUI.setTimeText(this.timeLimit),this.timeLimit<=0&&this.gameOver()},p.stopTimer=function(){this.gameTimer.removeEventListener(egret.TimerEvent.TIMER,this.onTimerHandler,this),this.gameTimer.stop()},p.showResult=function(){this.resultPanel.show();var t=this.scoreBarUI.curDiscount,e="";0>=t?e+="很遗憾，未获得折扣":(e+="获得:"+t+"折",e+="\n￥1000   -￥"+Math.round(1e3*(1-t/10))),e+="\n获得天天币:100",this.resultPanel.setText(e)},e}(egret.DisplayObjectContainer);egret.registerClass(GameScene,"GameScene");var LoadUI=function(t){function e(){t.call(this),this.loadText=new egret.TextField,this.loadText.textAlign=egret.HorizontalAlign.CENTER,this.loadText.width=100,this.loadText.textColor=0,this.addChild(this.loadText),this.x=GameConst.stage.stageWidth/2-this.loadText.width/2,this.y=GameConst.stage.stageHeight/2}__extends(e,t);var i=(__define,e);return p=i.prototype,p.setLoadText=function(t){this.loadText.text=t},e}(egret.DisplayObjectContainer);egret.registerClass(LoadUI,"LoadUI");var PieceUI=function(t){function e(e){t.call(this,e)}__extends(e,t);var i=(__define,e);return p=i.prototype,e}(egret.Bitmap);egret.registerClass(PieceUI,"PieceUI");var RectUI=function(t){function e(){t.call(this),this.graphics.beginFill(16777215),this.graphics.drawRect(0,0,GameConst.cellWidth,GameConst.cellWidth),this.graphics.endFill()}__extends(e,t);var i=(__define,e);return p=i.prototype,e}(egret.Sprite);egret.registerClass(RectUI,"RectUI");var ResultPanel=function(t){function e(){t.call(this),this.bg=new egret.Bitmap(RES.getRes("resultbg_png")),this.addChild(this.bg),this.fxBtn=new SimpleButton("resultbtn_png"),this.fxBtn.setText("分享立减"),this.fxBtn.setTextSize(20),this.fxBtn.x=30,this.fxBtn.y=180,this.addChild(this.fxBtn),this.buyBtn=new SimpleButton("resultbtn_png"),this.buyBtn.setText("立刻购买"),this.buyBtn.setTextSize(20),this.buyBtn.x=180,this.buyBtn.y=180,this.addChild(this.buyBtn),this.contentText=new egret.TextField,this.contentText.width=this.bg.width,this.contentText.height=this.bg.height-this.fxBtn.height,this.contentText.textAlign=egret.HorizontalAlign.CENTER,this.contentText.verticalAlign=egret.VerticalAlign.MIDDLE,this.contentText.text="",this.contentText.textColor=0,this.addChild(this.contentText)}__extends(e,t);var i=(__define,e);return p=i.prototype,p.show=function(){GameConst.stage.addChild(this),this.x=(GameConst.stage.stageWidth-this.bg.width)/2,this.y=(GameConst.stage.stageHeight-this.bg.height)/2,this.fxBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onFxBtnTouch,this),this.buyBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBuyBtnTouch,this)},p.onFxBtnTouch=function(){window.share()},p.onBuyBtnTouch=function(){window.toBuy()},p.setText=function(t){this.contentText.text=t},p.hide=function(){this.parent&&this.parent.removeChild(this)},e}(egret.Sprite);egret.registerClass(ResultPanel,"ResultPanel");var ScoreBarUI=function(t){function e(){t.call(this),this.discountUIList=[],this.curDiscount=0,this.scoreBg=new egret.Bitmap(RES.getRes("scorebg_png")),this.addChild(this.scoreBg),this.scoreBar=new egret.Bitmap(RES.getRes("scorebar_png")),this.scoreBar.x=this.scoreBg.x+1,this.scoreBar.y=this.scoreBg.y+1,this.addChild(this.scoreBar),this.scoreText=new egret.TextField,this.scoreText.width=70,this.scoreText.height=this.scoreBar.height,this.scoreText.textAlign=egret.HorizontalAlign.CENTER,this.scoreText.verticalAlign=egret.VerticalAlign.MIDDLE,this.scoreText.x=this.scoreBar.x,this.scoreText.y=this.scoreBar.y,this.addChild(this.scoreText);for(var e=GameConst.scoreList,i=GameConst.discountList,s=i.length,r=0;s>r;r++){var h=new DiscountUI;h.setText(i[r]+"折"),h.anchorOffsetX=h.width/2,h.x=this.scoreBg.x+e[r]/GameConst.scoreMax*this.scoreBar.width,h.y=this.scoreBg.y+this.scoreBg.height,h.setZhe(!1),this.addChild(h),this.discountUIList.push(h)}this.setScore(0)}__extends(e,t);var i=(__define,e);return p=i.prototype,p.setScore=function(t){this.scoreText.text=t.toString();var e=t/GameConst.scoreMax;e>1&&(e=1),this.scoreBar.scaleX=e;for(var i=GameConst.scoreList,s=i.length,r=-1,h=0;s>h;h++)t>=i[h]&&(r=h,this.curDiscount=GameConst.discountList[r]);if(-1!=r){for(h=0;s>h;h++)this.discountUIList[h].setZhe(!1);this.discountUIList[r].setZhe(!0)}},e}(egret.DisplayObjectContainer);egret.registerClass(ScoreBarUI,"ScoreBarUI");var SimpleButton=function(t){function e(e,i){void 0===i&&(i=null),t.call(this),this.up=new egret.Bitmap(RES.getRes(e)),this.addChild(this.up),null!=i&&(this.down=new egret.Bitmap(RES.getRes(i)),this.addChild(this.down),this.down.visible=!1),this.touchEnabled=!0,this.touchChildren=!1,this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.touchBegin,this)}__extends(e,t);var i=(__define,e);return p=i.prototype,p.touchBegin=function(){this.stage.addEventListener(egret.TouchEvent.TOUCH_END,this.touchEnd,this),this.onPress()},p.touchEnd=function(){this.stage.removeEventListener(egret.TouchEvent.TOUCH_END,this.touchEnd,this),this.onRelease()},p.onPress=function(){this.down&&(this.up.visible=!1,this.down&&(this.down.visible=!0))},p.onRelease=function(){this.down&&(this.up.visible=!0,this.down&&(this.down.visible=!1))},p.setText=function(t){null==this.displayText&&null!=this.up&&(this.displayText=new egret.TextField,this.displayText.width=this.up.width,this.displayText.height=this.up.height,this.displayText.textAlign=egret.HorizontalAlign.CENTER,this.displayText.verticalAlign=egret.VerticalAlign.MIDDLE,this.displayText.textColor=0,this.addChild(this.displayText)),this.displayText.text=t},p.setTextColor=function(t){this.displayText&&(this.displayText.textColor=t)},p.setTextSize=function(t){this.displayText&&(this.displayText.size=t)},e}(egret.Sprite);egret.registerClass(SimpleButton,"SimpleButton");var TimerUI=function(t){function e(){t.call(this),this.timeBg=new egret.Bitmap(RES.getRes("timebg_png")),this.addChild(this.timeBg),this.timeText=new egret.TextField,this.timeText.width=120,this.timeText.height=50,this.timeText.textAlign=egret.HorizontalAlign.CENTER,this.timeText.verticalAlign=egret.VerticalAlign.MIDDLE,this.timeText.x=this.timeBg.x+(this.timeBg.width-this.timeText.width)/2,this.timeText.y=this.timeBg.y+(this.timeBg.height-this.timeText.height)/2,this.addChild(this.timeText)}__extends(e,t);var i=(__define,e);return p=i.prototype,p.setTimeText=function(t){this.timeText.text="时间:"+t.toString()},e}(egret.DisplayObjectContainer);egret.registerClass(TimerUI,"TimerUI");var Main=function(t){function e(){t.call(this),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this)}__extends(e,t);var i=(__define,e);return p=i.prototype,p.onAddToStage=function(){GameConst.stage=this.stage,this.loadUI=new LoadUI,this.addChild(this.loadUI),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/default.res.json","resource/")},p.onConfigComplete=function(){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.loadGroup("preload")},p.onResourceLoadComplete=function(){RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),this.createGameScene()},p.onResourceProgress=function(t){this.loadUI.setLoadText(t.itemsLoaded+"/"+t.itemsTotal)},p.createGameScene=function(){this.removeChild(this.loadUI);var t=new GameScene;this.addChild(t)},e}(egret.DisplayObjectContainer);egret.registerClass(Main,"Main");