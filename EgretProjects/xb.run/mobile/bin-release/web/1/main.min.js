var AssetAdapter=function(){function e(){}var t=(__define,e),n=t.prototype;return n.getAsset=function(e,t,n){function i(i){t.call(n,i,e)}if(RES.hasRes(e)){var s=RES.getRes(e);s?i(s):RES.getResAsync(e,i,this)}else RES.getResByUrl(e,i,this,RES.ResourceItem.TYPE_IMAGE)},e}();egret.registerClass(AssetAdapter,"AssetAdapter",["eui.IAssetAdapter"]);var BaseScene=function(e){function t(t){e.call(this),this.inited=!1,this.percentWidth=100,this.percentHeight=100,this.touchEnabled=!1,this.addEventListener(eui.UIEvent.CREATION_COMPLETE,this.componentCreated,this),this.skinName=t}__extends(t,e);var n=(__define,t),i=n.prototype;return i.componentCreated=function(){this.removeEventListener(eui.UIEvent.CREATION_COMPLETE,this.componentCreated,this),this.inited=!0},i.onEnable=function(){},i.onRemove=function(){},i.onDestroy=function(){},t}(eui.Component);egret.registerClass(BaseScene,"BaseScene");var BaseUI=function(e){function t(t){e.call(this),this.inited=!1,this.addEventListener(eui.UIEvent.CREATION_COMPLETE,this.componentCreated,this),this.skinName=t}__extends(t,e);var n=(__define,t),i=n.prototype;return i.componentCreated=function(){this.removeEventListener(eui.UIEvent.CREATION_COMPLETE,this.componentCreated,this),this.inited=!0},t}(eui.Component);egret.registerClass(BaseUI,"BaseUI");var HttpUtil=function(){function e(){this.httpMethod=egret.HttpMethod.GET,this.request=new egret.HttpRequest,this.request.responseType=egret.HttpResponseType.TEXT,this.request.addEventListener(egret.Event.COMPLETE,this.onPostComplete,this),this.request.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onPostIOError,this)}var t=(__define,e),n=t.prototype;return n.send=function(e,t,n){this.thisObject=n,this.request.open(e,this.httpMethod),this.request.setRequestHeader("Content-type","application/x-www-form-urlencoded"),""!=t?this.request.send(t):this.request.send()},n.onPostComplete=function(e){this.completeHandler&&this.completeHandler.call(this.thisObject,this.request.response)},n.onPostIOError=function(e){egret.log("http error"),this.errorHandler&&this.errorHandler.call(this.thisObject,e)},e}();egret.registerClass(HttpUtil,"HttpUtil");var LayerManager=function(){function e(){this.tweenTime=500}var t=(__define,e),n=t.prototype;return n.initialize=function(e){this.main=e,this.sceneLayer=new eui.Group,this.sceneLayer.percentWidth=100,this.sceneLayer.percentHeight=100,this.main.addChild(this.sceneLayer),this.popLayer=new eui.Group,this.popLayer.percentWidth=100,this.popLayer.percentHeight=100,this.popLayer.touchEnabled=!1,this.popLayer.touchThrough=!0,this.main.addChild(this.popLayer)},n.runScene=function(e,t){void 0===t&&(t=!1),null!=this.curScene&&this.curScene&&(this.sceneLayer.removeChild(this.curScene),this.curScene.onRemove(),t&&this.curScene.onDestroy()),this.curScene=e,this.sceneLayer.addChild(e),e.inited&&e.onEnable()},e.getInstance=function(){return null==this.instance&&(this.instance=new e),this.instance},e}();egret.registerClass(LayerManager,"LayerManager");var LoadManager=function(){function e(){this.loadComplete=new Object,this.loadError=new Object,this.loadProgress=new Object,this.thisObject=new Object}var t=(__define,e),n=t.prototype;return e.getInstance=function(){return null==this.instance&&(this.instance=new e),this.instance},n.loadGroup=function(e,t,n,i,s){void 0===n&&(n=null),void 0===i&&(i=null),void 0===s&&(s=null),this.loadComplete[e]=n,this.loadError[e]=s,this.loadProgress[e]=i,this.thisObject[e]=t,RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.loadGroup(e)},n.onResourceLoadComplete=function(e){var t=e.groupName;RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this);var n=this.loadComplete[t];null!=n&&n.call(this.thisObject[t],e),this.clearCallBack(t)},n.onResourceLoadError=function(e){console.warn("Group:"+e.groupName+" has failed to load");var t=this.loadError[e.groupName];null!=t&&t.call(this.thisObject[e.groupName],e),this.clearCallBack(e.groupName)},n.onResourceProgress=function(e){var t=this.loadProgress[e.groupName];null!=t&&t.call(this.thisObject[e.groupName],e)},n.clearCallBack=function(e){this.loadComplete[e]=null,this.loadError[e]=null,this.loadProgress[e]=null},e}();egret.registerClass(LoadManager,"LoadManager");var UserManager=function(){function e(){this.roleID=0,this.roleNameList=["哈哈兔","悠悠熊猫","暴躁鹿"]}var t=(__define,e);t.prototype;return e.getInstance=function(){return null==this.instance&&(this.instance=new e),this.instance},e}();egret.registerClass(UserManager,"UserManager");var GameConst=function(){function e(){}var t=(__define,e);t.prototype;return e.debug=!1,e.centerX=0,e.centerZ=0,e}();egret.registerClass(GameConst,"GameConst");var GameManager=function(){function e(){this.lockScene=new LockScene,this.gameScene=new GameScene,this.resultScene=new ResultScene,this.prizeScene=new PrizeScene,this.messageBox=new MessageBox}var t=(__define,e),n=t.prototype;return n.startup=function(e){GameConst.gameConfig=window.gameConfig,GameConst.debug=GameConst.gameConfig.debug,GameConst.stage=e.stage,console.log("调试模式:",GameConst.debug),LayerManager.getInstance().initialize(e),this.socket=ClientSocket.getInstance(),this.socket.gameManager=this,this.socket.lockScene=this.lockScene,this.socket.gameScene=this.gameScene,this.socket.resultScene=this.resultScene,this.socket.startConnect()},n.connect=function(){this.sendLogin()},n.disconnect=function(){},n.sendLogin=function(){var e=GameConst.gameConfig,t={rid:e.rid,openid:e.openid,headimgurl:e.headimgurl,nickname:e.nickname,userType:"mobile"};egret.log("send login:","rid:",t.rid,"openid:",t.openid),this.socket.sendMessage("login",t,this.revLogin,this)},n.revLogin=function(e){egret.log("rev login");var t=e.success,n=e.msg;t||alert(n)},n.revStartLock=function(){egret.log("revStartLock"),this.preloadScene.parent&&this.preloadScene.parent.removeChild(this.preloadScene),this.preloadScene=null,LayerManager.getInstance().runScene(e.getInstance().lockScene)},e.getInstance=function(){return null==this.instance&&(this.instance=new e),this.instance},e}();egret.registerClass(GameManager,"GameManager");var ClientSocket=function(){function e(){}var t=(__define,e),n=t.prototype;return e.getInstance=function(){return null==this.instance&&(this.instance=new e),this.instance},n.isConnected=function(){return this.socket&&this.socket.connected?!0:!1},n.closeSocket=function(){egret.log("主动断开连接"),this.socket.disconnect()},n.startConnect=function(){this.socket=io.connect(window.gameConfig.server,{reconnection:!1,"force new connection":!0}),console.log("connect:",window.gameConfig.server);var e=this;this.socket.on("connect",function(){egret.log("connenct succss"),e.gameManager.connect()}),this.socket.on("error",function(e){egret.log("connenct erro")}),this.socket.on("disconnect",function(){egret.log("connenct close"),e.gameManager.disconnect()}),this.socket.on("reconnect_attempt",function(){egret.log("reconnect")}),this.socket.on("connect_timeout",function(){}),this.socket.on("startLock",function(t){e.gameManager.revStartLock()}),this.socket.on("assignRole",function(t){e.lockScene.revAssignRole(t)}),this.socket.on("startGame",function(t){e.lockScene.revStartGame()}),this.socket.on("gameOver",function(t){e.gameScene.revGameOver(t)}),this.socket.on("prize",function(t){e.gameScene.revPrize()})},n.sendMessage=function(e,t,n,i){void 0===t&&(t=null),void 0===n&&(n=null),void 0===i&&(i=null),this.socket&&this.socket.connected&&this.socket.emit(e,t,function(e){n&&i&&n.call(i,e)})},e}();egret.registerClass(ClientSocket,"ClientSocket");var GameScene=function(e){function t(){e.call(this,"GameSceneSkin"),this.deviceX=0,this.deviceZ=0,this.gestureUp=!1,this.gestureR=!1,this.gestureL=!1,this.angleLimit=30,this.angleReturn=25}__extends(t,e);var n=(__define,t),i=n.prototype;return i.componentCreated=function(){e.prototype.componentCreated.call(this),this.centerLabel.visible=!1,this.deviceLabel.visible=!1,this.actionLabel.visible=!1,this.statusLabel.visible=!1,this.socket=ClientSocket.getInstance()},i.onEnable=function(){this.resetGame(),this.startGame()},i.onRemove=function(){this.stopDevice()},i.startGame=function(){this.configListeners(),this.openDevice()},i.resetGame=function(){egret.log("resetGame1"),this.gestureUp=!1,this.gestureR=!1,this.gestureL=!1,this.centerZ=GameConst.centerZ,this.centerX=GameConst.centerX,this.centerLabel.text="centerZ:"+this.centerZ+"  centerX:"+this.centerX,this.setRoleImg(),this.setRoleName()},i.gameOver=function(){this.resetGame()},i.configListeners=function(){this.leftBtn.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onLeftBtnTouch,this),this.rightBtn.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onRightBtnTouch,this),this.upBtn.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onUpBtnTouch,this)},i.onLeftBtnTouch=function(){egret.log("left touch"),this.sendLeftAction()},i.onRightBtnTouch=function(){this.sendRightAction()},i.onUpBtnTouch=function(){this.sendUpAction()},i.setRoleImg=function(){this.headImg.texture=null;var e=UserManager.getInstance().roleID;this.headImg.texture=RES.getRes("head"+e+"_png")},i.setRoleName=function(){var e=UserManager.getInstance().roleID;this.nameLabel.text=UserManager.getInstance().roleNameList[e]},i.openDevice=function(){this.orientation=new egret.DeviceOrientation,this.orientation.addEventListener(egret.Event.CHANGE,this.onOrientation,this),this.orientation.start()},i.stopDevice=function(){this.orientation.stop(),this.orientation.removeEventListener(egret.Event.CHANGE,this.onOrientation,this)},i.onOrientation=function(e){if(this.deviceX=parseFloat(e.beta.toFixed(2)),this.deviceZ=parseFloat(e.alpha.toFixed(2)),this.deviceLabel.text="x轴角速度:"+this.deviceX+"\nz轴角速度:"+this.deviceZ,this.statusLabel.text="up:"+this.gestureUp+" R:"+this.gestureR+" L:"+this.gestureL,this.deviceX>=this.angleLimit&&0==this.gestureUp?(this.gestureUp=!0,this.sendUpAction(),this.upBtn.devieceDown(),this.actionLabel.text="Up:"+this.deviceX):this.deviceX<=this.angleReturn&&(this.gestureUp=!1),!(this.deviceX>this.angleLimit)){var t=Math.round(this.deviceZ-this.centerZ);t<this.angleReturn&&t>-this.angleReturn?(this.gestureR=!1,this.gestureL=!1):(t>180&&360-t<this.angleReturn||-180>t&&360+t<this.angleReturn)&&(this.gestureR=!1,this.gestureL=!1),t>=this.angleLimit&&180>t||t>=this.angleLimit-360&&-180>t?0==this.gestureL&&0==this.gestureR&&(this.gestureL=!0,this.sendLeftAction(),this.leftBtn.devieceDown(),this.actionLabel.text="L:"+this.deviceZ):(t<=-this.angleLimit&&t>-180||t<360-this.angleLimit&&t>180)&&0==this.gestureR&&0==this.gestureL&&(this.gestureR=!0,this.sendRightAction(),this.rightBtn.devieceDown(),this.actionLabel.text="R:"+this.deviceZ)}},i.sendRightAction=function(){this.socket.sendMessage("action",{actionType:"right",openid:GameConst.gameConfig.openid})},i.sendLeftAction=function(){this.socket.sendMessage("action",{actionType:"left",openid:GameConst.gameConfig.openid})},i.sendUpAction=function(){this.socket.sendMessage("action",{actionType:"up",openid:GameConst.gameConfig.openid})},i.revGameOver=function(e){egret.log("revGameOver"),console.log("revGameOver",e),1==GameConst.debug&&(e={gameRankList:[{headUrl:"resource/assets/home/head0.png",nickName:"A",score:999,rank:1},{headUrl:"resource/assets/home/head0.png",nickName:"B",score:999,rank:1},{headUrl:"resource/assets/home/head0.png",nickName:"C",score:999,rank:1}],rankList:[{headUrl:"resource/assets/home/head0.png",nickName:"A",score:99},{headUrl:"resource/assets/home/head0.png",nickName:"B",score:99},{headUrl:"resource/assets/home/head0.png",nickName:"C",score:99}]}),this.resultData=e,GameManager.getInstance().prizeScene.parent||LayerManager.getInstance().runScene(GameManager.getInstance().resultScene)},i.revPrize=function(){egret.log("revPrize:",GameConst.gameConfig.isGetPrie),1==GameConst.gameConfig.isGetPrie?GameManager.getInstance().resultScene.parent||LayerManager.getInstance().runScene(GameManager.getInstance().resultScene):LayerManager.getInstance().runScene(GameManager.getInstance().prizeScene)},t}(BaseScene);egret.registerClass(GameScene,"GameScene");var LockScene=function(e){function t(){e.call(this,"LockSceneSkin"),this.isLocked=!1}__extends(t,e);var n=(__define,t),i=n.prototype;return i.componentCreated=function(){e.prototype.componentCreated.call(this),this.socket=ClientSocket.getInstance()},i.onEnable=function(){this.msgLabel.text="",this.openDevice(),this.okBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onOkBtnTouch,this)},i.onRemove=function(){this.stopDevice(),this.okBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onOkBtnTouch,this)},i.setRoleImg=function(){var e=UserManager.getInstance().roleID;this.headImg.texture=RES.getRes("head"+e+"_png")},i.setRoleName=function(){var e=UserManager.getInstance().roleID;this.nameLabel.text=UserManager.getInstance().roleNameList[e]},i.onOkBtnTouch=function(){this.msgLabel.text="校准完成\n请等待游戏开始",GameConst.centerZ=this.deviceZ,GameConst.centerX=this.deviceX,0==this.isLocked&&this.sendLock(),this.isLocked=!0},i.openDevice=function(){this.orientation=new egret.DeviceOrientation,this.orientation.addEventListener(egret.Event.CHANGE,this.onOrientation,this),this.orientation.start()},i.onOrientation=function(e){this.deviceX=parseFloat(e.beta.toFixed(2)),this.deviceZ=parseFloat(e.alpha.toFixed(2))},i.stopDevice=function(){this.orientation.stop(),this.orientation.removeEventListener(egret.Event.CHANGE,this.onOrientation,this)},i.sendLock=function(){egret.log("sendLock"),this.socket.sendMessage("lock")},i.revStartGame=function(){egret.log("revStartGame"),LayerManager.getInstance().runScene(GameManager.getInstance().gameScene)},i.revAssignRole=function(e){egret.log("revAssignRole:",e.roleType);var t=e.roleType;UserManager.getInstance().roleID=t,this.setRoleImg(),this.setRoleName()},t}(BaseScene);egret.registerClass(LockScene,"LockScene");var PreloadScene=function(e){function t(){e.call(this,"PreloadSceneSkin")}__extends(t,e);var n=(__define,t),i=n.prototype;return i.componentCreated=function(){e.prototype.componentCreated.call(this)},i.setProgress=function(e){this.inited&&(this.progressLabel.text=e.toString()+"%")},t}(BaseScene);egret.registerClass(PreloadScene,"PreloadScene");var PrizeScene=function(e){function t(){e.call(this,"PrizeSceneSkin")}__extends(t,e);var n=(__define,t),i=n.prototype;return i.componentCreated=function(){e.prototype.componentCreated.call(this),this.phoneLabel.text=""},i.onEnable=function(){this.okBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onOKBtnTouch,this)},i.onRemove=function(){this.okBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onOKBtnTouch,this)},i.onOKBtnTouch=function(){var e=/^1\d{10}$/,t=e.test(this.phoneLabel.text);if(0==t)return void alert("手机号码不正确");null==this.http&&(this.http=new HttpUtil,this.http.completeHandler=this.completeHandler,this.http.errorHandler=this.errorHandler,this.http.httpMethod=egret.HttpMethod.POST);var n="http://node.ekche.com/game/phpFiles/paoku/gameAction.php",i="openid="+GameConst.gameConfig.openid,s="&sign="+GameConst.gameConfig.sign,o="&timestamp="+GameConst.gameConfig.timestamp,r="&acType=sendMobileData",a="&tel="+this.phoneLabel.text,c=i+s+o+r+a;this.http.send(n,c,this),egret.log("sendPrizeHttp:",n,c)},i.completeHandler=function(e){var t=JSON.parse(e),n=(t.status,t.msg);egret.log("revPrizeHttp:","status:",t.status,"msg:",t.msg);var i=GameManager.getInstance().messageBox;i.showMsg(n),i.addEventListener("close",function(){LayerManager.getInstance().runScene(GameManager.getInstance().resultScene)},this)},i.errorHandler=function(){var e=GameManager.getInstance().messageBox;e.showMsg("提交失败"),e.addEventListener("close",function(){LayerManager.getInstance().runScene(GameManager.getInstance().resultScene)},this)},t}(BaseScene);egret.registerClass(PrizeScene,"PrizeScene");var ResultScene=function(e){function t(){e.call(this,"ResultSceneSkin"),this.headList=new Array,this.rankList=new Array}__extends(t,e);var n=(__define,t),i=n.prototype;return i.componentCreated=function(){e.prototype.componentCreated.call(this),this.headList.push(this.head0,this.head1,this.head2);for(var t=0;10>t;t++)this.rankList.push(this["rank"+t])},i.onEnable=function(){this.showResult(GameManager.getInstance().gameScene.resultData)},i.onRemove=function(){},i.showResult=function(e){for(var t=e.gameRankList,n=e.rankList,i=this.headList.length,s=0;i>s;s++){var o=this.headList[s];o.clear()}i=t.length;for(var s=0;i>s;s++)this.headList[s].setNameLabel(t[s].nickName),this.headList[s].setScoreLabel(t[s].score),this.headList[s].loadImg(t[s].headUrl);for(var s=0;10>s;s++){var r=this.rankList[s];r.clear()}i=n.length,i=i>10?10:i;for(var s=0;i>s;s++){var a=n[s],r=this.rankList[s];r.setNameLabel(a.nickName),r.setScoreLabel(a.score),r.loadImg(a.headUrl),r.setRankLabel(s+1)}},t}(BaseScene);egret.registerClass(ResultScene,"ResultScene");var MessageBox=function(e){function t(){e.call(this,"MessageBoxSkin")}__extends(t,e);var n=(__define,t),i=n.prototype;return i.componentCreated=function(){e.prototype.componentCreated.call(this),this.closeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTap,this)},i.onTouchTap=function(){this.hide(),this.dispatchEvent(new egret.Event("close"))},i.showMsg=function(e){this.msgLabel.text=e,LayerManager.getInstance().popLayer.addChild(this)},i.hide=function(){this.parent&&this.parent.removeChild(this)},t}(BaseUI);egret.registerClass(MessageBox,"MessageBox");var RankHead=function(e){function t(){e.call(this,"RankHeadSkin"),this.imgWidth=50,this.imgHeight=50,this.imageLoader=new egret.ImageLoader}__extends(t,e);var n=(__define,t),i=n.prototype;return i.componentCreated=function(){e.prototype.componentCreated.call(this),this.nameLabel.text="",this.headImg=new egret.Bitmap,this.headImg.width=this.imgWidth,this.headImg.height=this.imgHeight,this.headMask&&(this.headImg.mask=this.headMask),this.imgGroup.addChild(this.headImg)},i.setNameLabel=function(e){this.nameLabel.text=e},i.setScoreLabel=function(e){this.scoreLabel.text=e+""},i.setRankLabel=function(e){this.rankLabel.text=e+""},i.loadImg=function(e){this.imageLoader.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onLoadError,this),this.imageLoader.addEventListener(egret.Event.COMPLETE,this.loadCompleteHandler,this),this.imageLoader.load(e)},i.loadCompleteHandler=function(e){var t=e.currentTarget;this.headImg.bitmapData=t.data},i.onLoadError=function(){egret.log("加载头像错误")},i.isEmpty=function(){return""==this.nameLabel.text?!0:!1},i.clear=function(){this.nameLabel.text="",this.scoreLabel.text="",this.rankLabel.text="",this.headImg.bitmapData=null,this.openid=""},t}(BaseUI);egret.registerClass(RankHead,"RankHead");var ResultHead=function(e){function t(){e.call(this,"ResultHeadSkin"),this.imgWidth=75,this.imgHeight=75,this.imageLoader=new egret.ImageLoader}__extends(t,e);var n=(__define,t),i=n.prototype;return i.componentCreated=function(){e.prototype.componentCreated.call(this),this.nameLabel.text="",this.headImg=new egret.Bitmap,this.headImg.width=this.imgWidth,this.headImg.height=this.imgHeight,this.headMask&&(this.headImg.mask=this.headMask),this.imgGroup.addChild(this.headImg)},i.setNameLabel=function(e){this.nameLabel.text="昵称："+e},i.setScoreLabel=function(e){this.scoreLabel.text="得分："+e},i.loadImg=function(e){this.imageLoader.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onLoadError,this),this.imageLoader.addEventListener(egret.Event.COMPLETE,this.loadCompleteHandler,this),this.imageLoader.load(e)},i.loadCompleteHandler=function(e){var t=e.currentTarget;this.headImg.bitmapData=t.data},i.onLoadError=function(){egret.log("加载头像错误")},i.isEmpty=function(){return""==this.nameLabel.text?!0:!1},i.clear=function(){this.nameLabel.text="",this.headImg.bitmapData=null,this.openid=""},t}(BaseUI);egret.registerClass(ResultHead,"ResultHead");var SimpleButton=function(e){function t(){e.call(this,"SimpleButtonSkin")}__extends(t,e);var n=(__define,t),i=n.prototype;return i.componentCreated=function(){e.prototype.componentCreated.call(this),this.touchEnabled=!0,this.up.visible=!0,this.down.visible=!1,this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchBegin,this),this.addEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEnd,this)},i.onTouchBegin=function(){this.down.visible=!0,this.up.visible=!1},i.onTouchEnd=function(){this.down.visible=!1,this.up.visible=!0},i.devieceDown=function(){var e=this;this.up.visible=!1,this.down.visible=!0,egret.Tween.get(this).wait(150).call(function(){e.up.visible=!0,e.down.visible=!1},this)},t}(BaseUI);egret.registerClass(SimpleButton,"SimpleButton");var LoadingUI=function(e){function t(){e.call(this),this.createView()}__extends(t,e);var n=(__define,t),i=n.prototype;return i.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=300,this.textField.width=480,this.textField.height=100,this.textField.textAlign="center"},i.setProgress=function(e,t){this.textField.text="Loading..."+e+"/"+t},t}(egret.Sprite);egret.registerClass(LoadingUI,"LoadingUI");var Main=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var n=(__define,t),i=n.prototype;return i.createChildren=function(){e.prototype.createChildren.call(this);var t=new AssetAdapter;this.stage.registerImplementation("eui.IAssetAdapter",t),this.stage.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/default.res.json","resource/")},i.onConfigComplete=function(e){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this);var t=new eui.Theme("resource/default.thm.json",this.stage);t.addEventListener(eui.UIEvent.COMPLETE,this.onThemeLoadComplete,this)},i.onThemeLoadComplete=function(){LoadManager.getInstance().loadGroup("preload",this,this.onPreloadComplete)},i.onPreloadComplete=function(e){this.preloadScene=new PreloadScene,this.addChild(this.preloadScene),GameManager.getInstance().preloadScene=this.preloadScene,LoadManager.getInstance().loadGroup("home",this,this.onGameComplete,this.onGameProgress)},i.onGameProgress=function(e){this.preloadScene.setProgress(Math.round(e.itemsLoaded/e.itemsTotal*100))},i.onGameComplete=function(){LoadManager.getInstance().loadGroup("result",this),this.preloadScene.progressLabel.text="请等待大屏幕倒计时结束\n游戏即将开始",GameManager.getInstance().startup(this)},t}(eui.UILayer);egret.registerClass(Main,"Main");var ThemeAdapter=function(){function e(){}var t=(__define,e),n=t.prototype;return n.getTheme=function(e,t,n,i){function s(e){t.call(i,e)}function o(t){t.resItem.url==e&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,o,null),n.call(i))}RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,o,null),RES.getResByUrl(e,s,this,RES.ResourceItem.TYPE_TEXT)},e}();egret.registerClass(ThemeAdapter,"ThemeAdapter",["eui.IThemeAdapter"]);