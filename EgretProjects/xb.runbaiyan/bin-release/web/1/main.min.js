var AssetAdapter=function(){function e(){}var t=(__define,e),i=t.prototype;return i.getAsset=function(e,t,i){function n(n){t.call(i,n,e)}if(RES.hasRes(e)){var s=RES.getRes(e);s?n(s):RES.getResAsync(e,n,this)}else RES.getResByUrl(e,n,this,RES.ResourceItem.TYPE_IMAGE)},e}();egret.registerClass(AssetAdapter,"AssetAdapter",["eui.IAssetAdapter"]);var BaseScene=function(e){function t(t){e.call(this),this.inited=!1,this.percentWidth=100,this.percentHeight=100,this.touchEnabled=!1,this.addEventListener(eui.UIEvent.CREATION_COMPLETE,this.componentCreated,this),this.skinName=t}__extends(t,e);var i=(__define,t),n=i.prototype;return n.componentCreated=function(){this.removeEventListener(eui.UIEvent.CREATION_COMPLETE,this.componentCreated,this),this.inited=!0},n.onEnable=function(){},n.onRemove=function(){},n.onDestroy=function(){},t}(eui.Component);egret.registerClass(BaseScene,"BaseScene");var BaseUI=function(e){function t(t){e.call(this),this.inited=!1,this.addEventListener(eui.UIEvent.CREATION_COMPLETE,this.componentCreated,this),this.skinName=t}__extends(t,e);var i=(__define,t),n=i.prototype;return n.componentCreated=function(){this.removeEventListener(eui.UIEvent.CREATION_COMPLETE,this.componentCreated,this),this.inited=!0},t}(eui.Component);egret.registerClass(BaseUI,"BaseUI");var GameConst=function(){function e(){}var t=(__define,e);t.prototype;return e}();egret.registerClass(GameConst,"GameConst");var HTMLText=function(){function e(){var e=document.getElementById("gameDiv");this.myText=document.createElement("p"),this.myText.style.border="0px",this.myText.style.backgroundColor="transparent",this.myText.style.position="absolute",this.myText.style.fontSize="25px",this.myText.style.display="none",e.appendChild(this.myText)}var t=(__define,e),i=t.prototype;return i.setValue=function(e){this.myText.style.display="inline",this.myText.innerHTML=e},i.setPosition=function(e,t){this.myText.style.left=e+"px",this.myText.style.top=t+"px"},i.hide=function(){this.myText.style.display="none"},e}();egret.registerClass(HTMLText,"HTMLText");var LayerManager=function(){function e(){this.tweenTime=500}var t=(__define,e),i=t.prototype;return i.initialize=function(e){this.main=e,this.sceneLayer=new eui.Group,this.sceneLayer.percentWidth=100,this.sceneLayer.percentHeight=100,this.main.addChild(this.sceneLayer),this.popLayer=new eui.Group,this.popLayer.percentWidth=100,this.popLayer.percentHeight=100,this.popLayer.touchEnabled=!1,this.main.addChild(this.popLayer)},i.runScene=function(e,t){void 0===t&&(t=!1),this.sceneLayer.addChild(e),e.inited&&e.onEnable(),null!=this.curScene&&this.curScene&&(this.sceneLayer.removeChild(this.curScene),this.curScene.onRemove(),t&&this.curScene.onDestroy()),this.curScene=e},e.getInstance=function(){return null==this.instance&&(this.instance=new e),this.instance},e}();egret.registerClass(LayerManager,"LayerManager");var LoadManager=function(){function e(){this.loadComplete=new Object,this.loadError=new Object,this.loadProgress=new Object,this.thisObject=new Object}var t=(__define,e),i=t.prototype;return e.getInstance=function(){return null==this.instance&&(this.instance=new e),this.instance},i.loadGroup=function(e,t,i,n,s){void 0===i&&(i=null),void 0===n&&(n=null),void 0===s&&(s=null),this.loadComplete[e]=i,this.loadError[e]=s,this.loadProgress[e]=n,this.thisObject[e]=t,RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.loadGroup(e)},i.onResourceLoadComplete=function(e){var t=e.groupName;RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this);var i=this.loadComplete[t];null!=i&&i.call(this.thisObject[t],e),this.clearCallBack(t)},i.onResourceLoadError=function(e){console.warn("Group:"+e.groupName+" has failed to load");var t=this.loadError[e.groupName];null!=t&&t.call(this.thisObject[e.groupName],e),this.clearCallBack(e.groupName)},i.onResourceProgress=function(e){var t=this.loadProgress[e.groupName];null!=t&&t.call(this.thisObject[e.groupName],e)},i.clearCallBack=function(e){this.loadComplete[e]=null,this.loadError[e]=null,this.loadProgress[e]=null},e}();egret.registerClass(LoadManager,"LoadManager");var MapManager=function(){function e(){this.mapSize=9,this.isPlayTurn=!0}var t=(__define,e),i=t.prototype;return i.lock=function(){this.isPlayTurn=!1},i.unlock=function(){this.isPlayTurn=!0},i.findPath=function(e){for(var t,i=0;i<this.mapSize;i++)for(var n=0;n<this.mapSize;n++)t=this.mapList[i][n],t.clean();t=this.findNode(e);var s=[];if(t)for(;t.parentNode;)s.push(t.getPos()),t=t.parentNode;else console.log("已经被困随便走一步"),s=this.getNear(e);return s.reverse()},i.findNode=function(e){for(var t,i,n,s=[e],r=[e],o=!0,a=0,h=0,c=0,l=0;o;){if(h=r.length,0==h)return o=!1,null;var u=[];for(a=0;h>a;a++){for(i=r.shift(),t=this.getRound(i.getPos()),l=t.length,c=0;l>c;c++){var d=t[c];if(n=this.mapList[d[0]][d[1]],n.bHave)s.push(n);else if(!(s.indexOf(n)>-1||r.indexOf(n)>-1)){if(n.parentNode=i,this.isExit(n))return n;u.push(n)}}s.push(i)}r=u}},i.getRound=function(e){var t,i=e[0],n=e[1],s=[];t=i%2==0?[[i-1,n-1],[i-1,n],[i,n+1],[i,n-1],[i+1,n-1],[i+1,n]]:[[i-1,n+1],[i-1,n],[i,n+1],[i,n-1],[i+1,n+1],[i+1,n]];for(var r=0;6>r;r++){var o=t[r];o[0]>=0&&o[1]>=0&&o[0]<this.mapSize&&o[1]<this.mapSize&&s.push(o)}return s},i.isExit=function(e){var t=e.getPos();return 0==t[0]||0==t[1]||t[0]==this.mapSize-1||t[1]==this.mapSize-1?!0:!1},i.getNear=function(e){for(var t=e.getPos(),i=this.getRound(t),n=i.length,s=0;n>s;s++)if(!this.getNode(i[s]).bHave)return[i[s]];return[]},i.getNode=function(e){return this.mapList[e[0]][e[1]]},e}();egret.registerClass(MapManager,"MapManager");var ObjectPool=function(){function e(e){this.className=e,this.list=[]}var t=(__define,e),i=t.prototype;return i.getObject=function(){if(this.list.length>0)return this.list.shift();var e=egret.getDefinitionByName(this.className);return new e},i.returnObject=function(e){this.list.push(e)},e.getPool=function(t,i){if(void 0===i&&(i=0),!e.pool[t]&&(e.pool[t]=new e(t),0!=i))for(var n=egret.getDefinitionByName(t),s=e.pool[t],r=0;i>r;r++)s.returnObject(new n);return e.pool[t]},e.pool={},e}();egret.registerClass(ObjectPool,"ObjectPool");var QRCode=function(){function e(){}var t=(__define,e),i=t.prototype;return i.createCode=function(){if(null==this.myImg){var e=document.getElementById("gameDiv");this.myImg=document.createElement("img"),this.myImg.src="resource/assets/game_qrcode.png",this.myImg.style.position="absolute",this.myImg.style.display="none",e.appendChild(this.myImg)}},i.showCode=function(e,t,i,n){this.myImg&&(this.myImg.style.left=e+"px",this.myImg.style.top=t+"px",this.myImg.style.display="inline")},i.hideCode=function(){this.myImg&&(this.myImg.style.display="none")},i.setPosition=function(e,t){this.myImg.style.left=e+"px",this.myImg.style.top=t+"px"},e}();egret.registerClass(QRCode,"QRCode");var GameManager=function(){function e(){this.homeScene=new HomeScene,this.gameScene=new GameScene,this.luckScene=new LuckScene,this.resultScene=new ResultScene}var t=(__define,e),i=t.prototype;return i.startup=function(e){GameConst.stage=e.stage,LayerManager.getInstance().initialize(e),LayerManager.getInstance().runScene(this.homeScene),window.gameScene=this.gameScene},e.getInstance=function(){return null==this.instance&&(this.instance=new e),this.instance},e}();egret.registerClass(GameManager,"GameManager");var GameScene=function(e){function t(){e.call(this,"GameSceneSkin"),this.gridBgList=[],this.gridList=[],this.rowMax=9,this.colMax=9,this.gridStartX=60,this.gridStartY=33,this.gridIntervalX=62,this.gridIntervalY=56,this.player=new Player,this.initPlayerRow=4,this.initPlayerCol=4,this.randGridLimit=16,this.gridPool=ObjectPool.getPool(Grid.NAME,20),this.map=new MapManager}__extends(t,e);var i=(__define,t),n=i.prototype;return n.componentCreated=function(){e.prototype.componentCreated.call(this),this.initGrid(),this.map.mapList=this.gridBgList,this.luckScroller.scrollPolicyV=eui.ScrollPolicy.ON},n.onEnable=function(){this.startGame()},n.onRemove=function(){this.resetGame()},n.startGame=function(){this.resetGame(),this.randGrid(),this.gridBgGroup.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onPlaceGrid,this)},n.gameOver=function(e){this.showResult(e)},n.resetGame=function(){this.resetPlayer(),this.resetMap(),this.hideResult(),this.hideLuck(),this.hideWater()},n.onPlaceGrid=function(e){if(e.target instanceof GridBg){var t=e.target;if(t.bHave)return;if(0==this.map.isPlayTurn)return;t.bHave=!0;var i=this.gridPool.getObject();i.x=t.x,i.y=t.y,this.gridList.push(i),this.gridGroup.addChild(i),0==this.checkGameOver()&&this.movePlayer()}},n.checkGameOver=function(){var e=this.player.row,t=this.player.col;if(0==e||e==this.rowMax-1||0==t||t==this.colMax-1)return this.gameOver(!1),!0;var i=e%2==0?-1:0;return this.gridBgList[e-1][t+i].bHave&&this.gridBgList[e-1][t+i+1].bHave&&this.gridBgList[e][t-1].bHave&&this.gridBgList[e][t+1].bHave&&this.gridBgList[e+1][t+i].bHave&&this.gridBgList[e+1][t+i+1].bHave?(this.gameOver(!0),!0):!1},n.movePlayer=function(){var e=this.player.row,t=this.player.col;this.map.lock();var i=this.map.findPath(this.gridBgList[e][t]);if(i.length){var n=i[0],s=this.gridBgList[n[0]][n[1]],r=this;this.player.row=s.row,this.player.col=s.col,egret.Tween.get(this.player).to({x:s.x,y:s.y},100).call(function(){r.map.unlock();var e=r.map.getNear(s);0==e.length&&r.gameOver(!0)})}else console.log("win"),this.gameOver(!0)},n.randGrid=function(){for(var e,t,i,n,s=0;s<this.randGridLimit;s++)e=Math.floor(Math.random()*this.rowMax),t=Math.floor(Math.random()*this.colMax),e!=this.initPlayerRow||t!=this.initPlayerCol?(n=this.gridBgList[e][t],n.bHave?s--:(n.bHave=!0,i=this.gridPool.getObject(),i.x=n.x,i.y=n.y,this.gridList.push(i),this.gridGroup.addChild(i))):s--},n.initGrid=function(){for(var e,t=0;t<this.rowMax;t++){this.gridBgList[t]=[];for(var i=0;i<this.colMax;i++)e=new GridBg,e.row=t,e.col=i,t%2==0?e.x=this.gridStartX+i*this.gridIntervalX:e.x=this.gridStartX+i*this.gridIntervalX+30,e.y=this.gridStartY+t*this.gridIntervalY,e.anchorOffsetX=e.width/2,e.anchorOffsetY=e.height/2,this.gridBgGroup.addChild(e),this.gridBgList[t][i]=e}this.gridBgGroup.cacheAsBitmap=!0},n.resetPlayer=function(){var e=this.gridBgList[this.initPlayerRow][this.initPlayerCol];this.player.x=e.x,this.player.y=e.y,this.player.row=this.initPlayerRow,this.player.col=this.initPlayerCol,this.player.shakeHead(),this.playerGroup.addChild(this.player)},n.resetMap=function(){this.map.unlock();for(var e,t=this.gridList.length,i=0;t>i;i++)e=this.gridList[i],this.gridGroup.removeChild(e),this.gridPool.returnObject(e);this.gridList.length=0;for(var n,i=0;i<this.rowMax;i++)for(var s=0;s<this.colMax;s++)n=this.gridBgList[i][s],n.bHave=!1},n.showResult=function(e){e?(this.successText.visible=!0,this.failText.visible=!1,this.luckBtn.visible=!0):(this.successText.visible=!1,this.failText.visible=!0,this.luckBtn.visible=!1),this.addChild(this.resultGroup),this.configResultListener()},n.hideResult=function(){this.removeChild(this.resultGroup),this.deConfigResultListener()},n.configResultListener=function(){this.lookBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onLookBtnTouch,this),this.luckBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onLuckBtnTouch,this),this.shareBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onShareBtnTouch,this),this.againBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onAgainBtnTouch,this)},n.deConfigResultListener=function(){this.lookBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onLookBtnTouch,this),this.luckBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onLuckBtnTouch,this),this.shareBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onShareBtnTouch,this),this.againBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onAgainBtnTouch,this)},n.onLookBtnTouch=function(){this.deConfigResultListener(),window.getPrizeList()},n.recivePrizeListResult=function(e){null!=e&&(this.removeChild(this.resultGroup),this.showLuckList(e)),this.configResultListener()},n.onLuckBtnTouch=function(){this.deConfigResultListener(),window.sendGetPrize()},n.reciveLuckResult=function(e){null!=e&&(GameConst.prizeJson=e,200!=e.code?alert(e.msg):LayerManager.getInstance().runScene(GameManager.getInstance().resultScene)),this.configResultListener()},n.onShareBtnTouch=function(){null==this.water&&(this.water=new Water),this.water.x=this.shareBtn.x,this.water.y=this.shareBtn.y,this.water.reset(),this.addChild(this.water),egret.Tween.get(this.water).to({x:-this.water.width},200).to({y:0},10).to({x:GameConst.stage.stageWidth-this.water.width},600).call(this.showWater,this)},n.showWater=function(){var e=this;this.water.addEventListener("waterComplete",function(){e.water.parent&&e.removeChild(e.water)},this),this.water.play()},n.hideWater=function(){this.water&&this.water.parent&&this.water.parent.removeChild(this.water)},n.onAgainBtnTouch=function(){this.startGame()},n.hideLuck=function(){this.luckGroup.parent&&this.removeChild(this.luckGroup)},n.showLuckList=function(e){this.addChild(this.luckGroup),this.okBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onOKBtnTouch,this);for(var t=0;50>t&&null!=e[0];t++){var i=new LuckText;i.setNameLabel(e[t].nickname),i.setPrizeLabel(e[t].prizemsg),this.luckScrollerGroup.addChild(i)}},n.onOKBtnTouch=function(){this.okBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onOKBtnTouch,this),this.removeChild(this.luckGroup),this.luckScroller.viewport.scrollV=0,this.addChild(this.resultGroup),this.configResultListener()},t}(BaseScene);egret.registerClass(GameScene,"GameScene");var HomeScene=function(e){function t(){e.call(this,"HomeSceneSkin"),this.initCodeX=-135,this.ininCodeEndY=20,this.codeSpeed=10,this.nextCodeX=0}__extends(t,e);var i=(__define,t),n=i.prototype;return n.componentCreated=function(){e.prototype.componentCreated.call(this),this.ruleScroller.bounces=!1,this.initGirlX=this.girl.x,this.initStartBtnX=this.startBtn.x,this.initIntroduceBtnX=this.introduceBtn.x,this.initbigGirlX=this.bigGril.x,this.initArrowY=this.arrow.y,this.initCodeY=820/1150*document.body.clientHeight,this.qrcode=new QRCode,this.qrcode.createCode()},n.onEnable=function(){this.girl.shakeHead(),this.girl.x=this.initGirlX,this.startBtn.x=this.initStartBtnX,this.introduceBtn.x=this.initIntroduceBtnX,this.bigGril.x=this.initbigGirlX,this.ruleScroller.alpha=0,this.ruleBg.alpha=0,this.startBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onStartBtnTouch,this),this.introduceBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onIntroduceBtnTouch,this),this.ruleGroup.y=.76*GameConst.stage.stageHeight,this.arrow.visible=!1,this.arrow.y=this.initArrowY,egret.Tween.get(this.arrow,{loop:!0}).to({y:this.arrow.y-10},500).to({y:this.arrow.y+10},500),this.qrcode.showCode(this.initCodeX,this.initCodeY,100,100)},n.onRemove=function(){this.girl.stopShake(),egret.Tween.removeTweens(this.arrow),this.startBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onStartBtnTouch,this),this.introduceBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onIntroduceBtnTouch,this)},n.onStartBtnTouch=function(){LayerManager.getInstance().runScene(GameManager.getInstance().gameScene)},n.onIntroduceBtnTouch=function(){this.showRule()},n.showRule=function(){this.startBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onStartBtnTouch,this),this.introduceBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onIntroduceBtnTouch,this),egret.Tween.get(this.girl).to({x:GameConst.stage.stageWidth},200,egret.Ease.quadIn),egret.Tween.get(this.bigGril).to({x:271},300,egret.Ease.quadIn),egret.Tween.get(this.startBtn).wait(100).to({x:this.initStartBtnX-700},200,egret.Ease.quadIn),egret.Tween.get(this.introduceBtn).wait(100).to({x:this.initIntroduceBtnX-700},200,egret.Ease.quadIn),egret.Tween.get(this.ruleBg).wait(200).to({alpha:1},300,egret.Ease.quadIn),egret.Tween.get(this.ruleScroller).wait(200).to({alpha:1},300,egret.Ease.quadIn),this.nextCodeX=this.initCodeX,this.addEventListener(egret.Event.ENTER_FRAME,this.onCodeEnter,this);var e=this;egret.Tween.get(this).wait(500).call(function(){e.bigGril.addEventListener(egret.TouchEvent.TOUCH_TAP,e.hideRule,e),e.title.addEventListener(egret.TouchEvent.TOUCH_TAP,e.hideRule,e),e.arrow.visible=!0})},n.hideRule=function(){this.bigGril.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.hideRule,this),this.title.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.hideRule,this),egret.Tween.get(this.ruleBg).to({alpha:0},300,egret.Ease.quadIn),egret.Tween.get(this.ruleScroller).to({alpha:0},300,egret.Ease.quadIn),this.addEventListener(egret.Event.ENTER_FRAME,this.onCodeQuit,this),egret.Tween.get(this.startBtn).wait(100).to({x:this.initStartBtnX},200,egret.Ease.quadIn),egret.Tween.get(this.introduceBtn).wait(100).to({x:this.initIntroduceBtnX},200,egret.Ease.quadIn),egret.Tween.get(this.bigGril).to({x:this.initbigGirlX},300,egret.Ease.quadIn),egret.Tween.get(this.girl).wait(200).to({x:this.initGirlX},200,egret.Ease.quadIn);var e=this;egret.Tween.get(this).wait(500).call(function(){e.startBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,e.onStartBtnTouch,e),e.introduceBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,e.onIntroduceBtnTouch,e),e.arrow.visible=!1})},n.onCodeEnter=function(){this.nextCodeX+=this.codeSpeed,this.nextCodeX>=this.ininCodeEndY&&this.removeEventListener(egret.Event.ENTER_FRAME,this.onCodeEnter,this),this.qrcode.setPosition(this.nextCodeX,this.initCodeY)},n.onCodeQuit=function(){this.nextCodeX-=this.codeSpeed,this.nextCodeX<=this.initCodeX&&this.removeEventListener(egret.Event.ENTER_FRAME,this.onCodeQuit,this),this.qrcode.setPosition(this.nextCodeX,this.initCodeY)},t}(BaseScene);egret.registerClass(HomeScene,"HomeScene");var LuckScene=function(e){function t(){e.call(this,"LuckSceneSkin")}__extends(t,e);var i=(__define,t),n=i.prototype;return n.onEnable=function(){},n.onRemove=function(){},t}(BaseScene);egret.registerClass(LuckScene,"LuckScene");var PreloadScene=function(e){function t(){e.call(this,"PreloadSceneSkin")}__extends(t,e);var i=(__define,t),n=i.prototype;return n.onEnable=function(){this.setProcessLabel(0)},n.setProcessLabel=function(e){this.inited&&(this.processLabel.text=e+"%")},t}(BaseScene);egret.registerClass(PreloadScene,"PreloadScene");var ResultScene=function(e){function t(){e.call(this,"ResultSceneSkin")}__extends(t,e);var i=(__define,t),n=i.prototype;return n.componentCreated=function(){e.prototype.componentCreated.call(this),this.qrcode=new QRCode,this.qrcode.createCode(),this.resultGroup.y=GameConst.stage.stageHeight-this.resultGroup.height,this.htmlText=new HTMLText;var t=.125*document.body.clientWidth,i=(this.resultGroup.y+310)/1150*document.body.clientHeight;this.htmlText.setPosition(t,i),this.setPrizeLabel(""),this.setCodeLabel("")},n.onEnable=function(){var e=document.body.clientHeight*(820/1150);this.qrcode.showCode(20,e,70,70),this.setPrizeLabel(GameConst.prizeJson.msg),this.setCodeLabel(GameConst.prizeJson.prizenum),this.setPrizeImg(GameConst.prizeJson.prizeid)},n.onRemove=function(){this.qrcode.hideCode()},n.setPrizeLabel=function(e){this.prizeLabel.text=e},n.setCodeLabel=function(e){this.htmlText.setValue(e)},n.setPrizeImg=function(e){this.moneyImg.visible=!1,this.itemImg.visible=!1,this.moneybg.visible=!1,e>=1&&5>=e?(this.itemImg.visible=!0,this.itemImg.texture=RES.getRes("prize"+e+"_png")):e>=6&&9>=e&&(this.moneybg.visible=!0,this.moneyImg.visible=!0,this.moneyImg.texture=RES.getRes("prize"+e+"_png"))},t}(BaseScene);egret.registerClass(ResultScene,"ResultScene");var Grid=function(e){function t(){e.call(this,RES.getRes("game_grid1_png")),this.anchorOffsetX=this.width/2,this.anchorOffsetY=this.height/2}__extends(t,e);var i=(__define,t);i.prototype;return t.NAME="Grid",t}(egret.Bitmap);egret.registerClass(Grid,"Grid");var GridBg=function(e){function t(){e.call(this,RES.getRes("game_grid0_png")),this.bHave=!1,this.touchEnabled=!0}__extends(t,e);var i=(__define,t),n=i.prototype;return n.clean=function(){this.parentNode=null},n.getPos=function(){return[this.row,this.col]},t}(egret.Bitmap);egret.registerClass(GridBg,"GridBg");var LuckText=function(e){function t(){e.call(this,"LuckTextSkin"),this.__name="",this.__prize=""}__extends(t,e);var i=(__define,t),n=i.prototype;return n.componentCreated=function(){e.prototype.componentCreated.call(this),this.setNameLabel(this.__name),this.setPrizeLabel(this.__prize)},n.setNameLabel=function(e){this.__name=e,this.inited&&(this.nameLabel.text=this.__name)},n.setPrizeLabel=function(e){this.__prize=e,this.inited&&(this.prizeLabel.text=this.__prize)},t}(BaseUI);egret.registerClass(LuckText,"LuckText");var Player=function(e){function t(){e.call(this),this.textureList=[],this.bShake=!1,this.textureList[0]=RES.getRes("game_girl0_png"),this.textureList[1]=RES.getRes("game_girl1_png"),this.textureList[2]=RES.getRes("game_girl2_png"),this.texture=this.textureList[0],this.anchorOffsetX=this.width/2,this.anchorOffsetY=this.height-15}__extends(t,e);var i=(__define,t),n=i.prototype;return n.shakeHead=function(){if(!this.bShake){this.bShake=!0;var e=this;egret.Tween.get(this,{loop:!0}).call(function(){e.texture=e.textureList[1]}).wait(300).call(function(){e.texture=e.textureList[2]}).wait(300)}},n.stopShake=function(){this.bShake=!1,egret.Tween.removeTweens(this),this.texture=this.textureList[0]},t}(egret.Bitmap);egret.registerClass(Player,"Player");var PlayerUI=function(e){function t(){e.call(this)}__extends(t,e);var i=(__define,t),n=i.prototype;return n.shakeHead=function(){this.girl0.visible=!0,this.girl1.visible=!1;var e=this;egret.Tween.get(this,{loop:!0}).call(function(){e.girl0.visible=!1,e.girl1.visible=!0}).wait(300).call(function(){e.girl0.visible=!0,e.girl1.visible=!1}).wait(300)},n.stopShake=function(){egret.Tween.removeTweens(this)},t}(eui.Component);egret.registerClass(PlayerUI,"PlayerUI");var Water=function(e){function t(){e.call(this),this.animList=[],this.curFrame=0,this.count=0;for(var t=0;4>t;t++){var i=RES.getRes("water"+t+"_png");this.animList.push(i)}this.texture=this.animList[0]}__extends(t,e);var i=(__define,t),n=i.prototype;return n.play=function(){this.reset(),this.addEventListener(egret.Event.ENTER_FRAME,this.onEnterFrame,this)},n.onEnterFrame=function(){if(this.count++,this.count%2==0){if(this.curFrame>=4)return this.removeEventListener(egret.Event.ENTER_FRAME,this.onEnterFrame,this),void this.dispatchEvent(new egret.Event("waterComplete"));this.texture=this.animList[this.curFrame],this.curFrame++}},n.reset=function(){this.removeEventListener(egret.Event.ENTER_FRAME,this.onEnterFrame,this),this.curFrame=0,this.count=0,this.texture=this.animList[0]},t}(egret.Bitmap);egret.registerClass(Water,"Water");var Main=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var i=(__define,t),n=i.prototype;return n.createChildren=function(){e.prototype.createChildren.call(this);var t=new AssetAdapter;this.stage.registerImplementation("eui.IAssetAdapter",t),this.stage.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/default.res.json","resource/")},n.onConfigComplete=function(e){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this);var t=new eui.Theme("resource/default.thm.json",this.stage);t.addEventListener(eui.UIEvent.COMPLETE,this.onThemeLoadComplete,this)},n.onThemeLoadComplete=function(){LoadManager.getInstance().loadGroup("preload",this,this.onPreloadComplete)},n.onPreloadComplete=function(){this.preloadScene=new PreloadScene,this.addChild(this.preloadScene),LoadManager.getInstance().loadGroup("game",this,this.onResourceLoadComplete,this.onResourceProgress)},n.onResourceProgress=function(e){this.preloadScene.setProcessLabel(Math.round(e.itemsLoaded/e.itemsTotal*100))},n.onResourceLoadComplete=function(e){this.removeChild(this.preloadScene),this.preloadScene=null,GameManager.getInstance().startup(this)},t}(eui.UILayer);egret.registerClass(Main,"Main");var ThemeAdapter=function(){function e(){}var t=(__define,e),i=t.prototype;return i.getTheme=function(e,t,i,n){function s(e){t.call(n,e)}function r(t){t.resItem.url==e&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,r,null),i.call(n))}RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,r,null),RES.getResByUrl(e,s,this,RES.ResourceItem.TYPE_TEXT)},e}();egret.registerClass(ThemeAdapter,"ThemeAdapter",["eui.IThemeAdapter"]);