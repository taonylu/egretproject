var AssetAdapter=function(){function e(){}var t=(__define,e),n=t.prototype;return n.getAsset=function(e,t,n){function i(i){t.call(n,i,e)}if(RES.hasRes(e)){var s=RES.getRes(e);s?i(s):RES.getResAsync(e,i,this)}else RES.getResByUrl(e,i,this,RES.ResourceItem.TYPE_IMAGE)},e}();egret.registerClass(AssetAdapter,"AssetAdapter",["eui.IAssetAdapter"]);var App=function(){function e(){}var t=(__define,e);t.prototype;return e.init=function(e){StageUtil.stage=e.stage,this.sndMgr=new SoundManager,this.layerMgr=new LayerManager,this.layerMgr.init(e),this.sceneMgr=new SceneManager,this.layerMgr.runScene(this.sceneMgr.sceneA)},e}();egret.registerClass(App,"App");var BaseScene=function(e){function t(){e.call(this),this.isAnimDone=!1,this.addEventListener(eui.UIEvent.COMPLETE,this.onCreated,this),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.onEnable,this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemove,this)}__extends(t,e);var n=(__define,t),i=n.prototype;return i.onCreated=function(){},i.onEnable=function(){},i.onRemove=function(){},i.onDestroy=function(){},t}(eui.Component);egret.registerClass(BaseScene,"BaseScene");var ItemScroller=function(e){function t(){e.call(this),this.curItemCount=0,this.delayScroll=500,this.addEventListener(eui.UIEvent.COMPLETE,this.onCreateComplete,this)}__extends(t,e);var n=(__define,t),i=n.prototype;return i.onCreateComplete=function(){this.removeEventListener(eui.UIEvent.COMPLETE,this.onCreateComplete,this),this.validateNow();var e=this.viewport.contentWidth-this.viewport.width;e>0?(this.isHScroller=!0,this.itemSize=Math.round(this.viewport.width),this.itemNum=Math.round(this.viewport.contentWidth/this.viewport.width)):(this.isHScroller=!1,this.itemSize=Math.round(this.viewport.height),this.itemNum=Math.round(this.viewport.contentHeight/this.viewport.height)),console.log(this.itemSize,this.itemNum),this.horizontalScrollBar.thumb.visible=!1,this.verticalScrollBar.thumb.visible=!1,this.throwSpeed=0,this.bounces=!1,this.addEventListener(eui.UIEvent.CHANGE_START,this.onChangeStartHandler,this),this.addEventListener(eui.UIEvent.CHANGE_END,this.onChangeEndHandler,this)},i.onChangeStartHandler=function(e){this.isHScroller?this.touchStartPos=this.viewport.scrollH:this.touchStartPos=this.viewport.scrollV},i.onChangeEndHandler=function(){var e;e=this.isHScroller?this.viewport.scrollH-this.touchStartPos:this.viewport.scrollV-this.touchStartPos,console.log(this.viewport.scrollV,this.touchStartPos),e>0?this.scrollToNext():0>e&&this.scrollToLast()},i.scrollToNext=function(){var e=this.curItemCount;e<this.itemNum-1&&e++,this.scrollToItem(e)},i.scrollToLast=function(){var e=this.curItemCount;e>0&&e--,this.scrollToItem(e)},i.scrollToItem=function(e){var n=this;e>=0&&e<this.itemNum&&(this.curItemCount=e,egret.Tween.removeTweens(this.viewport),this.isHScroller?egret.Tween.get(this.viewport).to({scrollH:e*this.itemSize,ease:egret.Ease.quadOut},this.delayScroll).call(function(){n.dispatchEventWith(t.ScrollDone,!1,n.curItemCount)}):egret.Tween.get(this.viewport).to({scrollV:e*this.itemSize,ease:egret.Ease.quadOut},this.delayScroll).call(function(){n.dispatchEventWith(t.ScrollDone,!1,n.curItemCount)}))},i.destroy=function(){},t.ScrollDone="ScrollDone",t}(eui.Scroller);egret.registerClass(ItemScroller,"ItemScroller");var GestureMove=function(e){function t(){e.call(this),this.dist=50}__extends(t,e);var n=(__define,t),i=n.prototype;return i.start=function(){this.target.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchBegin,this)},i.stop=function(){this.target.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchBegin,this),StageUtil.stage.removeEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEnd,this)},i.onTouchBegin=function(e){this.startX=e.stageX,this.startY=e.stageY,StageUtil.stage.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.onTouchMove,this),StageUtil.stage.addEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEnd,this)},i.onTouchEnd=function(e){StageUtil.stage.removeEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEnd,this),StageUtil.stage.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.onTouchMove,this),this.lastX=e.stageX,this.lastY=e.stageY,this.lastY-this.startY>this.dist?this.dispatchEvent(new egret.Event(t.Down)):this.lastY-this.startY<this.dist&&this.dispatchEvent(new egret.Event(t.Up))},i.onTouchMove=function(e){e.stageY-this.startY;this.startY=e.stageY,this.dispatchEvent(new egret.Event(t.Move))},i.destroy=function(){this.stop(),this.target=null},t.Up="Up",t.Down="Down",t.Move="Move",t}(egret.EventDispatcher);egret.registerClass(GestureMove,"GestureMove");var LayerManager=function(){function e(){}var t=(__define,e),n=t.prototype;return n.init=function(e){this.main=e,this.sceneLayer=new eui.Group,this.sceneLayer.percentWidth=100,this.sceneLayer.percentHeight=100,this.main.addChild(this.sceneLayer)},n.runScene=function(e,t){void 0===t&&(t=!1),null!=this.curScene&&this.sceneLayer.removeChild(this.curScene),this.curScene=e,this.sceneLayer.addChild(e)},e}();egret.registerClass(LayerManager,"LayerManager");var NumberTool=function(){function e(){}var t=(__define,e);t.prototype;return e.timeFormat=function(e){return 10>e?"0"+e:e+""},e}();egret.registerClass(NumberTool,"NumberTool");var SceneManager=function(){function e(){this.sceneA=new SceneA,this.sceneB=new SceneB,this.sceneC=new SceneC,this.sceneD=new SceneD,this.scrollScene=new ScrollScene}var t=(__define,e);t.prototype;return e}();egret.registerClass(SceneManager,"SceneManager");var SoundManager=function(){function e(){this.phone="phone_mp3",this.sceneC_bgm="sceneC_bgm_mp3",this.say="say_mp3",this.soundList={},this.loops=1,this.soundList[this.phone]="resource/assets/sound/phone.mp3",this.soundList[this.sceneC_bgm]="resource/assets/sound/sceneC_bgm.mp3",this.soundList[this.say]="resource/assets/sound/say.mp3"}var t=(__define,e),n=t.prototype;return n.play=function(e,t){void 0===t&&(t=1),this.loops=t,this.sound=RES.getRes(e),null==this.sound?(this.sound=new egret.Sound,this.sound.type=egret.Sound.MUSIC,this.sound.load(this.soundList[e]),this.sound.addEventListener(egret.Event.COMPLETE,this.onLoadSound,this)):this.onLoadSound()},n.onLoadSound=function(){this.soundChannel=this.sound.play(0,this.loops)},n.stop=function(){this.sound.removeEventListener(egret.Event.COMPLETE,this.onLoadSound,this),this.soundChannel&&(this.soundChannel.stop(),this.soundChannel=null)},e}();egret.registerClass(SoundManager,"SoundManager");var StageUtil=function(){function e(){}var t=(__define,e);t.prototype;return e}();egret.registerClass(StageUtil,"StageUtil");var SceneA=function(e){function t(){e.call(this),this.skinName="SceneASkin"}__extends(t,e);var n=(__define,t),i=n.prototype;return i.onCreated=function(){},i.onEnable=function(){App.sndMgr.play(App.sndMgr.phone,Number.MAX_VALUE),this.playPhoneAnim(),this.phoneBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouch,this)},i.onRemove=function(){},i.onTouch=function(){this.nextScene()},i.playPhoneAnim=function(){this.phoneBtn.rotation=0,egret.Tween.get(this.phoneBtn,{loop:!0}).to({rotation:-10},100).to({rotation:10},100).to({rotation:-10},100).to({rotation:10},100).to({rotation:-10},100).to({rotation:10},100).wait(1500)},i.nextScene=function(){App.sndMgr.stop(),egret.Tween.removeTweens(this.phoneBtn),this.phoneBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouch,this),App.layerMgr.runScene(App.sceneMgr.sceneB)},t}(BaseScene);egret.registerClass(SceneA,"SceneA");var SceneB=function(e){function t(){e.call(this),this.phoneTimer=new egret.Timer(1e3),this.skinName="SceneBSkin"}__extends(t,e);var n=(__define,t),i=n.prototype;return i.onCreated=function(){},i.onEnable=function(){App.sndMgr.play(App.sndMgr.say),this.startTimer(),this.phoneBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouch,this)},i.onRemove=function(){App.sndMgr.stop(),this.stopTimer()},i.onTouch=function(){this.nextScene()},i.startTimer=function(){this.timeLabel.text="00:00",this.phoneTimer.addEventListener(egret.TimerEvent.TIMER,this.onTimer,this),this.phoneTimer.addEventListener(egret.TimerEvent.TIMER_COMPLETE,this.onComplete,this),this.phoneTimer.repeatCount=8,this.phoneTimer.reset(),this.phoneTimer.start()},i.onTimer=function(){this.timeLabel.text="00:"+NumberTool.timeFormat(this.phoneTimer.currentCount)},i.onComplete=function(){this.nextScene()},i.stopTimer=function(){this.phoneTimer.removeEventListener(egret.TimerEvent.TIMER,this.onTimer,this),this.phoneTimer.removeEventListener(egret.TimerEvent.TIMER_COMPLETE,this.onComplete,this),this.phoneTimer.stop()},i.nextScene=function(){this.phoneBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouch,this),this.stopTimer(),App.sndMgr.stop(),App.layerMgr.runScene(App.sceneMgr.sceneC)},t}(BaseScene);egret.registerClass(SceneB,"SceneB");var SceneC=function(e){function t(){e.call(this),this.skinName="SceneCSkin"}__extends(t,e);var n=(__define,t),i=n.prototype;return i.onCreated=function(){this.titlePos=this.title.y,this.title.y=0},i.onEnable=function(){this.playStarAnim(),this.playPhoneAnim(),this.playTitleAnim(),App.sndMgr.play(App.sndMgr.sceneC_bgm,Number.MAX_VALUE),this.phoneBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouch,this)},i.onRemove=function(){this.phoneBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouch,this)},i.playStarAnim=function(){this.starGroup.alpha=1,egret.Tween.get(this.starGroup,{loop:!0}).to({alpha:0},500).to({alpha:1},500)},i.playPhoneAnim=function(){this.phoneBtn.scaleX=1,this.phoneBtn.scaleY=1,egret.Tween.get(this.phoneBtn,{loop:!0}).to({scaleX:1.1,scaleY:1.1},500).to({scaleX:1,scaleY:1},500)},i.playTitleAnim=function(){this.title.y=0,egret.Tween.get(this.title).to({y:this.titlePos},800)},i.onTouch=function(){this.nextScene()},i.nextScene=function(){egret.Tween.removeAllTweens(),this.phoneBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouch,this),App.layerMgr.runScene(App.sceneMgr.scrollScene)},t}(BaseScene);egret.registerClass(SceneC,"SceneC");var SceneD=function(e){function t(){e.call(this),this.imgList=[],this.skinName="SceneDSkin"}__extends(t,e);var n=(__define,t),i=n.prototype;return i.onCreated=function(){for(var e=0;6>e;e++)this.imgList.push(this.imgGroup.getChildAt(e));this.arrowPos=this.arrow.y,this.titlePos=this.title.y,this.title.y=0},i.onEnable=function(){},i.onRemove=function(){},i.startAnim=function(){this.validateNow(),this.playTitleAnim(),this.playStarAnim(),this.playFireWork(),this.playImgAnim(),this.playArrow(),this.isAnimDone=!0},i.stopAnim=function(){egret.Tween.removeAllTweens()},i.playTitleAnim=function(){this.title.y=0,egret.Tween.get(this.title).to({y:this.titlePos},500)},i.playStarAnim=function(){this.starGroup.alpha=1,egret.Tween.get(this.starGroup,{loop:!0}).to({alpha:0},500).to({alpha:1},500)},i.playFireWork=function(){egret.Tween.get(this.star0).wait(500).to({alpha:0,scaleX:5,scaleY:5,x:this.star0.x-100},2e3),egret.Tween.get(this.star1).wait(500).to({alpha:0,scaleX:5,scaleY:5,x:this.star1.x+100},2e3)},i.playImgAnim=function(){for(var e=this.imgList.length,t=0;e>t;t++)this.imgList[t].scaleX=0,this.imgList[t].scaleY=0;var n=500;egret.Tween.get(this.imgList[0]).wait(n).to({scaleX:1,scaleY:1},n,egret.Ease.bounceOut),egret.Tween.get(this.imgList[1]).wait(2*n).to({scaleX:1,scaleY:1},n,egret.Ease.bounceOut),egret.Tween.get(this.imgList[2]).wait(3*n).to({scaleX:1,scaleY:1},n,egret.Ease.bounceOut),egret.Tween.get(this.imgList[3]).wait(4*n).to({scaleX:1,scaleY:1},n,egret.Ease.bounceOut),egret.Tween.get(this.imgList[4]).wait(5*n).to({scaleX:1,scaleY:1},n,egret.Ease.bounceOut),egret.Tween.get(this.imgList[5]).wait(6*n).to({scaleX:1,scaleY:1},n,egret.Ease.bounceOut)},i.playArrow=function(){this.arrow.y=this.arrowPos,egret.Tween.get(this.arrow,{loop:!0}).to({y:this.arrowPos-10},300).to({y:this.arrowPos},300)},t}(BaseScene);egret.registerClass(SceneD,"SceneD");var SceneE=function(e){function t(){e.call(this),this.skinName="SceneESkin"}__extends(t,e);var n=(__define,t),i=n.prototype;return i.onCreated=function(){this.titlePos=this.title.y,this.title.y=0},i.onEnable=function(){},i.onRemove=function(){},i.startAnim=function(){this.playPhoneAnim(),this.playTitleAnim(),this.playStarAnim(),this.isAnimDone=!0},i.stopAnim=function(){egret.Tween.removeAllTweens()},i.playStarAnim=function(){this.starGroup.alpha=1,egret.Tween.get(this.starGroup,{loop:!0}).to({alpha:0},500).to({alpha:1},500)},i.onTouch=function(){},i.playTitleAnim=function(){this.title.y=0,egret.Tween.get(this.title).to({y:this.titlePos},500)},i.playPhoneAnim=function(){this.phoneBtn.scaleX=1,this.phoneBtn.scaleY=1,egret.Tween.get(this.phoneBtn,{loop:!0}).to({scaleX:1.1,scaleY:1.1},500).to({scaleX:1,scaleY:1},500)},t}(BaseScene);egret.registerClass(SceneE,"SceneE");var SceneF=function(e){function t(){e.call(this),this.skinName="SceneFSkin"}__extends(t,e);var n=(__define,t),i=n.prototype;return i.onCreated=function(){this.titlePos=this.title.y,this.arrowPos=this.arrow.y,this.title.y=0},i.onEnable=function(){},i.onRemove=function(){},i.startAnim=function(){this.playTitleAnim(),this.playStarAnim(),this.playArrow(),this.isAnimDone=!0},i.stopAnim=function(){egret.Tween.removeAllTweens()},i.playStarAnim=function(){this.starGroup.alpha=1,egret.Tween.get(this.starGroup,{loop:!0}).to({alpha:0},500).to({alpha:1},500)},i.playTitleAnim=function(){this.title.y=0,egret.Tween.get(this.title).to({y:this.titlePos},1e3)},i.playArrow=function(){this.arrow.y=this.arrowPos,egret.Tween.get(this.arrow,{loop:!0}).to({y:this.arrowPos-10},300).to({y:this.arrowPos},300)},t}(BaseScene);egret.registerClass(SceneF,"SceneF");var SceneG=function(e){function t(){e.call(this),this.skinName="SceneGSkin"}__extends(t,e);var n=(__define,t),i=n.prototype;return i.onCreated=function(){this.titlePos=this.title.y,this.title.y=0,this.tree.alpha=0,this.submitBg.alpha=0,this.submitBtn.alpha=0},i.onEnable=function(){},i.onRemove=function(){},i.startAnim=function(){this.playTitleAnim(),this.playStarAnim(),this.isAnimDone=!0,this.submitBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSubmit,this)},i.onSubmit=function(){alert("本作品是测试demo，提交无效")},i.stopAnim=function(){egret.Tween.removeAllTweens()},i.playStarAnim=function(){this.starGroup.alpha=1,egret.Tween.get(this.starGroup,{loop:!0}).to({alpha:0},500).to({alpha:1},500)},i.playTitleAnim=function(){this.title.y=0,egret.Tween.get(this.title).to({y:this.titlePos},500),this.submitBg.alpha=0,egret.Tween.get(this.submitBg).wait(500).to({alpha:1},500),this.tree.alpha=0,egret.Tween.get(this.tree).wait(1e3).to({alpha:1},500),this.submitBtn.alpha=0,egret.Tween.get(this.submitBtn).wait(1500).to({alpha:1},500),this.submitBtn.scaleX=1,this.submitBtn.scaleY=1,egret.Tween.get(this.submitBtn,{loop:!0}).wait(2e3).to({scaleX:1.1,scaleY:1.1},500).to({scaleX:1,scaleY:1},500)},t}(BaseScene);egret.registerClass(SceneG,"SceneG");var ScrollScene=function(e){function t(){e.call(this),this.sceneList=[],this.skinName="ScrollSceneSkin"}__extends(t,e);var n=(__define,t),i=n.prototype;return i.onCreated=function(){for(var e=0;4>e;e++)this.sceneList.push(this.sceneGroup.getChildAt(e))},i.onEnable=function(){this.scroll.addEventListener(ItemScroller.ScrollDone,this.onScrollDone,this),this.sceneList[0].startAnim()},i.onRemove=function(){},i.onDestroy=function(){},i.onScrollDone=function(e){var t=this.sceneList[e.data];t&&0==t.isAnimDone&&t.startAnim()},t}(BaseScene);egret.registerClass(ScrollScene,"ScrollScene");var Main=function(e){function t(){e.apply(this,arguments),this.isThemeLoadEnd=!1,this.isResourceLoadEnd=!1}__extends(t,e);var n=(__define,t),i=n.prototype;return i.createChildren=function(){e.prototype.createChildren.call(this);var t=new AssetAdapter;this.stage.registerImplementation("eui.IAssetAdapter",t),this.stage.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/default.res.json","resource/")},i.onConfigComplete=function(e){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this);var t=new eui.Theme("resource/default.thm.json",this.stage);t.addEventListener(eui.UIEvent.COMPLETE,this.onThemeLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),RES.loadGroup("sceneA"),RES.loadGroup("sceneB"),RES.loadGroup("sceneC"),RES.loadGroup("sceneD"),RES.loadGroup("sceneE")},i.onThemeLoadComplete=function(){this.isThemeLoadEnd=!0,this.createScene()},i.onResourceLoadComplete=function(e){console.log("loaded"+e.groupName),"sceneE"==e.groupName&&(RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),this.isResourceLoadEnd=!0,this.createScene())},i.createScene=function(){this.isThemeLoadEnd&&this.isResourceLoadEnd&&this.startCreateScene()},i.onItemLoadError=function(e){console.warn("Url:"+e.resItem.url+" has failed to load")},i.onResourceLoadError=function(e){console.warn("Group:"+e.groupName+" has failed to load"),this.onResourceLoadComplete(e)},i.onResourceProgress=function(e){"preload"==e.groupName},i.startCreateScene=function(){App.init(this)},t}(eui.UILayer);egret.registerClass(Main,"Main");var ThemeAdapter=function(){function e(){}var t=(__define,e),n=t.prototype;return n.getTheme=function(e,t,n,i){function s(e){t.call(i,e)}function o(t){t.resItem.url==e&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,o,null),n.call(i))}RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,o,null),RES.getResByUrl(e,s,this,RES.ResourceItem.TYPE_TEXT)},e}();egret.registerClass(ThemeAdapter,"ThemeAdapter",["eui.IThemeAdapter"]);